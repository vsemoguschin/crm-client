import{_ as de,a as ie,b as ce,c as pe,d as fe}from"./JYeLPbKT.js";import{c as ae,a as se,d as ne,e as re,_ as ue,b as oe}from"./C6vK2VYI.js";import{u as M}from"./Dt19OLxm.js";import{e as Z,v as C,m as f,o as l,w as e,b as t,c as v,d as p,F as x,z as g,t as o,a as r,l as b,A as $,D as O,u as me,g as ve,h as _e,r as G,i as xe,B as X,H as le}from"./BbheI0mw.js";import{_ as ye}from"./D0zfKHPR.js";import{_ as ge}from"./BND4UK_1.js";import{Q as be}from"./C_rPMSjE.js";import"./B9M8ggfK.js";import"./CJOOd8Dx.js";import"./D2GZmoDz.js";import"./_14b2CUj.js";const Pe={class:$(["flex justify-center items-center gap-1"])},Fe={class:$(["flex justify-center items-center gap-1"])},De={class:$(["flex justify-center items-center gap-1"])},he={class:$(["flex justify-center items-center gap-1"])},ke={class:$(["flex justify-center items-center gap-1"])},Me=Z({__name:"NeonTable",props:{plData:{}},setup(J){const F=J,q=C(()=>Array.isArray(F.plData.income)&&F.plData.income.length>0&&"allDealsPrice"in F.plData.income[0]),j=C(()=>{if(!q.value)return F.plData;const c=F.plData,_=c.periods,h={allDealsPrice:c.income.map(k=>({value:k.allDealsPrice,period:k.period})),sendDeals:c.income.map(k=>({value:k.sendDeals,period:k.period})),revenue:c.income.map(k=>({value:k.revenue,period:k.period}))},a=k=>_.map((P,w)=>{const A=k.find(K=>K.period===P)?.value??0,Q=h.sendDeals[w]?.value??0,Y=Q===0?0:+(A/Q*100).toFixed(2);return{value:A,changePercent:Y}}),u=(k,P)=>k?.find(w=>w.period===P)?.value??0,d=[],m=_.map((k,P)=>{const w=u(c.prodExpenses,k),E=h.sendDeals[P]?.value??0,A=E===0?0:+(w/E*100).toFixed(2);return{value:w,changePercent:A}}),D=[{role:"Сборщики",data:a(c.mastersSalaries??[])},{role:"Упаковщики",data:a(c.packersSalaries??[])},{role:"Фрезеровщики",data:a(c.frezerSalaries??[])},{role:"Ремонты",data:a(c.mastersRepairsSalaries??[])},{role:"Другое",data:a(c.otherSalaries??[])},{role:"Логисты",data:a(c.logisticsSalaries??[])}].filter(k=>k.data.some(P=>P.value>0));D.sort((k,P)=>{const w=k.data[k.data.length-1]?.value||0;return(P.data[P.data.length-1]?.value||0)-w});const s=_.map((k,P)=>{const w=D.reduce((Q,Y)=>Q+(Y.data[P]?.value??0),0),E=h.sendDeals[P]?.value??0,A=E===0?0:+(w/E*100).toFixed(2);return{value:w,changePercent:A}}),i=[],S=_.map((k,P)=>{const w=u(c.adExpenses,k),E=h.sendDeals[P]?.value??0,A=E===0?0:+(w/E*100).toFixed(2);return{value:w,changePercent:A}}),n=[{role:"Менеджеры отдела продаж",data:a(c.mopSalaries??[])},{role:"Дизайнеры",data:a(c.disSalaries??[])},{role:"Менеджеры отдела ведения",data:a(c.movSalaries??[])},{role:"Коммерческий директор",data:a(c.kdSalaries??[])}].filter(k=>k.data.some(P=>P.value>0));n.sort((k,P)=>{const w=k.data[k.data.length-1]?.value||0;return(P.data[P.data.length-1]?.value||0)-w});const y=_.map((k,P)=>{const w=n.reduce((Q,Y)=>Q+(Y.data[P]?.value??0),0),E=h.sendDeals[P]?.value??0,A=E===0?0:+(w/E*100).toFixed(2);return{value:w,changePercent:A}}),T=[{title:"Расходы на поставки",data:m},{title:"Зарплаты производства",data:s},{title:"Расходы на рекламу",data:S},{title:"Зарплаты коммерческого отдела",data:y}];T.sort((k,P)=>{const w=k.data[k.data.length-1]?.value||0;return(P.data[P.data.length-1]?.value||0)-w});const N=_.map((k,P)=>{const w=T.reduce((Q,Y)=>Q+(Y.data[P]?.value??0),0),E=h.sendDeals[P]?.value??0,A=E===0?0:+(w/E*100).toFixed(2);return{value:w,changePercent:A}});return{periods:_,income:h,expenses:{totals:{data:T,totals:N},production:{supplies:{data:d,totals:m},productionSalaries:{data:D,totals:s}},commercial:{adExpenses:{data:i,totals:S},commercialSalaries:{data:n,totals:y}}}}}),z=c=>C(()=>c.map((_,h)=>({value:_.value,changePercent:!c[h-1]?.value||c[h-1]?.value===0?0:+((_.value-c[h-1].value)/c[h-1].value*100).toFixed(2)}))),L=C(()=>{const c=j.value.income.allDealsPrice;return z(c).value}),B=C(()=>{const c=j.value.income.sendDeals;return z(c).value}),W=C(()=>{const c=j.value.income.revenue;return z(c).value}),V=C(()=>j.value.expenses),U=C(()=>j.value.periods),R=C(()=>U.value.map((c,_)=>{const h=V.value.totals.totals[_]?.value??0,a=B.value[_]?.value??0,u=a===0?0:+(h/a*100).toFixed(2);let d=!1,m=!1;if(_>0){const D=V.value.totals.totals[_-1]?.value??0,s=B.value[_-1]?.value??0,i=s===0?0:+(D/s*100).toFixed(2);u>i?d=!0:u<i&&(m=!0)}return{period:c,value:h,percent:u,isIncreased:d,isDecreased:m}})),I=C(()=>U.value.map((c,_)=>{const h=B.value[_]?.value??0,a=R.value[_]?.value??0,u=+(h-a).toFixed(2);let d=0;if(_>0){const m=B.value[_-1]?.value??0,D=R.value[_-1]?.value??0,s=+(m-D).toFixed(2);s!==0&&(d=+((u-s)/Math.abs(s)*100).toFixed(2))}return{value:u,changePercent:d}}));return(c,_)=>{const h=ne,a=se,u=ae,d=ue,m=re,D=oe;return l(),f(D,{class:"bg-slate-100 rounded-sm overflow-hidden"},{default:e(()=>[t(u,null,{default:e(()=>[t(a,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(h,{class:"text-xl"},{default:e(()=>_[0]||(_[0]=[p("Доходы",-1)])),_:1,__:[0]}),(l(!0),v(x,null,g(U.value,(s,i)=>(l(),f(h,{key:i,class:"text-center"},{default:e(()=>[p(o(s),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(m,{class:"font-semibold"},{default:e(()=>[t(a,null,{default:e(()=>[t(d,null,{default:e(()=>_[1]||(_[1]=[p("Оформленные заказы",-1)])),_:1,__:[1]}),(l(!0),v(x,null,g(L.value,(s,i)=>(l(),f(d,{key:i,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",s.changePercent<0?"text-red-600/90":"",s.changePercent>0?"text-green-700/90":"",s.changePercent===0?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(s.value)+"₽"),1),r("span",null," ("+o(s.changePercent)+"%) ",1)],2)]),_:2},1024))),128))]),_:1}),t(a,null,{default:e(()=>[t(d,null,{default:e(()=>_[2]||(_[2]=[p("Отправленные заказы",-1)])),_:1,__:[2]}),(l(!0),v(x,null,g(B.value,(s,i)=>(l(),f(d,{key:i,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",s.changePercent<0?"text-red-600/90":"",s.changePercent>0?"text-green-700/90":"",s.changePercent===0?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(s.value)+"₽"),1),r("span",null," ("+o(s.changePercent)+"%) ",1)],2)]),_:2},1024))),128))]),_:1}),t(a,null,{default:e(()=>[t(d,null,{default:e(()=>_[3]||(_[3]=[p("Выручка",-1)])),_:1,__:[3]}),(l(!0),v(x,null,g(W.value,(s,i)=>(l(),f(d,{key:i,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",s.changePercent<0?"text-red-600/90":"",s.changePercent>0?"text-green-700/90":"",s.changePercent===0?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(s.value)+"₽"),1),r("span",null," ("+o(s.changePercent)+"%) ",1)],2)]),_:2},1024))),128))]),_:1}),t(a,null,{default:e(()=>[t(d,null,{default:e(()=>_[4]||(_[4]=[p("Чистая прибыль",-1)])),_:1,__:[4]}),(l(!0),v(x,null,g(I.value,(s,i)=>(l(),f(d,{key:`net-profit-${i}`,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",s.value<0?"text-red-600/90":"",s.value>0?"text-green-700/90":"",s.value===0?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(s.value)+"₽"),1)],2)]),_:2},1024))),128))]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(h,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(h,{class:"text-xl"},{default:e(()=>_[5]||(_[5]=[p("Расходы ",-1)])),_:1,__:[5]}),(l(!0),v(x,null,g(U.value,(s,i)=>(l(),f(h,{key:i,class:"text-center"},{default:e(()=>[p(o(s),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(m,null,{default:e(()=>[(l(!0),v(x,null,g(V.value.totals.data,(s,i)=>(l(),f(a,{key:i},{default:e(()=>[t(d,null,{default:e(()=>[r("div",null,[r("span",null,o(s.title),1)])]),_:2},1024),(l(!0),v(x,null,g(s.data,(S,n)=>(l(),f(d,{key:n,class:"text-center"},{default:e(()=>[r("div",Pe,[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+S.value.toFixed(2))+"₽"),1),r("span",null," ("+o(S.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(a,{class:"text-center bg-slate-300 hover:bg-slate-300"},{default:e(()=>[t(d,{class:"font-bold text-left"},{default:e(()=>_[6]||(_[6]=[p(" ИТОГО ",-1)])),_:1,__:[6]}),(l(!0),v(x,null,g(V.value.totals.totals,(s,i)=>(l(),f(d,{key:i},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+s.value.toFixed(2))+"₽"),1),r("span",null," ("+o((s.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(h,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"text-xl text-center font-semibold bg-gray-300 hover:bg-gray-300 py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(h,{colspan:"5",class:"text-center"},{default:e(()=>_[7]||(_[7]=[p(" Отдел производства ",-1)])),_:1,__:[7]})]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(h,{class:"text-xl"},{default:e(()=>_[8]||(_[8]=[p("Расходы на поставки ",-1)])),_:1,__:[8]}),(l(!0),v(x,null,g(U.value,(s,i)=>(l(),f(h,{key:i,class:"text-center"},{default:e(()=>[p(o(s),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(m,null,{default:e(()=>[(l(!0),v(x,null,g(V.value.production.supplies.data,(s,i)=>(l(),f(a,{key:i},{default:e(()=>[t(d,null,{default:e(()=>[p(o(s.category),1)]),_:2},1024),(l(!0),v(x,null,g(s.data,(S,n)=>(l(),f(d,{key:n,class:"text-center"},{default:e(()=>[r("div",Fe,[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+S.value.toFixed(2))+"₽"),1),r("span",null," ("+o(S.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(a,{class:"text-center bg-slate-300 hover:bg-slate-300"},{default:e(()=>[t(d,{class:"font-bold text-left"},{default:e(()=>_[9]||(_[9]=[p(" ИТОГО ",-1)])),_:1,__:[9]}),(l(!0),v(x,null,g(V.value.production.supplies.totals,(s,i)=>(l(),f(d,{key:i},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+s.value.toFixed(2))+"₽"),1),r("span",null," ("+o((s.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(h,{class:"text-xl"},{default:e(()=>_[10]||(_[10]=[p("Зарплаты производства ",-1)])),_:1,__:[10]}),(l(!0),v(x,null,g(U.value,(s,i)=>(l(),f(h,{key:i,class:"text-center"},{default:e(()=>[p(o(s),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(m,null,{default:e(()=>[(l(!0),v(x,null,g(V.value.production.productionSalaries.data,(s,i)=>(l(),f(a,{key:i},{default:e(()=>[t(d,null,{default:e(()=>[p(o(s.role),1)]),_:2},1024),(l(!0),v(x,null,g(s.data,(S,n)=>(l(),f(d,{key:n,class:"text-center"},{default:e(()=>[r("div",De,[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+S.value.toFixed(2))+"₽"),1),r("span",null," ("+o(S.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(a,{class:"text-center bg-slate-300 hover:bg-slate-300"},{default:e(()=>[t(d,{class:"font-bold text-left"},{default:e(()=>_[11]||(_[11]=[p(" ИТОГО ",-1)])),_:1,__:[11]}),(l(!0),v(x,null,g(V.value.production.productionSalaries.totals,(s,i)=>(l(),f(d,{key:i},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+s.value.toFixed(2))+"₽"),1),r("span",null," ("+o((s.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(h,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"text-xl text-center font-semibold bg-gray-300 hover:bg-gray-300 py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(h,{colspan:"5",class:"text-center"},{default:e(()=>_[12]||(_[12]=[p(" Коммерческий отдел ",-1)])),_:1,__:[12]})]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(h,{class:"text-xl"},{default:e(()=>_[13]||(_[13]=[p("Расходы на рекламу ",-1)])),_:1,__:[13]}),(l(!0),v(x,null,g(U.value,(s,i)=>(l(),f(h,{key:i,class:"text-center"},{default:e(()=>[p(o(s),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(m,null,{default:e(()=>[(l(!0),v(x,null,g(V.value.commercial.adExpenses.data,(s,i)=>(l(),f(a,{key:i},{default:e(()=>[t(d,null,{default:e(()=>[p(o(s.title),1)]),_:2},1024),(l(!0),v(x,null,g(s.data,(S,n)=>(l(),f(d,{key:n,class:"text-center"},{default:e(()=>[r("div",he,[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+S.value.toFixed(2))+"₽"),1),r("span",null," ("+o(S.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(a,{class:"text-center bg-slate-300 hover:bg-slate-300"},{default:e(()=>[t(d,{class:"font-bold text-left"},{default:e(()=>_[14]||(_[14]=[p(" ИТОГО ",-1)])),_:1,__:[14]}),(l(!0),v(x,null,g(V.value.commercial.adExpenses.totals,(s,i)=>(l(),f(d,{key:i},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+s.value.toFixed(2))+"₽"),1),r("span",null," ("+o((s.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1}),t(u,null,{default:e(()=>[t(a,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(h,{class:"text-xl"},{default:e(()=>_[15]||(_[15]=[p("Зарплаты коммерческого отдела ",-1)])),_:1,__:[15]}),(l(!0),v(x,null,g(U.value,(s,i)=>(l(),f(h,{key:i,class:"text-center"},{default:e(()=>[p(o(s),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(m,null,{default:e(()=>[(l(!0),v(x,null,g(V.value.commercial.commercialSalaries.data,(s,i)=>(l(),f(a,{key:i},{default:e(()=>[t(d,null,{default:e(()=>[p(o(s.role),1)]),_:2},1024),(l(!0),v(x,null,g(s.data,(S,n)=>(l(),f(d,{key:n,class:"text-center"},{default:e(()=>[r("div",ke,[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+S.value.toFixed(2))+"₽"),1),r("span",null," ("+o(S.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(a,{class:"text-center bg-slate-300"},{default:e(()=>[t(d,{class:"font-bold text-left"},{default:e(()=>_[16]||(_[16]=[p(" ИТОГО ",-1)])),_:1,__:[16]}),(l(!0),v(x,null,g(V.value.commercial.commercialSalaries.totals,(s,i)=>(l(),f(d,{key:i},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in c?c.useMyFormatPrice:b(M))(+s.value.toFixed(2))+"₽"),1),r("span",null," ("+o((s.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}}),Se={class:$(["flex justify-center items-center gap-1"])},we={class:$(["flex justify-center items-center gap-1"])},$e={class:$(["flex justify-center items-center gap-1"])},Ee={class:$(["flex justify-center items-center gap-1"])},Te={class:$(["flex justify-center items-center gap-1"])},je={class:$(["flex justify-center items-center gap-1"])},Ve={class:$(["flex justify-center items-center gap-1"])},Be={class:$(["flex justify-center items-center gap-1"])},Ue={class:$(["flex justify-center items-center gap-1"])},Ae={class:$(["flex justify-center items-center gap-1"])},Ce=Z({__name:"BookTable",props:{plData:{}},setup(J){const F=J,q=(a,u)=>C(()=>a.map((d,m)=>{const D=d[u]??0,s=a[m-1]?.[u]??0,i=m===0||s===0?0:+((D-s)/s*100).toFixed(2);return{value:D,changePercent:i}})),j=(a,u)=>C(()=>F.plData.periods.map(d=>{const m=a.find(S=>S.period===d),D=m?u(m):0,s=F.plData.income.find(S=>S.period===d)?.sendDeals??0,i=s===0?0:+(D/s*100).toFixed(2);return{period:d,value:D,percent:i}})),z=q(F.plData.income,"allDealsPrice"),L=q(F.plData.income,"sendDeals"),B=q(F.plData.income,"revenue"),W=j(F.plData.prodExpensesByPeriod??[],a=>a.value),V=j(F.plData.adExpenses??[],a=>a.value),U=j(F.plData.mopSalaries??[],a=>a.value),R=j(F.plData.ropSalaries??[],a=>a.value),I=j(F.plData.movSalaries??[],a=>a.value),c=j(F.plData.designExpensesByPeriod??[],a=>a.value),_=C(()=>F.plData.periods.map((a,u)=>{const d=F.plData.prodExpensesByPeriod?.find(P=>P.period===a)?.value??0,m=F.plData.adExpenses?.find(P=>P.period===a)?.value??0,D=F.plData.designExpensesByPeriod?.find(P=>P.period===a)?.value??0,s=F.plData.mopSalaries?.find(P=>P.period===a)?.value??0,i=F.plData.ropSalaries?.find(P=>P.period===a)?.value??0,S=F.plData.movSalaries?.find(P=>P.period===a)?.value??0,n=d+m+D+s+i+S,y=F.plData.income.find(P=>P.period===a)?.sendDeals??0,T=y===0?0:+(n/y*100).toFixed(2);let N=!1,k=!1;if(u>0){const P=F.plData.periods[u-1],w=F.plData.prodExpensesByPeriod?.find(H=>H.period===P)?.value??0,E=F.plData.adExpenses?.find(H=>H.period===P)?.value??0,A=F.plData.mopSalaries?.find(H=>H.period===P)?.value??0,Q=F.plData.ropSalaries?.find(H=>H.period===P)?.value??0,Y=F.plData.movSalaries?.find(H=>H.period===P)?.value??0,K=w+E+A+Q+Y,ee=F.plData.income.find(H=>H.period===P)?.allDealsPrice??0,te=ee===0?0:+(K/ee*100).toFixed(2);T>te?N=!0:T<te&&(k=!0)}return{period:a,value:n,percent:T,isIncreased:N,isDecreased:k}})),h=C(()=>F.plData.periods.map((a,u)=>{const d=L.value[u]?.value??0,m=_.value[u]?.value??0,D=+(d-m).toFixed(2);let s=0;if(u>0){const i=L.value[u-1]?.value??0,S=_.value[u-1]?.value??0,n=+(i-S).toFixed(2);n!==0&&(s=+((D-n)/Math.abs(n)*100).toFixed(2))}return{value:D,changePercent:s}}));return(a,u)=>{const d=ne,m=se,D=ae,s=ue,i=re,S=oe;return l(),f(S,{class:"bg-slate-100 rounded-sm overflow-hidden"},{default:e(()=>[t(D,null,{default:e(()=>[t(m,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(d,{class:"text-xl"},{default:e(()=>u[0]||(u[0]=[p("Доходы",-1)])),_:1,__:[0]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:y,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,{class:"font-semibold"},{default:e(()=>[t(m,null,{default:e(()=>[t(s,null,{default:e(()=>u[1]||(u[1]=[p("Оформленные заказы",-1)])),_:1,__:[1]}),(l(!0),v(x,null,g(b(z),(n,y)=>(l(),f(s,{key:y,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",n.changePercent<0?"text-red-600/90":"",n.changePercent>0?"text-green-700/90":"",n.changePercent===0?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(n.value)+"₽"),1),r("span",null," ("+o(n.changePercent)+"%) ",1)],2)]),_:2},1024))),128))]),_:1}),t(m,null,{default:e(()=>[t(s,null,{default:e(()=>u[2]||(u[2]=[p("Отправленные заказы",-1)])),_:1,__:[2]}),(l(!0),v(x,null,g(b(L),(n,y)=>(l(),f(s,{key:y,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",n.changePercent<0?"text-red-600/90":"",n.changePercent>0?"text-green-700/90":"",n.changePercent===0?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(n.value)+"₽"),1),r("span",null," ("+o(n.changePercent)+"%) ",1)],2)]),_:2},1024))),128))]),_:1}),t(m,null,{default:e(()=>[t(s,null,{default:e(()=>u[3]||(u[3]=[p("Выручка",-1)])),_:1,__:[3]}),(l(!0),v(x,null,g(b(B),(n,y)=>(l(),f(s,{key:y,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",n.changePercent<0?"text-red-600/90":"",n.changePercent>0?"text-green-700/90":"",n.changePercent===0?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(n.value)+"₽"),1),r("span",null," ("+o(n.changePercent)+"%) ",1)],2)]),_:2},1024))),128))]),_:1}),t(m,null,{default:e(()=>[t(s,null,{default:e(()=>u[4]||(u[4]=[p("Чистая прибыль",-1)])),_:1,__:[4]}),(l(!0),v(x,null,g(h.value,(n,y)=>(l(),f(s,{key:`net-profit-${y}`,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",n.value<0?"text-red-600/90":"",n.value>0?"text-green-700/90":"",n.value===0?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(n.value)+"₽"),1)],2)]),_:2},1024))),128))]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"bg-red-200 hover:bg-red-200"},{default:e(()=>[t(d,{class:"text-xl font-bold"},{default:e(()=>u[5]||(u[5]=[p("Расходы",-1)])),_:1,__:[5]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:`expenses-${y}`,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,{class:"font-semibold"},{default:e(()=>[t(m,null,{default:e(()=>[t(s,{class:"font-bold"},{default:e(()=>u[6]||(u[6]=[p("Всего расходов",-1)])),_:1,__:[6]}),(l(!0),v(x,null,g(_.value,(n,y)=>(l(),f(s,{key:`expenses-val-${y}`,class:"text-center"},{default:e(()=>[r("div",{class:$(["flex justify-center items-center gap-1",n.isIncreased?"text-red-600/90":"",n.isDecreased?"text-green-700/90":"",!n.isIncreased&&!n.isDecreased?"text-slate-500/90":""])},[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o(n.percent.toFixed(2))+"%) ",1)],2)]),_:2},1024))),128))]),_:1})]),_:1}),(F.plData.prodExpensesByPeriod?.length??0)>0?(l(),v(x,{key:0},[t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(d,{class:"text-xl"},{default:e(()=>u[7]||(u[7]=[p("Расходы производства",-1)])),_:1,__:[7]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:`prod-${y}`,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(m,null,{default:e(()=>[t(s,null,{default:e(()=>u[8]||(u[8]=[p("Расходы производства",-1)])),_:1,__:[8]}),(l(!0),v(x,null,g(b(W),(n,y)=>(l(),f(s,{key:`prod-val-${y}`,class:"text-center"},{default:e(()=>[r("div",Se,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o(n.percent.toFixed(2))+"%) ",1)])]),_:2},1024))),128))]),_:1})]),_:1})],64)):O("",!0),(F.plData.adExpenses?.length??0)>0?(l(),v(x,{key:1},[t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(d,{class:"text-xl"},{default:e(()=>u[9]||(u[9]=[p("Расходы на рекламу",-1)])),_:1,__:[9]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:`ad-${y}`,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,null,{default:e(()=>[t(m,null,{default:e(()=>[t(s,null,{default:e(()=>u[10]||(u[10]=[p("Расходы на рекламу",-1)])),_:1,__:[10]}),(l(!0),v(x,null,g(b(V),(n,y)=>(l(),f(s,{key:`ad-val-${y}`,class:"text-center"},{default:e(()=>[r("div",we,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o(n.percent.toFixed(2))+"%) ",1)])]),_:2},1024))),128))]),_:1})]),_:1})],64)):O("",!0),(F.plData.mopSalaries?.length??0)>0||(F.plData.ropSalaries?.length??0)>0||(F.plData.movSalaries?.length??0)>0||(F.plData.designExpensesByPeriod?.length??0)>0?(l(),v(x,{key:2},[t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(d,{class:"text-xl"},{default:e(()=>u[11]||(u[11]=[p("Зарплаты коммерческого отдела",-1)])),_:1,__:[11]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:`salaries-${y}`,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,null,{default:e(()=>[(F.plData.mopSalaries?.length??0)>0?(l(),f(m,{key:0},{default:e(()=>[t(s,null,{default:e(()=>u[12]||(u[12]=[p("Зарплаты менеджеров отдела продаж",-1)])),_:1,__:[12]}),(l(!0),v(x,null,g(b(U),(n,y)=>(l(),f(s,{key:`mop-val-${y}`,class:"text-center"},{default:e(()=>[r("div",$e,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o(n.percent.toFixed(2))+"%) ",1)])]),_:2},1024))),128))]),_:1})):O("",!0),(F.plData.ropSalaries?.length??0)>0?(l(),f(m,{key:1},{default:e(()=>[t(s,null,{default:e(()=>u[13]||(u[13]=[p("Зарплаты ропов ",-1)])),_:1,__:[13]}),(l(!0),v(x,null,g(b(R),(n,y)=>(l(),f(s,{key:`rop-val-${y}`,class:"text-center"},{default:e(()=>[r("div",Ee,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o(n.percent.toFixed(2))+"%) ",1)])]),_:2},1024))),128))]),_:1})):O("",!0),(F.plData.movSalaries?.length??0)>0?(l(),f(m,{key:2},{default:e(()=>[t(s,null,{default:e(()=>u[14]||(u[14]=[p("Зарплаты менеджеров отдела ведения",-1)])),_:1,__:[14]}),(l(!0),v(x,null,g(b(I),(n,y)=>(l(),f(s,{key:`mov-val-${y}`,class:"text-center"},{default:e(()=>[r("div",Te,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o(n.percent.toFixed(2))+"%) ",1)])]),_:2},1024))),128))]),_:1})):O("",!0),(F.plData.designExpensesByPeriod?.length??0)>0?(l(),f(m,{key:3},{default:e(()=>[t(s,null,{default:e(()=>u[15]||(u[15]=[p("Расходы на дизайн",-1)])),_:1,__:[15]}),(l(!0),v(x,null,g(b(c),(n,y)=>(l(),f(s,{key:`design-val-${y}`,class:"text-center"},{default:e(()=>[r("div",je,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o(n.percent.toFixed(2))+"%) ",1)])]),_:2},1024))),128))]),_:1})):O("",!0)]),_:1})],64)):O("",!0),a.plData.expenses?(l(),v(x,{key:3},[t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(d,{class:"text-xl"},{default:e(()=>u[16]||(u[16]=[p("Расходы ",-1)])),_:1,__:[16]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:y,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,null,{default:e(()=>[(l(!0),v(x,null,g(a.plData.expenses.totals.data,(n,y)=>(l(),f(m,{key:y},{default:e(()=>[t(s,null,{default:e(()=>[r("div",null,[r("span",null,o(n.title),1)])]),_:2},1024),(l(!0),v(x,null,g(n.data,(T,N)=>(l(),f(s,{key:N,class:"text-center"},{default:e(()=>[r("div",Ve,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+T.value.toFixed(2))+"₽"),1),r("span",null," ("+o(T.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(m,{class:"text-center bg-slate-300 hover:bg-slate-300"},{default:e(()=>[t(s,{class:"font-bold text-left"},{default:e(()=>u[17]||(u[17]=[p(" ИТОГО ",-1)])),_:1,__:[17]}),(l(!0),v(x,null,g(a.plData.expenses.totals.totals,(n,y)=>(l(),f(s,{key:y},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o((n.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-gray-300 hover:bg-gray-300 py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center"},{default:e(()=>u[18]||(u[18]=[p(" Отдел производствачфцй ",-1)])),_:1,__:[18]})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(d,{class:"text-xl"},{default:e(()=>u[19]||(u[19]=[p("Зарплаты производства ",-1)])),_:1,__:[19]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:y,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,null,{default:e(()=>[(l(!0),v(x,null,g(a.plData.expenses.production.productionSalaries.data,(n,y)=>(l(),f(m,{key:y},{default:e(()=>[t(s,null,{default:e(()=>[p(o(n.role),1)]),_:2},1024),(l(!0),v(x,null,g(n.data,(T,N)=>(l(),f(s,{key:N,class:"text-center"},{default:e(()=>[r("div",Be,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+T.value.toFixed(2))+"₽"),1),r("span",null," ("+o(T.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(m,{class:"text-center bg-slate-300 hover:bg-slate-300"},{default:e(()=>[t(s,{class:"font-bold text-left"},{default:e(()=>u[20]||(u[20]=[p(" ИТОГО ",-1)])),_:1,__:[20]}),(l(!0),v(x,null,g(a.plData.expenses.production.productionSalaries.totals,(n,y)=>(l(),f(s,{key:y},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o((n.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-white hover:bg-white py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center h-4"})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"text-xl text-center font-semibold bg-gray-300 hover:bg-gray-300 py-1 pb-2 border-t-1 rounded-t-xl"},{default:e(()=>[t(d,{colspan:"5",class:"text-center"},{default:e(()=>u[21]||(u[21]=[p(" Коммерческий отдел ",-1)])),_:1,__:[21]})]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(d,{class:"text-xl"},{default:e(()=>u[22]||(u[22]=[p("Расходы на рекламу ",-1)])),_:1,__:[22]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:y,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,null,{default:e(()=>[(l(!0),v(x,null,g(a.plData.expenses.commercial.adExpenses.data,(n,y)=>(l(),f(m,{key:y},{default:e(()=>[t(s,null,{default:e(()=>[p(o(n.title),1)]),_:2},1024),(l(!0),v(x,null,g(n.data,(T,N)=>(l(),f(s,{key:N,class:"text-center"},{default:e(()=>[r("div",Ue,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+T.value.toFixed(2))+"₽"),1),r("span",null," ("+o(T.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(m,{class:"text-center bg-slate-300 hover:bg-slate-300"},{default:e(()=>[t(s,{class:"font-bold text-left"},{default:e(()=>u[23]||(u[23]=[p(" ИТОГО ",-1)])),_:1,__:[23]}),(l(!0),v(x,null,g(a.plData.expenses.commercial.adExpenses.totals,(n,y)=>(l(),f(s,{key:y},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o((n.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1}),t(D,null,{default:e(()=>[t(m,{class:"bg-slate-200 hover:bg-slate-200"},{default:e(()=>[t(d,{class:"text-xl"},{default:e(()=>u[24]||(u[24]=[p("Зарплаты коммерческого отдела ",-1)])),_:1,__:[24]}),(l(!0),v(x,null,g(a.plData.periods,(n,y)=>(l(),f(d,{key:y,class:"text-center"},{default:e(()=>[p(o(n),1)]),_:2},1024))),128))]),_:1})]),_:1}),t(i,null,{default:e(()=>[(l(!0),v(x,null,g(a.plData.expenses.commercial.commercialSalaries.data,(n,y)=>(l(),f(m,{key:y},{default:e(()=>[t(s,null,{default:e(()=>[p(o(n.role),1)]),_:2},1024),(l(!0),v(x,null,g(n.data,(T,N)=>(l(),f(s,{key:N,class:"text-center"},{default:e(()=>[r("div",Ae,[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+T.value.toFixed(2))+"₽"),1),r("span",null," ("+o(T.changePercent)+"%) ",1)])]),_:2},1024))),128))]),_:2},1024))),128)),t(m,{class:"text-center bg-slate-300"},{default:e(()=>[t(s,{class:"font-bold text-left"},{default:e(()=>u[25]||(u[25]=[p(" ИТОГО ",-1)])),_:1,__:[25]}),(l(!0),v(x,null,g(a.plData.expenses.commercial.commercialSalaries.totals,(n,y)=>(l(),f(s,{key:y},{default:e(()=>[r("span",null,o(("useMyFormatPrice"in a?a.useMyFormatPrice:b(M))(+n.value.toFixed(2))+"₽"),1),r("span",null," ("+o((n.changePercent??0).toFixed(2))+"%) ",1)]),_:2},1024))),128))]),_:1})]),_:1})],64)):O("",!0)]),_:1})}}}),Ie={class:"space-y-2"},Ne={class:"flex items-center gap-4"},Re={class:"w-[180px]"},He={class:"px-3"},Oe={key:0,class:"space-y-4"},et=Z({__name:"index",setup(J){me({title:"ПНЛ | Easy CRM"});const{$useApi:F}=ve(),{toast:q}=_e(),j=G({month:new Date().getMonth(),year:new Date().getFullYear()}),z=G({periods:[],income:[],prodExpensesByPeriod:[]}),L=G(new Date().toISOString().slice(0,7)),B=G("book"),W=G(!1),V=[{label:"ИзиНеон",value:"neon"},{label:"ИзиБук",value:"book"}],U=async()=>{W.value=!0;try{if(B.value==="book"){const R=await F.get("/pnl/book",{params:{period:L.value}});z.value=R.data}else{const R=await F.get("/pnl/neon",{params:{period:L.value}});z.value=R.data}}catch{q({variant:"destructive",title:"Ошибка загрузки данных",description:"Не удалось загрузить данные P&L. Попробуйте позже."})}finally{W.value=!1}};return xe(()=>{U()}),X(L,()=>{U()}),X(B,()=>{U()}),X(j,async R=>{const{month:I,year:c}=R;L.value=new Date(c,I+1).toISOString().slice(0,7),await U()}),(R,I)=>{const c=ce,_=ie,h=fe,a=pe,u=de,d=Me,m=Ce,D=ge,s=ye;return l(),v("div",Ie,[r("div",Ne,[r("div",Re,[t(b(be),{modelValue:b(j),"onUpdate:modelValue":I[0]||(I[0]=i=>le(j)?j.value=i:null),"month-picker":"","auto-apply":"",locale:"ru","select-text":"Готово","cancel-text":"Закрыть",clearable:!1},null,8,["modelValue"])]),t(u,{modelValue:b(B),"onUpdate:modelValue":I[1]||(I[1]=i=>le(B)?B.value=i:null)},{default:e(()=>[t(_,{class:"w-[180px]"},{default:e(()=>[t(c,{placeholder:"Выберите проект"})]),_:1}),t(a,null,{default:e(()=>[(l(),v(x,null,g(V,i=>t(h,{key:i.value,value:i.value},{default:e(()=>[p(o(i.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),t(s,{class:""},{default:e(()=>[t(D,{class:"space-y-1 px-0 py-3"},{default:e(()=>[r("div",He,[b(W)?(l(),v("div",Oe,I[2]||(I[2]=[r("div",{class:"bg-slate-100 rounded-sm overflow-hidden p-4"},[r("div",{class:"flex items-center justify-center py-12"},[r("div",{class:"flex flex-col items-center gap-3"},[r("div",{class:"h-12 w-12 animate-spin rounded-full border-4 border-slate-300 border-t-slate-600"}),r("p",{class:"text-slate-600 text-sm font-medium"}," Загрузка данных... ")])])],-1)]))):O("",!0),!b(W)&&b(B)==="neon"?(l(),f(d,{key:1,"pl-data":b(z)},null,8,["pl-data"])):O("",!0),!b(W)&&b(B)==="book"?(l(),f(m,{key:2,"pl-data":b(z)},null,8,["pl-data"])):O("",!0)])]),_:1})]),_:1})])}}});export{et as default};
