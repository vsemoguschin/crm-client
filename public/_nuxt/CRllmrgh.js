import{_ as Qe}from"./Bmr5wyhr.js";import{_ as We,a as Je,b as Xe}from"./DkMjgWCi.js";import{_ as Ze}from"./CY7rJOej.js";import{_ as _e,a as fe,b as ve}from"./CNLsaPwj.js";import{_ as he}from"./BCRlC5xu.js";import{_ as xe}from"./fRExJa2e.js";import{_ as we}from"./CP8umD4q.js";import{_ as ye}from"./BcuVElyA.js";import{_ as Se}from"./mqOaxR0N.js";import{_ as be}from"./YaXf-8Sh.js";import{_ as p,c as ge,v as te}from"./D8Osd5Ax.js";import{_ as ke}from"./B34G8dwx.js";import{_ as et}from"./Da2JRHOT.js";import{_ as tt}from"./BsJBhgTW.js";import{_ as ce,a as ie,b as de}from"./CACSUplU.js";import{_ as at,a as lt,b as st,c as ot,d as nt,e as rt}from"./xEZuT4Nf.js";import{C as ct,_ as it}from"./BUo7Dhyt.js";import{C as dt,a as Ce}from"./BcyKike4.js";import{e as Z,v as ne,m as y,o as r,w as s,b as l,d as _,c as C,D as P,l as o,t as I,F as R,a as n,z as G,A as Q,E as ut,r as b,B as X,G as t,g as De,i as Me,u as pt,H as mt}from"./LcRD3ia0.js";import{X as Te}from"./D5ydJhlK.js";import{_ as Ve}from"./BXoTK-I8.js";import{b as $e,c as Ie,d as Ue,e as Fe,_ as Re,a as Ne}from"./Df1Q6CGn.js";import{_ as Be,a as Ke}from"./DkkQ8vn7.js";import{u as Ae,g as Ge,a as Pe,b as He,F as re,A as w}from"./DSl2Rovl.js";import{u as z}from"./Dt19OLxm.js";import{Q as gt}from"./DVXwaM75.js";import"./DfRdkKc3.js";import"./D9TSNOAg.js";import"./BdQOAs7V.js";import"./BOGtf0gU.js";import"./QkXyQO2w.js";import"./D6LOIvye.js";import"./D8EW8v7U.js";import"./Dxrh8xS6.js";const _t={class:"hidden space-x-1 lg:flex"},ft={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},ze=Z({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(e){const f=e,v=ne(()=>f.column?.getFacetedUniqueValues()),x=ne(()=>new Set(f.column?.getFilterValue()));return(m,T)=>{const $=et,D=tt,g=p,B=ce,i=lt,U=ot,K=rt,E=nt,A=it,W=st,Y=at,J=ie,j=de;return r(),y(j,null,{default:s(()=>[l(B,{"as-child":""},{default:s(()=>[l(g,{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:s(()=>[l(o(ct),{class:"mr-2 h-4 w-4"}),_(" "+I(m.title)+" ",1),x.value.size>0?(r(),C(R,{key:0},[l($,{orientation:"vertical",class:"mx-2 h-4"}),l(D,{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:s(()=>[_(I(x.value.size),1)]),_:1}),n("div",_t,[x.value.size>1?(r(),y(D,{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:s(()=>[_(I(x.value.size),1)]),_:1})):(r(!0),C(R,{key:1},G(m.options.filter(S=>x.value.has(S.value)),S=>(r(),y(D,{key:S.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:s(()=>[_(I(S.label),1)]),_:2},1024))),128))])],64)):P("",!0)]),_:1})]),_:1}),l(J,{class:"w-[200px] p-0",align:"start"},{default:s(()=>[l(Y,{"filter-function":(S,O)=>S.filter(d=>d.label.toLowerCase()?.includes(O))},{default:s(()=>[l(i,{placeholder:m.title},null,8,["placeholder"]),l(W,null,{default:s(()=>[l(U,null,{default:s(()=>T[1]||(T[1]=[_("Нет совпадений.",-1)])),_:1,__:[1]}),l(E,null,{default:s(()=>[(r(!0),C(R,null,G(m.options,S=>(r(),y(K,{key:S.value,value:S,onSelect:O=>{x.value.has(S.value)?x.value.delete(S.value):x.value.add(S.value);const a=Array.from(x.value);m.column?.setFilterValue(a.length?a:void 0)}},{default:s(()=>[n("div",{class:Q(o(ge)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",x.value.has(S.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[l(o(dt),{class:Q(o(ge)("h-4 w-4"))},null,8,["class"])],2),S.icon?(r(),y(ut(S.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):P("",!0),n("span",null,I(S.label),1),v.value?.get(S.value)?(r(),C("span",ft,I(v.value.get(S.value)),1)):P("",!0)]),_:2},1032,["value","onSelect"]))),128))]),_:1}),x.value.size>0?(r(),C(R,{key:0},[l(A),l(E,null,{default:s(()=>[l(K,{value:{label:"Очистить"},class:"justify-center text-center",onSelect:T[0]||(T[0]=S=>m.column?.setFilterValue(void 0))},{default:s(()=>T[2]||(T[2]=[_(" Очистить ",-1)])),_:1,__:[2]})]),_:1})],64)):P("",!0)]),_:1})]),_:1},8,["filter-function"])]),_:1})]),_:1})}}}),vt={class:"flex items-center justify-between"},ht={class:"flex flex-1 items-center space-x-2"},xt=Z({__name:"DataTableToolbar",props:{table:{},wFilters:{},managersFilter:{}},setup(e){const f=e,v=ne(()=>f.table.getState().columnFilters.length>0);return(x,m)=>{const T=ze,$=p;return r(),C("div",vt,[n("div",ht,[x.table.getColumn("workSpace")?(r(),y(T,{key:0,column:x.table.getColumn("workSpace"),title:"Отдел",options:x.wFilters},null,8,["column","options"])):P("",!0),x.table.getColumn("manager")?(r(),y(T,{key:1,column:x.table.getColumn("manager"),title:"Менеджер",options:x.managersFilter},null,8,["column","options"])):P("",!0),v.value?(r(),y($,{key:2,variant:"secondary",class:"h-8 px-2 lg:px-3",onClick:m[0]||(m[0]=D=>x.table.resetColumnFilters())},{default:s(()=>[m[1]||(m[1]=_(" Сброс ",-1)),l(o(Te),{class:"ml-2 h-4 w-4"})]),_:1,__:[1]})):P("",!0)])])}}}),wt={class:"flex mb-2 justify-between ml-[340px]"},yt={class:"bg-slate-100"},St=Z({__name:"DataTable",props:{columns:{},data:{},managers:{}},emits:["table-sorted","on-delete-item"],setup(e,{emit:f}){const v=e,x=b(0),m=b([]),T=b([]),$=b({}),D=Ae({get data(){return v.data},get columns(){return v.columns},getCoreRowModel:He(),getSortedRowModel:Pe(),getFilteredRowModel:Ge(),onSortingChange:i=>te(i,m),onColumnFiltersChange:i=>te(i,T),onColumnVisibilityChange:i=>te(i,$),state:{get sorting(){return m.value},get columnFilters(){return T.value},get columnVisibility(){return $.value}},meta:{deleteItem:i=>B(i.id)}}),g=f,B=i=>{g("on-delete-item",i)};return X(()=>D.getSortedRowModel().rows,i=>{const U=i.map(K=>K.original.id);g("table-sorted",U)},{deep:!0}),(i,U)=>{const K=xt,E=p,A=ce,W=Ve,Y=ie,J=de,j=Ue,S=Ne,O=Ie,d=Re,a=Fe,M=$e,V=Ke,N=Be;return r(),C(R,null,[n("div",wt,[l(K,{table:o(D),"w-filters":[{label:"B2B",value:"B2B"},{label:"ВК",value:"ВК"}],"managers-filter":i.managers},null,8,["table","managers-filter"]),n("div",null,[l(J,null,{default:s(()=>[l(A,null,{default:s(()=>[l(E,{variant:"outline",class:"ml-auto"},{default:s(()=>[U[0]||(U[0]=_(" Колонки ",-1)),l(o(Ce),{class:"w-4 h-4 ml-2"})]),_:1,__:[0]})]),_:1}),l(Y,{class:"w-[180px]"},{default:s(()=>[(r(!0),C(R,null,G(o(D).getAllColumns().filter(u=>u.getCanHide()),u=>(r(),C("div",{key:u.id},[l(W,{checked:u.getIsVisible(),"onUpdate:checked":h=>{u.toggleVisibility(!!h)}},null,8,["checked","onUpdate:checked"]),_(" "+I(u.columnDef.ruName),1)]))),128))]),_:1})]),_:1})])]),n("div",yt,[l(N,{class:"h-[calc(100vh-270px)]"},{default:s(()=>[l(M,{class:"bg-white relative"},{default:s(()=>[l(O,{class:"bg-gray-50 sticky top-0 z-50"},{default:s(()=>[(r(!0),C(R,null,G(o(D).getHeaderGroups(),u=>(r(),y(S,{key:u.id,class:""},{default:s(()=>[(r(!0),C(R,null,G(u.headers,h=>(r(),y(j,{key:h.id},{default:s(()=>[h.isPlaceholder?P("",!0):(r(),y(o(re),{key:0,render:h.column.columnDef.header,props:h.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),l(a,null,{default:s(()=>[o(D).getRowModel().rows?.length?(r(!0),C(R,{key:0},G(o(D).getRowModel().rows,u=>(r(),y(S,{key:u.id,class:Q([o(x)===u.original.id?"bg-slate-300/70":"bg-slate-100","cursor-pointer"]),"data-state":u.getIsSelected()?"selected":void 0},{default:s(()=>[(r(!0),C(R,null,G(u.getVisibleCells(),h=>(r(),y(d,{key:h.id},{default:s(()=>[l(o(re),{render:h.column.columnDef.cell,props:h.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["class","data-state"]))),128)):(r(),y(S,{key:1},{default:s(()=>[l(d,{colspan:i.columns.length,class:"text-left"},{default:s(()=>U[1]||(U[1]=[_(" Нет результатов. ",-1)])),_:1,__:[1]},8,["colspan"])]),_:1}))]),_:1})]),_:1}),l(V,{orientation:"horizontal"})]),_:1})])],64)}}}),bt=[{accessorKey:"date",ruName:"Дата",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Дата",t(w,{class:" h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center text-xs"},e.getValue("date"))},{accessorKey:"manager",ruName:"Менеджер",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Менеджер",t(w,{class:" h-4 w-4"})]),cell:({row:e})=>t("div",{class:"flex flex-col items-center"},[t("span",{},e.getValue("manager")),t("span",{class:"text-xs text-gray-600"},e.getValue("workSpace"))]),filterFn:(e,f,v)=>v.includes(e.getValue(f))},{accessorKey:"workSpace",ruName:"Отдел",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0 hidden"},()=>["Отдел",t(w,{class:" h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center hidden"},e.getValue("workSpace")),filterFn:(e,f,v)=>v.includes(e.getValue(f))},{accessorKey:"calls",ruName:"Заявки",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Заявки",t(w,{class:" h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("calls"))},{accessorKey:"makets",ruName:"Макеты",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Макеты",t(w,{class:" h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("makets"))},{accessorKey:"maketsDayToDay",ruName:"Макеты день в день",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full p-0 text-wrap"},()=>[t("span",{class:"text-wrap"},"Макеты день в день"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("maketsDayToDay"))},{accessorKey:"totalSales",ruName:"Общие продажи",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0 text-wrap"},()=>[t("span",{class:"text-wrap"},"Общие продажи"),t(w,{class:"h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("totalSales"))+"₽")},{accessorKey:"dealSales",ruName:"Продажи по сделкам",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0 text-wrap"},()=>[t("span",{class:"text-wrap"},"Продажи по сделкам"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("dealSales"))+"₽")},{accessorKey:"dealsAmount",ruName:"Количество сделок",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0 text-wrap"},()=>[t("span",{class:"text-wrap"},"Кол-во сделок"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("dealsAmount"))},{accessorKey:"redirectToMSG",ruName:"Переходы в мессенджер",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0 text-wrap"},()=>[t("span",{class:"text-wrap"},"Переходы в мессенджер"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("redirectToMSG"))},{accessorKey:"conversion",ruName:"Конверсия",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Конверсия",t(w,{class:" h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("conversion")+"%")},{accessorKey:"drr",ruName:"ДРР",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["ДРР",t(w,{class:" h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("drr")+"%")},{accessorKey:"dopSales",ruName:"Доп. продажи",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>[t("span",{class:"text-wrap"},"Доп. продажи"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("dopSales"))+"₽")},{accessorKey:"averageBill",ruName:"Средний чек",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0 text-wrap"},()=>[t("span",{class:"text-wrap"},"Средний чек"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("averageBill"))+"₽")},{accessorKey:"dealsDayToDayCount",ruName:"Сделки день в день",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-0 text-wrap"},()=>[t("span",{class:"text-wrap"},"Сделки день в день"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("dealsDayToDayCount"))},{accessorKey:"actions",ruName:"Действия",header:()=>t("div",{class:"text-center"},"Действия"),enableHiding:!1,cell:({row:e,table:f})=>{const v=e.original;return t(p,{class:"h-5 px-1",item:v,onClick:()=>f.options.meta?.deleteItem(v)},()=>"Удалить")}}],kt={class:"flex gap-2 w-full"},Ct={class:"min-w-[250px]"},Dt={class:"flex flex-col gap-5"},Mt={class:"relative"},Tt={class:"relative w-full"},Vt={class:"flex gap-2"},$t={class:"relative"},It={class:"flex gap-2"},Ut={class:"relative"},Ft={class:"flex gap-2"},Rt={class:"relative"},Nt={class:"flex gap-2"},Bt={key:0,class:"relative"},Kt={class:"flex gap-2"},At={class:"w-full overflow-hidden"},Gt={class:"flex gap-1 mb-2"},Pt={class:"w-[300px]"},Ht={class:"mt-[-35px]"},zt=Z({__name:"ManagersReports",setup(e){const{$useApi:f}=De(),v=b(null),x=d=>{v.value=d},m=b(new Date().toISOString().slice(0,7)),T=b({month:new Date().getMonth(),year:new Date().getFullYear()}),$=b([]),D=b(""),g=b({date:new Date().toISOString().slice(0,10),userId:0,calls:0,makets:0,maketsDayToDay:0,redirectToMSG:0}),B=b([{title:"Сумма продаж",value:"0"},{title:"Средний чек",value:"0"},{title:"Конверсия",value:"0"}]);function i(){return`2025-03-${(Math.floor(Math.random()*31)+1).toString().padStart(2,"0")}`}const U=["Bob","Alice","John","Emma","Mike","Sarah","Tom","Lisa","David","Anna"],K=b(Array.from({length:10},(d,a)=>({id:a+1,date:i(),userId:Math.floor(Math.random()*10)+1,calls:Math.floor(Math.random()*100),makets:Math.floor(Math.random()*50),maketsDayToDay:Math.floor(Math.random()*20),manager:U[a],managerId:a+1,totalSales:Math.floor(Math.random()*1e6),dealSales:Math.floor(Math.random()*5e5),dealsAmount:Math.floor(Math.random()*100),conversion:Number((Math.random()*100).toFixed(2)),drr:Number((Math.random()*50).toFixed(2)),dopSales:Math.floor(Math.random()*2e5),averageBill:Math.floor(Math.random()*5e4),dealsDayToDayCount:Math.floor(Math.random()*30)}))),E=b({manager:"Не выбран",dopSales:0,dealSales:0,dealsAmount:0,averageBill:0,dealsDayToDayCount:0,date:new Date().toISOString().slice(0,10)}),A=b(!0),W=async()=>{try{const{data:d}=await f.get("/managers")||[];$.value=d||[]}catch(d){console.log(d)}},Y=async d=>{try{const{data:a}=await f.get(`/reports/manager/${d}/data`,{params:{date:g.value.date}});E.value=a}catch(a){console.log(a)}},J=async()=>{try{const{data:d}=await f.post("reports/manager",g.value);console.log(d),g.value.calls=0,g.value.makets=0,g.value.maketsDayToDay=0,g.value.redirectToMSG=0,await O()}catch(d){console.log(d)}},j=async d=>{try{await f.delete("reports/manager/"+d),await O();return}catch(a){console.log(a)}},S=d=>{const a=K.value.filter(H=>d.includes(H.id)),M=a.reduce((H,q)=>H+q.totalSales,0),V=a.reduce((H,q)=>H+q.dealsAmount,0),N=a.reduce((H,q)=>H+q.calls,0),u=V?+(M/V).toFixed():0,h=N?V/N*100:0;B.value=[{title:"Сумма продаж",value:z(M)+"₽"},{title:"Средний чек",value:z(u)+"₽"},{title:"Конверсия",value:h.toFixed(2)+"%"}]},O=async()=>{try{const{data:d}=await f.get("reports/managers/range",{params:v.value});K.value=d}catch(d){console.log(d)}};return Me(()=>{W(),O()}),X(g,async()=>{/^\d{4}-\d{2}-\d{2}$/.test(g.value.date)&&g.value.userId!==0&&await Y(g.value.userId);const{calls:d,userId:a,maketsDayToDay:M,makets:V}=g.value;d&&a&&M&&V?A.value=!1:A.value=!0},{deep:!0}),X(v,async()=>{await O()},{deep:!0}),X(T,d=>{const{month:a,year:M}=d;m.value=new Date(M,a+1).toISOString().slice(0,7)}),(d,a)=>{const M=ve,V=he,N=fe,u=ye,h=Se,H=be,q=p,ee=xe,ae=we,L=_e,le=ke,se=St;return r(),C("div",kt,[n("div",Ct,[l(L,null,{default:s(()=>[l(N,null,{default:s(()=>[l(M,null,{default:s(()=>a[7]||(a[7]=[_(" Добавить отчет ",-1)])),_:1,__:[7]}),l(V)]),_:1}),l(ee,null,{default:s(()=>[n("div",Dt,[n("div",Mt,[o(g).date?(r(),y(u,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[8]||(a[8]=[_("Дата смены",-1)])),_:1,__:[8]})):P("",!0),l(h,{modelValue:o(g).date,"onUpdate:modelValue":a[0]||(a[0]=c=>o(g).date=c),type:"date",placeholder:"Дата смены",class:Q(o(g).date?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),n("div",Tt,[o(g).userId!==0?(r(),y(u,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[9]||(a[9]=[_("Менеджер",-1)])),_:1,__:[9]})):P("",!0),n("div",Vt,[l(H,{items:o($).map(c=>({value:c.id,label:c.fullName})),label:"Выберите менеджера",onSelectedItem:a[1]||(a[1]=c=>{o(g).userId=c,D.value=o($).find(oe=>oe.id===c)?.workSpace?.title??""})},null,8,["items"])])]),n("div",$t,[l(u,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[10]||(a[10]=[_("Количество заявок",-1)])),_:1,__:[10]}),n("div",It,[l(h,{modelValue:o(g).calls,"onUpdate:modelValue":a[2]||(a[2]=c=>o(g).calls=c),placeholder:"Количество заявок",type:"number",class:Q(o(g).calls?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),n("div",Ut,[l(u,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[11]||(a[11]=[_("Макетов день в день",-1)])),_:1,__:[11]}),n("div",Ft,[l(h,{modelValue:o(g).maketsDayToDay,"onUpdate:modelValue":a[3]||(a[3]=c=>o(g).maketsDayToDay=c),placeholder:"Макетов день в день",type:"number",class:Q(o(g).maketsDayToDay?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),n("div",Rt,[l(u,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[12]||(a[12]=[_("Макетов всего",-1)])),_:1,__:[12]}),n("div",Nt,[l(h,{modelValue:o(g).makets,"onUpdate:modelValue":a[4]||(a[4]=c=>o(g).makets=c),placeholder:"Макетов всего",type:"number",class:Q(o(g).makets?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),o(D)==="B2B"?(r(),C("div",Bt,[l(u,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[13]||(a[13]=[_("Переход в мессенджер",-1)])),_:1,__:[13]}),n("div",Kt,[l(h,{modelValue:o(g).redirectToMSG,"onUpdate:modelValue":a[5]||(a[5]=c=>o(g).redirectToMSG=c),placeholder:"Переход в мессенджер",type:"number",class:Q(o(g).redirectToMSG?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])])):P("",!0),l(q,{disabled:o(A),onClick:J},{default:s(()=>a[14]||(a[14]=[_(" Создать ",-1)])),_:1,__:[14]},8,["disabled"])])]),_:1}),l(ae)]),_:1})]),n("div",At,[n("div",Gt,[(r(!0),C(R,null,G(o(B),c=>(r(),y(L,{key:c.title,class:"min-w-[150px] grow"},{default:s(()=>[l(N,{class:"p-3 pb-2"},{default:s(()=>[l(V,null,{default:s(()=>[_(I(c.title),1)]),_:2},1024),l(M,{class:"text-3xl font-semibold whitespace-nowrap"},{default:s(()=>[_(I(c.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),n("div",Pt,[l(le,{onRangeUpdated:x})]),n("div",Ht,[l(se,{data:o(K),columns:o(bt),managers:o($).map(c=>({label:c.fullName,value:c.fullName})),onTableSorted:a[6]||(a[6]=c=>S(c)),onOnDeleteItem:j},null,8,["data","columns","managers"])])])])}}}),Ot={class:"flex items-center justify-between"},Et={class:"flex flex-1 items-center space-x-2"},jt=Z({__name:"RopDataTableToolbar",props:{table:{},wFilters:{}},setup(e){const f=e,v=ne(()=>f.table.getState().columnFilters.length>0);return(x,m)=>{const T=ze,$=p;return r(),C("div",Ot,[n("div",Et,[x.table.getColumn("group")?(r(),y(T,{key:0,column:x.table.getColumn("group"),title:"Проект",options:x.wFilters},null,8,["column","options"])):P("",!0),v.value?(r(),y($,{key:1,variant:"secondary",class:"h-8 px-2 lg:px-3",onClick:m[0]||(m[0]=D=>x.table.resetColumnFilters())},{default:s(()=>[m[1]||(m[1]=_(" Сброс ",-1)),l(o(Te),{class:"ml-2 h-4 w-4"})]),_:1,__:[1]})):P("",!0)])])}}}),Lt={class:"flex mb-2 justify-between"},Yt={class:"ml-[340px]"},qt={class:"bg-slate-100"},Qt=Z({__name:"RopsDataTable",props:{columns:{},data:{},wFilters:{}},emits:["table-sorted","on-delete-item"],setup(e,{emit:f}){const v=e,x=b(0),m=b([]),T=b([]),$=b({}),D=Ae({get data(){return v.data},get columns(){return v.columns},getCoreRowModel:He(),getSortedRowModel:Pe(),getFilteredRowModel:Ge(),onSortingChange:i=>te(i,m),onColumnFiltersChange:i=>te(i,T),onColumnVisibilityChange:i=>te(i,$),state:{get sorting(){return m.value},get columnFilters(){return T.value},get columnVisibility(){return $.value}},meta:{deleteItem:i=>B(i.id)}}),g=f,B=i=>{g("on-delete-item",i)};return X(()=>D.getSortedRowModel().rows,i=>{const U=i.map(K=>K.original.id);g("table-sorted",U)},{deep:!0}),(i,U)=>{const K=jt,E=p,A=ce,W=Ve,Y=ie,J=de,j=Ue,S=Ne,O=Ie,d=Re,a=Fe,M=$e,V=Ke,N=Be;return r(),C(R,null,[n("div",Lt,[n("div",Yt,[(r(),y(K,{key:i.wFilters.length,table:o(D),"w-filters":i.wFilters},null,8,["table","w-filters"]))]),n("div",null,[l(J,null,{default:s(()=>[l(A,null,{default:s(()=>[l(E,{variant:"outline",class:"ml-auto"},{default:s(()=>[U[0]||(U[0]=_(" Колонки ",-1)),l(o(Ce),{class:"w-4 h-4 ml-2"})]),_:1,__:[0]})]),_:1}),l(Y,{class:"w-[180px]"},{default:s(()=>[(r(!0),C(R,null,G(o(D).getAllColumns().filter(u=>u.getCanHide()),u=>(r(),C("div",{key:u.id},[l(W,{checked:u.getIsVisible(),"onUpdate:checked":h=>{u.toggleVisibility(!!h)}},null,8,["checked","onUpdate:checked"]),_(" "+I(u.columnDef.ruName),1)]))),128))]),_:1})]),_:1})])]),n("div",qt,[l(N,{class:"h-[calc(100vh-390px)]"},{default:s(()=>[l(M,{class:"bg-white relative"},{default:s(()=>[l(O,{class:"bg-gray-50 sticky top-0 z-50"},{default:s(()=>[(r(!0),C(R,null,G(o(D).getHeaderGroups(),u=>(r(),y(S,{key:u.id,class:""},{default:s(()=>[(r(!0),C(R,null,G(u.headers,h=>(r(),y(j,{key:h.id},{default:s(()=>[h.isPlaceholder?P("",!0):(r(),y(o(re),{key:0,render:h.column.columnDef.header,props:h.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),l(a,null,{default:s(()=>[o(D).getRowModel().rows?.length?(r(!0),C(R,{key:0},G(o(D).getRowModel().rows,u=>(r(),y(S,{key:u.id,class:Q([o(x)===u.original.id?"bg-slate-300/70":"bg-slate-100","cursor-pointer"]),"data-state":u.getIsSelected()?"selected":void 0},{default:s(()=>[(r(!0),C(R,null,G(u.getVisibleCells(),h=>(r(),y(d,{key:h.id},{default:s(()=>[l(o(re),{render:h.column.columnDef.cell,props:h.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["class","data-state"]))),128)):(r(),y(S,{key:1},{default:s(()=>[l(d,{colspan:i.columns.length,class:"text-left"},{default:s(()=>U[1]||(U[1]=[_(" Нет результатов. ",-1)])),_:1,__:[1]},8,["colspan"])]),_:1}))]),_:1})]),_:1}),l(V,{orientation:"horizontal"})]),_:1})])],64)}}}),Wt=[{accessorKey:"workSpace",ruName:"Отдел",enableHiding:!0,header:()=>t("div",{class:"hidden p-0"}),cell:()=>t("div",{class:"hidden p-0"})},{accessorKey:"group",ruName:"Проект",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1"},()=>["Проект",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center flex flex-col"},[t("span",{class:"text-slate-800"},e.getValue("group")),t("span",{class:"text-slate-400 text-xs"},e.getValue("workSpace"))]),filterFn:(e,f,v)=>v.includes(e.getValue(f))},{accessorKey:"date",ruName:"Дата",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1"},()=>["Дата",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center text-xs"},e.getValue("date"))},{accessorKey:"calls",ruName:"Заявки",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1"},()=>["Заявки",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("calls"))},{accessorKey:"totalSales",ruName:"Общая сумма продаж",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Общая сумма продаж"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("totalSales"))+"₽")},{accessorKey:"dealSales",ruName:"Сумма сделок",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1"},()=>[t("span",{class:"text-wrap"},"Сумма сделок"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("dealSales"))+"₽")},{accessorKey:"dealsAmount",ruName:"Количество сделок",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Кол-во сделок"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("dealsAmount"))},{accessorKey:"dopSales",ruName:"Сумма доп. продаж",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Сумма доп. продаж"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("dopSales"))+"₽")},{accessorKey:"averageBill",ruName:"Средний чек",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Средний чек"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("averageBill"))+"₽")},{accessorKey:"makets",ruName:"Макеты",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1"},()=>["Макеты",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("makets"))},{accessorKey:"maketsDayToDay",ruName:"Макеты день в день",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Макеты день в день"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("maketsDayToDay"))},{accessorKey:"conversionMaketDayToDay",ruName:"% макет день в день",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"% макет день в день"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("conversionMaketDayToDay")+"%")},{accessorKey:"redirectToMSG",ruName:"Переходы в мессенджер",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Переходы в мессенджер"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("redirectToMSG"))},{accessorKey:"conversion",ruName:"Конверсия",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1"},()=>["Конверсия",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("conversion")+"%")},{accessorKey:"conversionMaket",ruName:"Конверсия в макет",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Конверсия в макет"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("conversionMaket")+"%")},{accessorKey:"conversionToSale",ruName:"Конверсия из макета в продажу",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Конверсия из макета в продажу"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("conversionToSale")+"%")},{accessorKey:"dealsDayToDayCount",ruName:"Заказы день в день",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Заказы день в день"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("dealsDayToDayCount"))},{accessorKey:"conversionDealsDayToDay",ruName:"Конверсия заказов день в день",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Конверсия заказов день в день"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("conversionDealsDayToDay")+"%")},{accessorKey:"callCost",ruName:"Стоимость заявки",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1 text-wrap"},()=>[t("span",{class:"text-wrap"},"Стоимость заявки"),t(w,{class:" h-[34px] w-[34px]"})]),cell:({row:e})=>t("div",{class:"text-center"},z(e.getValue("callCost"))+"₽")},{accessorKey:"drr",ruName:"ДРР",header:({column:e})=>t(p,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),class:"text-center h-full w-full p-1"},()=>["ДРР",t(w,{class:"ml-2 h-4 w-4"})]),cell:({row:e})=>t("div",{class:"text-center"},e.getValue("drr")+"%")},{accessorKey:"actions",ruName:"Действия",header:()=>t("div",{class:"text-center"},"Действия"),enableHiding:!1,cell:({row:e,table:f})=>{const v=e.original;return t(p,{class:"h-5 px-1",item:v,onClick:()=>f.options.meta?.deleteItem(v)},()=>"Удалить")}}],Jt={class:"flex gap-2 w-full"},Xt={class:"min-w-[250px]"},Zt={class:"flex flex-col gap-5"},ea={class:"relative"},ta={class:"relative w-full"},aa={class:"flex gap-2 w-full"},la={class:"relative"},sa={class:"flex gap-2"},oa={class:"relative"},na={class:"flex gap-2"},ra={class:"relative"},ca={class:"flex gap-2"},ia={class:"relative"},da={class:"flex gap-2"},ua={class:"flex flex-col gap-1 mt-4 text-slate-500"},pa={class:"w-full overflow-hidden"},ma={class:"flex flex-col gap-1 mb-2"},ga={class:"flex gap-2"},_a={class:"flex gap-2"},fa={class:"flex gap-2"},va={class:"w-[300px]"},ha={class:"mt-[-34px]"},xa=Z({__name:"RopsReports",setup(e){const{$useApi:f}=De(),v=b(null),x=d=>{v.value=d},m=b(new Date().toISOString().slice(0,7)),T=b({month:new Date().getMonth(),year:new Date().getFullYear()}),$=b([]),D=b("Не выбран"),g=b([]),B=b([{title:"Сумма продаж",value:"0"},{title:"Средний чек",value:"0"},{title:"Конверсия",value:"0"},{title:"Стоимость заявки",value:"0"}]),i=b({date:new Date().toISOString().slice(0,10),workSpaceId:0,groupId:0,calls:0,makets:0,maketsDayToDay:0,redirectToMSG:0});function U(){return`2025-03-${(Math.floor(Math.random()*31)+1).toString().padStart(2,"0")}`}const K=["Офис А","Офис Б","Офис В","Склад 1","Склад 2","Центр","Юг","Север","Запад","Восток"],E=b(Array.from({length:10},(d,a)=>({id:a+1,date:U(),workSpaceId:Math.floor(Math.random()*10)+1,calls:Math.floor(Math.random()*100),dealSales:Math.floor(Math.random()*5e5),dealsAmount:Math.floor(Math.random()*100),dopSales:Math.floor(Math.random()*2e5),totalSales:Math.floor(Math.random()*1e6),averageBill:Math.floor(Math.random()*5e4),makets:Math.floor(Math.random()*50),conversion:Number((Math.random()*100).toFixed(2)),conversionMaket:Number((Math.random()*100).toFixed(2)),conversionToSale:Number((Math.random()*100).toFixed(2)),dealsDayToDayCount:Math.floor(Math.random()*30),conversionDealsDayToDay:Number((Math.random()*100).toFixed(2)),workSpace:K[a],callCost:Math.floor(Math.random()*1e4),drr:Number((Math.random()*50).toFixed(2)),dateExpensesPrice:Math.floor(Math.random()*1e5),redirectToMSG:Math.floor(Math.random()*100),maketsDayToDay:Math.floor(Math.random()*50)}))),A=b({workSpace:"Не выбран",date:new Date().toISOString().slice(0,10),workSpaceId:0,dealSales:0,dealsAmount:0,dopSales:0,totalSales:0,averageBill:0,dealsDayToDayCount:0}),W=async()=>{try{const{data:d}=await f.get("reports/groups-list")||[];$.value=d||[]}catch(d){console.log(d)}},Y=b(!0),J=async()=>{const{data:d}=await f.post("reports/rop",{...i.value});i.value.calls=0,i.value.makets=0,i.value.maketsDayToDay=0,i.value.redirectToMSG=0,await j()},j=async()=>{const{data:d}=await f.get("reports/rops/range",{params:v.value});E.value=d,g.value=d.map(a=>({value:a.workSpace,label:a.workSpace}))},S=async d=>{console.log(d),await f.delete("reports/rop/"+d),await j()},O=d=>{const a=E.value.filter(k=>d.includes(k.id)),M=a.reduce((k,F)=>k+(F.totalSales??0),0),V=a.reduce((k,F)=>k+(F.dealsAmount??0),0),N=a.reduce((k,F)=>k+F.calls,0),u=V?+(M/V).toFixed():0,h=N?V/N*100:0,H=a.reduce((k,F)=>k+(F.dateExpensesPrice??0),0),q=N?H/N:0,ee=a.reduce((k,F)=>k+F.calls,0),ae=M?H/M*100:0,L=a.reduce((k,F)=>k+F.makets,0),le=L?L/ee*100:0,se=L?V/L*100:0,c=V?+(H/V).toFixed():0;function oe(k,F){return new Date(k,F,0).getDate()}const ue=oe(+m.value.split("-")[0],+m.value.split("-")[1]),Oe=m.value.split("-")[1]===new Date().toISOString().slice(5,7)?new Date().toISOString().slice(8,10):ue,Ee=+(M/+Oe*ue).toFixed(),je=a.reduce((k,F)=>k+(F.redirectToMSG??0),0),pe=a.filter(k=>k.workSpace==="B2B").reduce((k,F)=>k+F.calls,0),Le=pe?je/pe*100:0,me=a.filter(k=>k.workSpace==="ВК").reduce((k,F)=>k+F.calls,0),Ye=a.filter(k=>k.workSpace==="ВК").reduce((k,F)=>k+(F.maketsDayToDay??0),0),qe=me?Ye/me*100:0;B.value=[{title:`Сумма продаж (сделок: ${V})`,value:z(M)+"₽"},{title:"Средний чек",value:z(u)+"₽"},{title:"Заявки",value:ee.toFixed()},{title:"Стоимость заявки",value:q.toFixed(2)+"₽"},{title:"ДРР",value:ae.toFixed(2)+"%"},{title:"Конверсия",value:h.toFixed(2)+"%"},{title:"% в макет",value:le.toFixed(2)+"%"},{title:"% из макета в продажу",value:se.toFixed(2)+"%"},{title:"Темп",value:z(Ee)+"₽"},{title:"Стоимость продажи",value:z(c)+"₽"},{title:"% переход в мессенджер(Авито)",value:Le.toFixed(2)+"%"},{title:"% день в день(ВК)",value:qe.toFixed(2)+"%"}]};return X(i,async()=>{const{groupId:d}=i.value;d?Y.value=!1:Y.value=!0},{deep:!0}),X(v,async()=>{await j()},{deep:!0}),X(T,d=>{const{month:a,year:M}=d;m.value=new Date(M,a+1).toISOString().slice(0,7)}),Me(async()=>{await W(),await j()}),(d,a)=>{const M=ve,V=he,N=fe,u=ye,h=Se,H=be,q=p,ee=xe,ae=we,L=_e,le=ke,se=Qt;return r(),C("div",Jt,[n("div",Xt,[l(L,null,{default:s(()=>[l(N,null,{default:s(()=>[l(M,null,{default:s(()=>a[7]||(a[7]=[_(" Добавить отчет ",-1)])),_:1,__:[7]}),l(V)]),_:1}),l(ee,null,{default:s(()=>[n("div",Zt,[n("div",ea,[o(i).date?(r(),y(u,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[8]||(a[8]=[_("Дата смены",-1)])),_:1,__:[8]})):P("",!0),l(h,{modelValue:o(i).date,"onUpdate:modelValue":a[0]||(a[0]=c=>o(i).date=c),type:"date",placeholder:"Дата смены",class:Q(o(i).date?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),n("div",ta,[o(i).workSpaceId!==0?(r(),y(u,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[9]||(a[9]=[_("Отдел",-1)])),_:1,__:[9]})):P("",!0),n("div",aa,[l(H,{items:o($).map(c=>({value:c.id,label:c.title})),class:"w-full",label:"Выберите группу",onSelectedItem:a[1]||(a[1]=c=>{o(i).groupId=c,D.value=o($).find(oe=>oe.id===c)?.title||""})},null,8,["items"])])]),n("div",la,[l(u,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[10]||(a[10]=[_("Количество заявок",-1)])),_:1,__:[10]}),n("div",sa,[l(h,{modelValue:o(i).calls,"onUpdate:modelValue":a[2]||(a[2]=c=>o(i).calls=c),placeholder:"Количество заявок",type:"number"},null,8,["modelValue"])])]),n("div",oa,[l(u,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[11]||(a[11]=[_("Макетов всего",-1)])),_:1,__:[11]}),n("div",na,[l(h,{modelValue:o(i).makets,"onUpdate:modelValue":a[3]||(a[3]=c=>o(i).makets=c),placeholder:"Макетов всего",type:"number"},null,8,["modelValue"])])]),n("div",ra,[l(u,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[12]||(a[12]=[_("Макетов день в день",-1)])),_:1,__:[12]}),n("div",ca,[l(h,{modelValue:o(i).maketsDayToDay,"onUpdate:modelValue":a[4]||(a[4]=c=>o(i).maketsDayToDay=c),placeholder:"Макетов день в день",type:"number"},null,8,["modelValue"])])]),n("div",ia,[l(u,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>a[13]||(a[13]=[_("Переход в мессенджер",-1)])),_:1,__:[13]}),n("div",da,[l(h,{modelValue:o(i).redirectToMSG,"onUpdate:modelValue":a[5]||(a[5]=c=>o(i).redirectToMSG=c),placeholder:"Переход в мессенджер",type:"number"},null,8,["modelValue"])])]),l(q,{disabled:o(Y),onClick:J},{default:s(()=>a[14]||(a[14]=[_(" Создать ",-1)])),_:1,__:[14]},8,["disabled"])]),n("div",ua,[n("span",null," Отдел: "+I(o(A).workSpace),1),n("span",null," Сумма продаж: "+I(o(A).dealSales)+"р.",1),n("span",null," Сумма доп.продаж: "+I(o(A).dopSales)+"р. ",1),n("span",null," Сумма общая: "+I(o(A).totalSales)+"р. ",1),n("span",null," Количество сделок: "+I(o(A).dealsAmount),1),n("span",null," Средний чек: "+I(o(A).averageBill)+"р.",1),n("span",null," Сделок день в день: "+I(o(A).dealsDayToDayCount),1)])]),_:1}),l(ae)]),_:1})]),n("div",pa,[n("div",ma,[n("div",ga,[(r(!0),C(R,null,G(o(B).slice(0,4),c=>(r(),y(L,{key:c.title,class:"w-full grow"},{default:s(()=>[l(N,{class:"py-1 px-3"},{default:s(()=>[l(V,null,{default:s(()=>[_(I(c.title),1)]),_:2},1024),l(M,{class:"text-2xl font-semibold whitespace-nowrap"},{default:s(()=>[_(I(c.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),n("div",_a,[(r(!0),C(R,null,G(o(B).slice(4,8),c=>(r(),y(L,{key:c.title,class:"w-full grow"},{default:s(()=>[l(N,{class:"py-1 px-3"},{default:s(()=>[l(V,null,{default:s(()=>[_(I(c.title),1)]),_:2},1024),l(M,{class:"text-2xl font-semibold whitespace-nowrap"},{default:s(()=>[_(I(c.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),n("div",fa,[(r(!0),C(R,null,G(o(B).slice(8),c=>(r(),y(L,{key:c.title,class:"w-full grow"},{default:s(()=>[l(N,{class:"py-1 px-3"},{default:s(()=>[l(V,null,{default:s(()=>[_(I(c.title),1)]),_:2},1024),l(M,{class:"text-2xl font-semibold whitespace-nowrap"},{default:s(()=>[_(I(c.value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])]),n("div",va,[l(le,{onRangeUpdated:x})]),n("div",ha,[l(se,{data:o(E),"w-filters":o($).map(c=>({value:c.title,label:c.title})),columns:o(Wt),onTableSorted:a[6]||(a[6]=c=>O(c)),onOnDeleteItem:S},null,8,["data","w-filters","columns"])])])])}}}),wa={class:"relative h-screen hidden-scrollbar"},ya={class:"w-full fixed z-10"},Sa={class:"h-full flex flex-col p-4 gap-2 mx-[auto] max-w-[2048px] pt-16 min-w-[1024px]"},ba={class:"flex gap-6"},ka={class:"w-[250px]"},Ca={class:"flex gap-2 w-full h-full"},Da={class:"ml-[260px] mt-[-48px]"},cl=Z({__name:"index",setup(e){pt({title:"Отчеты | Easy CRM"});const f=b(new Date().toISOString().slice(0,7)),v=b({month:new Date().getMonth(),year:new Date().getFullYear()});return X(v,async x=>{const{month:m,year:T}=x;f.value=new Date(T,m+1).toISOString().slice(0,7)}),(x,m)=>{const T=Qe,$=Xe,D=Je,g=zt,B=Ze,i=xa,U=We;return r(),C("div",wa,[n("div",ya,[l(T)]),n("div",Sa,[n("div",ba,[n("div",ka,[l(o(gt),{modelValue:o(v),"onUpdate:modelValue":m[0]||(m[0]=K=>mt(v)?v.value=K:null),"month-picker":"","auto-apply":"",locale:"ru","select-text":"Готово","cancel-text":"Закрыть",clearable:!1},null,8,["modelValue"])])]),n("div",Ca,[l(U,{"default-value":"Менеджер",class:"w-full"},{default:s(()=>[n("div",Da,[l(D,null,{default:s(()=>[l($,{value:"Менеджер"},{default:s(()=>m[1]||(m[1]=[_("Менеджер",-1)])),_:1,__:[1]}),l($,{value:"РОП"},{default:s(()=>m[2]||(m[2]=[_("РОП",-1)])),_:1,__:[2]})]),_:1})]),l(B,{value:"Менеджер",class:""},{default:s(()=>[(r(),y(g,{key:o(f),period:o(f)},null,8,["period"]))]),_:1}),l(B,{value:"РОП"},{default:s(()=>[(r(),y(i,{key:o(f),period:o(f)},null,8,["period"]))]),_:1}),l(B,{value:"Менеджер ведения"},{default:s(()=>m[3]||(m[3]=[n("h2",null,"Отчет: Менеджер ведения",-1)])),_:1,__:[3]}),l(B,{value:"Дизайнер"},{default:s(()=>m[4]||(m[4]=[n("h2",null,"Отчет: Дизайнер",-1)])),_:1,__:[4]})]),_:1})])])])}}});export{cl as default};
