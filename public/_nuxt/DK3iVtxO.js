import{_ as It}from"./Bye7C16d.js";import{_ as Ft}from"./CsZkzt_A.js";import{_ as Ge,a as Le,b as ze}from"./BF3m7Vf0.js";import{_ as nt,a as it,b as ut,c as rt,d as dt}from"./JYeLPbKT.js";import{_ as ct}from"./DLLw9AXE.js";import{_ as Nt}from"./BFj2DODp.js";import{_ as Ue}from"./CprHmdOe.js";import{b as ve,c as fe,a as ge,d as ye,_ as be,e as xe}from"./C6vK2VYI.js";import{_ as we}from"./Dvvl7uzq.js";import{_ as Pe,a as xt}from"./DVdymwQ5.js";import{b as Ve,c as Ce,d as Se,_ as Me,a as pt}from"./cStEOrWd.js";import{_ as Re}from"./BHuR11Jx.js";import{_ as De}from"./DiZ4QL0M.js";import{_ as Oe}from"./C30fSUvl.js";import{_ as Be}from"./QXfa84Px.js";import{_ as Ee}from"./CDst0A0O.js";import{e as ne,g as ie,h as re,r as m,v as ke,B as ee,c as d,o as a,b as e,w as t,a as l,d as i,D as S,m as I,A as X,F as se,z as ae,t as p,i as _e,l as o,k as Je,u as mt,H as $e}from"./BbheI0mw.js";import{_ as wt}from"./D-8t_H8v.js";import{_ as st}from"./D0zfKHPR.js";import{_ as ht,a as kt}from"./l1eRtAXP.js";import{_ as $t}from"./BhleEUCu.js";import{_ as Ut}from"./BND4UK_1.js";import{_ as Gt}from"./CaiudRgb.js";import{_ as Vt}from"./CHKwxJtM.js";import{u as pe}from"./Dt19OLxm.js";import{u as Ie}from"./DzJc7hp_.js";import{E as Lt,_ as Ct}from"./CSgLdkbr.js";import{c as zt}from"./D2GZmoDz.js";import{_ as at}from"./C5Bd_Bx3.js";import{n as Bt,s as gt,Q as Te,b as ot,a as Ke,c as Ze,d as At,f as et}from"./C_rPMSjE.js";import{_ as Wt,a as Ht,s as jt,b as qt}from"./CJuSa-E2.js";import{_ as St,a as Mt,b as Rt}from"./D0Fd2yXn.js";import{_ as Dt,a as Tt}from"./CMmcwG__.js";import{_ as Pt}from"./CKaAbd73.js";import{_ as Ot}from"./C8Hj2bae.js";import{d as Yt}from"./Cxp-zkhu.js";import"./CaPtdwNj.js";import"./KSX9JOtw.js";import"./ZTyVILcU.js";import"./B9M8ggfK.js";import"./s39mgViW.js";import"./CJOOd8Dx.js";import"./BR3DQNok.js";import"./odSmgr3d.js";import"./CCknexPU.js";import"./BuyaVAog.js";import"./_14b2CUj.js";import"./CssJESp-.js";import"./oLxPQbNe.js";import"./DAmwS8V7.js";import"./DAy9nm00.js";import"./C-JUEUN9.js";import"./BWn7SjA7.js";import"./DFFUo3JN.js";import"./DImM_Wqr.js";import"./lvbecDJM.js";import"./Boz4PYjF.js";/**
 * @license lucide-vue-next v0.514.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=zt("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);function yt(L,B,z){const[P,M]=Bt(z?.in,L,B);return+gt(P,z)==+gt(M,z)}const Xt={class:"flex flex-col gap-5"},Kt={class:"relative"},Zt={key:0,class:"relative"},Qt={key:1,class:"relative"},Jt={class:"relative"},el={class:"flex gap-2"},tl={class:"relative"},ll={class:"flex gap-2"},sl={class:"relative"},al={class:"flex gap-2"},ol={class:"flex flex-col gap-4"},nl={class:"relative"},il={key:0,class:"flex gap-2"},ul={class:"relative"},rl={class:"relative"},dl={key:2,class:"relative"},cl={class:"relative"},pl={class:"flex flex-col gap-1 border-t pt-2"},ml={key:0},_l={class:"font-semibold text-lg"},vl={class:"flex justify-between w-full gap-2"},_t=ne({__name:"EditMasterReport",props:{report:{},curUser:{}},emits:["report-updated","close"],setup(L,{emit:B}){const{$useApi:z}=ie(),{toast:P}=re(),M=B,k=L,R=m(!0),U=m(!0),r=["Стандартная","Уличная","РГБ","Смарт","Контражур","РГБ Контражур","ВБ","ОЗОН","Подарок"],v=["Стандартная","Контражур","Подарок","Уличная","Уличная подсветка","РГБ Контражур","РГБ","Смарт"],_=["Контражур","РГБ Контражур"],y=m({...k.report,lightingType:k.report.lightingType||"none"}),c=()=>{const{metrs:f,els:u,type:E}=y.value;let O=0;if(k.curUser?.workSpaceId===8)switch(E){case"Стандартная":case"ВБ":case"ОЗОН":case"Подарок":O=f*60+u*30;break;case"Уличная":O=f*90+u*45;break;case"Уличная подсветка":O=f*54+u*37;break;case"РГБ Контражур":O=f*80+u*67;break;case"РГБ":case"Смарт":O=f*84+u*42;break;case"Контражур":O=f*36+u*18;break;default:O=0}else switch(E){case"Стандартная":case"ВБ":case"ОЗОН":case"Подарок":O=f*100+u*50;break;case"Уличная":case"РГБ Контражур":O=f*130+u*70;break;case"РГБ":case"Смарт":O=f*140+u*150;break;case"Контражур":O=f*60+u*30;break;default:O=0}y.value.cost=O},n=()=>{const{lightingLength:f,lightingElements:u,lightingType:E}=y.value;let O=0;const A=!E||E==="none"||E==="";if(A||!f||!u){y.value.lightingCost=0,A&&(y.value.lightingLength=0,y.value.lightingElements=0,y.value.lightingType="none");return}if(k.curUser?.workSpaceId===8)switch(E){case"Контражур":O=f*36+u*18;break;case"РГБ Контражур":O=f*80+u*67;break;default:O=0}else switch(E){case"Контражур":O=f*60+u*30;break;case"РГБ Контражур":O=f*130+u*70;break;default:O=0}y.value.lightingCost=O},w=ke(()=>(y.value.cost||0)+(y.value.lightingCost??0)),j=ke(()=>{const{lightingType:f,lightingLength:u,lightingElements:E}=y.value,O=!f||f==="none"||f==="";return!(!O&&f||(u??0)>0||(E??0)>0)?!0:!!(!O&&f&&(u??0)>0&&(E??0)>0)}),$=ke(()=>{const{lightingType:f,lightingLength:u,lightingElements:E}=y.value;return!!(!(!f||f==="none"||f==="")&&f||(u??0)>0||(E??0)>0)&&!j.value}),s=async()=>{try{U.value=!0;const f={...y.value,lightingType:y.value.lightingType==="none"?"":y.value.lightingType};await z.patch(`production/master-report/${y.value.id}`,f),R.value=!1,M("report-updated"),U.value=!1,P({title:"Успех",description:"Отчет успешно обновлен"})}catch(f){console.log(f)}},x=async()=>{try{await z.delete(`production/master-report/${y.value.id}`),R.value=!1,M("report-updated"),P({title:"Успех",description:"Отчет успешно удален"})}catch(f){console.log(f)}};return ee(y,()=>{const{date:f,name:u,metrs:E,els:O,type:A}=y.value;c(),n();const F=!!(f&&u&&E>0&&O>0&&A);U.value=!(F&&j.value)},{deep:!0}),ee(R,f=>{f||M("close")}),(f,u)=>{const E=Se,O=Re,A=Ce,F=Oe,V=Ue,T=ut,h=it,C=dt,W=ct,D=rt,Y=nt,le=Be,N=Ee,g=De,b=Ve,G=Me;return a(),d("div",null,[e(G,{open:R.value,"onUpdate:open":u[11]||(u[11]=H=>R.value=H)},{default:t(()=>[e(b,{class:"max-w-[400px] flex flex-col top-0 translate-y-[0px] max-h-[90vh] overflow-y-auto"},{default:t(()=>[e(A,null,{default:t(()=>[e(E,null,{default:t(()=>u[12]||(u[12]=[i("Редактировать запись",-1)])),_:1,__:[12]}),e(O)]),_:1}),l("div",Xt,[l("div",Kt,[y.value.date?(a(),I(F,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>u[13]||(u[13]=[i("Дата смены",-1)])),_:1,__:[13]})):S("",!0),e(V,{modelValue:y.value.date,"onUpdate:modelValue":u[0]||(u[0]=H=>y.value.date=H),type:"date",min:new Date().toISOString().slice(0,10),placeholder:"Дата смены",class:X(y.value.date?"":"outline-1 outline-rose-300")},null,8,["modelValue","min","class"])]),k.curUser.workSpaceId!==8?(a(),d("div",Zt,[y.value.type?(a(),I(F,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>u[14]||(u[14]=[i("Тип",-1)])),_:1,__:[14]})):S("",!0),l("div",{class:X(y.value.type?"":"outline-1 outline-rose-300 rounded-md")},[e(Y,{modelValue:y.value.type,"onUpdate:modelValue":u[1]||(u[1]=H=>y.value.type=H)},{default:t(()=>[e(h,null,{default:t(()=>[e(T,{placeholder:"Тип"})]),_:1}),e(D,null,{default:t(()=>[(a(),d(se,null,ae(r,(H,oe)=>e(W,{key:oe},{default:t(()=>[e(C,{value:H},{default:t(()=>[i(p(H),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])],2)])):(a(),d("div",Qt,[y.value.type?(a(),I(F,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>u[15]||(u[15]=[i("Тип",-1)])),_:1,__:[15]})):S("",!0),l("div",{class:X(y.value.type?"":"outline-1 outline-rose-300 rounded-md")},[e(Y,{modelValue:y.value.type,"onUpdate:modelValue":u[2]||(u[2]=H=>y.value.type=H)},{default:t(()=>[e(h,null,{default:t(()=>[e(T,{placeholder:"Тип"})]),_:1}),e(D,null,{default:t(()=>[(a(),d(se,null,ae(v,(H,oe)=>e(W,{key:oe},{default:t(()=>[e(C,{value:H},{default:t(()=>[i(p(H),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])],2)])),l("div",Jt,[y.value.name?(a(),I(F,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>u[16]||(u[16]=[i("Название или ссылка",-1)])),_:1,__:[16]})):S("",!0),e(V,{modelValue:y.value.name,"onUpdate:modelValue":u[3]||(u[3]=H=>y.value.name=H),placeholder:"Название или ссылка",class:X(y.value.name?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",el,[l("div",tl,[e(F,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>u[17]||(u[17]=[i("Элементы",-1)])),_:1,__:[17]}),l("div",ll,[e(V,{modelValue:y.value.els,"onUpdate:modelValue":u[4]||(u[4]=H=>y.value.els=H),modelModifiers:{number:!0},placeholder:"Элементы",type:"number",min:"0",class:X(y.value.els>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),l("div",sl,[e(F,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>u[18]||(u[18]=[i("Метры",-1)])),_:1,__:[18]}),l("div",al,[e(V,{modelValue:y.value.metrs,"onUpdate:modelValue":u[5]||(u[5]=H=>y.value.metrs=H),modelModifiers:{number:!0},placeholder:"Метры",type:"number",min:"0",class:X(y.value.metrs>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])])]),l("div",ol,[l("div",nl,[e(Y,{modelValue:y.value.lightingType,"onUpdate:modelValue":u[6]||(u[6]=H=>y.value.lightingType=H)},{default:t(()=>[e(h,{class:X($.value&&(!y.value.lightingType||y.value.lightingType==="none")?"outline-1 outline-rose-300":"")},{default:t(()=>[e(T,{placeholder:"Тип "})]),_:1},8,["class"]),e(D,null,{default:t(()=>[e(C,{value:"none"},{default:t(()=>u[19]||(u[19]=[i("Без подсветки",-1)])),_:1,__:[19]}),(a(),d(se,null,ae(_,(H,oe)=>e(W,{key:oe},{default:t(()=>[e(C,{value:H},{default:t(()=>[i(p(H),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),y.value.lightingType&&y.value.lightingType!=="none"?(a(),d("div",il,[l("div",ul,[e(F,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>u[20]||(u[20]=[i("Метры ",-1)])),_:1,__:[20]}),e(V,{modelValue:y.value.lightingLength,"onUpdate:modelValue":u[7]||(u[7]=H=>y.value.lightingLength=H),modelModifiers:{number:!0},placeholder:"Метры",type:"number",min:"0",class:X($.value&&!(y.value.lightingLength??0)?"outline-1 outline-rose-300":"")},null,8,["modelValue","class"])]),l("div",rl,[e(F,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>u[21]||(u[21]=[i("Элементы ",-1)])),_:1,__:[21]}),e(V,{modelValue:y.value.lightingElements,"onUpdate:modelValue":u[8]||(u[8]=H=>y.value.lightingElements=H),modelModifiers:{number:!0},placeholder:"Элементы",type:"number",min:"0",class:X($.value&&!(y.value.lightingElements??0)?"outline-1 outline-rose-300":"")},null,8,["modelValue","class"])])])):S("",!0)]),["PACKER","MASTER"].includes(f.curUser?.role.shortName||"")?S("",!0):(a(),d("div",dl,[e(F,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>u[22]||(u[22]=[i("Штраф",-1)])),_:1,__:[22]}),e(V,{modelValue:y.value.penaltyCost,"onUpdate:modelValue":u[9]||(u[9]=H=>y.value.penaltyCost=H),placeholder:"Штраф",type:"number"},null,8,["modelValue"])])),l("div",cl,[e(le,{modelValue:y.value.comment,"onUpdate:modelValue":u[10]||(u[10]=H=>y.value.comment=H),placeholder:"Комментарий"},null,8,["modelValue"]),y.value.comment?(a(),I(F,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>u[23]||(u[23]=[i(" Комментарий ",-1)])),_:1,__:[23]})):S("",!0)]),l("div",pl,[l("span",null," Стоимость основной работы: "+p(y.value.cost)+"р. ",1),(y.value.lightingCost??0)>0?(a(),d("span",ml," Стоимость подсветки: "+p(y.value.lightingCost)+"р. ",1)):S("",!0),l("span",_l," Общая стоимость: "+p(w.value)+"р. ",1)])]),e(g,{class:"w-full"},{default:t(()=>[l("div",vl,[e(N,{variant:"destructive",onClick:x},{default:t(()=>u[24]||(u[24]=[i(" Удалить ",-1)])),_:1,__:[24]}),e(N,{disabled:U.value,onClick:s},{default:t(()=>u[25]||(u[25]=[i(" Сохранить ",-1)])),_:1,__:[25]},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),fl={class:"flex flex-col gap-5"},gl={class:"relative"},yl={class:"relative"},bl={class:"relative"},xl={class:"flex gap-2"},wl={class:"relative"},hl={class:"relative"},kl={class:"relative"},$l={class:"flex gap-2"},Ul={class:"relative"},Vl={class:"relative"},Cl={class:"flex gap-2"},Sl={class:"relative"},Ml={class:"relative"},Rl={class:"flex justify-between w-full gap-2"},vt=ne({__name:"EditMasterRepairReport",props:{report:{},curUser:{}},emits:["report-updated","close"],setup(L,{emit:B}){const{$useApi:z}=ie(),{toast:P}=re(),M=B,k=L,R=m(!0),U=m(!1),r=["Стандартная","Уличная","РГБ","Смарт"],v=m({...k.report}),_=()=>{const{metrs:n,els:w,type:j,grinding:$,unpackage:s,unpackageBig:x,acoustics:f,smartContr:u}=v.value;let E=0;if(k.curUser.workSpaceId!==8){switch(j){case"Стандартная":E=n*130+w*70;break;case"Уличная":E=n*140+w*80;break;case"РГБ":E=n*150+w*200;break;case"Смарт":E=n*160+w*180;break;default:E=0}E+=s*50,E+=$*350,E+=x*100,E+=f*150,E+=u*200}else{switch(j){case"Стандартная":E=n*80+w*40;break;case"Уличная":E=n*90+w*45;break;case"РГБ":E=n*100+w*90;break;case"Смарт":E=n*75+w*80;break;default:E=0}E+=$*200,E+=s*50,E+=x*100,E+=f*50,E+=u*200}v.value.cost=E},y=async()=>{try{await z.patch(`production/master-repair/${v.value.id}`,v.value),R.value=!1,M("report-updated"),P({title:"Успех",description:"Ремонтный отчет успешно обновлен"})}catch(n){console.log(n)}},c=async()=>{try{await z.delete(`production/master-repair/${v.value.id}`),R.value=!1,M("report-updated"),P({title:"Успех",description:"Ремонтный отчет успешно удален"})}catch(n){console.log(n)}};return ee(v,()=>{const{date:n,name:w,metrs:j,els:$,type:s}=v.value;_(),U.value=!(n&&w&&j>=0&&$>=0&&s)},{deep:!0}),ee(R,n=>{n||M("close")}),(n,w)=>{const j=Se,$=Re,s=Ce,x=Oe,f=Ue,u=ut,E=it,O=dt,A=ct,F=rt,V=nt,T=Ee,h=De,C=Ve,W=Me;return a(),d("div",null,[e(W,{open:R.value,"onUpdate:open":w[10]||(w[10]=D=>R.value=D)},{default:t(()=>[e(C,{class:"max-w-[400px] flex flex-col top-0 translate-y-[0px]"},{default:t(()=>[e(s,null,{default:t(()=>[e(j,null,{default:t(()=>w[11]||(w[11]=[i("Редактировать ремонтный отчет",-1)])),_:1,__:[11]}),e($)]),_:1}),l("div",fl,[l("div",gl,[v.value.date?(a(),I(x,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>w[12]||(w[12]=[i("Дата смены",-1)])),_:1,__:[12]})):S("",!0),e(f,{modelValue:v.value.date,"onUpdate:modelValue":w[0]||(w[0]=D=>v.value.date=D),type:"date",placeholder:"Дата смены",class:X(v.value.date?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",yl,[v.value.type?(a(),I(x,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>w[13]||(w[13]=[i("Тип",-1)])),_:1,__:[13]})):S("",!0),l("div",{class:X(v.value.type?"":"outline-1 outline-rose-300 rounded-md")},[e(V,{modelValue:v.value.type,"onUpdate:modelValue":w[1]||(w[1]=D=>v.value.type=D)},{default:t(()=>[e(E,null,{default:t(()=>[e(u,{placeholder:"Тип"})]),_:1}),e(F,null,{default:t(()=>[(a(),d(se,null,ae(r,(D,Y)=>e(A,{key:Y},{default:t(()=>[e(O,{value:D},{default:t(()=>[i(p(D),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])],2)]),l("div",bl,[v.value.name?(a(),I(x,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>w[14]||(w[14]=[i("Название или ссылка",-1)])),_:1,__:[14]})):S("",!0),e(f,{modelValue:v.value.name,"onUpdate:modelValue":w[2]||(w[2]=D=>v.value.name=D),placeholder:"Название или ссылка",class:X(v.value.name?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",xl,[l("div",wl,[e(x,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>w[15]||(w[15]=[i("Метры(неон)",-1)])),_:1,__:[15]}),e(f,{modelValue:v.value.metrs,"onUpdate:modelValue":w[3]||(w[3]=D=>v.value.metrs=D),modelModifiers:{number:!0},placeholder:"Метры(неон)",type:"number",min:"0"},null,8,["modelValue"])]),l("div",hl,[e(x,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>w[16]||(w[16]=[i("Эл-ты(неон)",-1)])),_:1,__:[16]}),e(f,{modelValue:v.value.els,"onUpdate:modelValue":w[4]||(w[4]=D=>v.value.els=D),modelModifiers:{number:!0},placeholder:"Эл-ты(неон)",type:"number",min:"0"},null,8,["modelValue"])]),l("div",kl,[e(x,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>w[17]||(w[17]=[i("Акустика",-1)])),_:1,__:[17]}),e(f,{modelValue:v.value.acoustics,"onUpdate:modelValue":w[5]||(w[5]=D=>v.value.acoustics=D),modelModifiers:{number:!0},placeholder:"Акустика",type:"number",min:"0"},null,8,["modelValue"])])]),l("div",$l,[l("div",Ul,[e(x,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>w[18]||(w[18]=[i("Распаковка стандарт",-1)])),_:1,__:[18]}),e(f,{modelValue:v.value.unpackage,"onUpdate:modelValue":w[6]||(w[6]=D=>v.value.unpackage=D),modelModifiers:{number:!0},placeholder:"Распаковка стандарт",type:"number",min:"0"},null,8,["modelValue"])]),l("div",Vl,[e(x,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>w[19]||(w[19]=[i("Распаковка большая",-1)])),_:1,__:[19]}),e(f,{modelValue:v.value.unpackageBig,"onUpdate:modelValue":w[7]||(w[7]=D=>v.value.unpackageBig=D),modelModifiers:{number:!0},placeholder:"Распаковка большая",type:"number",min:"0"},null,8,["modelValue"])])]),l("div",Cl,[l("div",Sl,[e(x,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>w[20]||(w[20]=[i("Шлифовка",-1)])),_:1,__:[20]}),e(f,{modelValue:v.value.grinding,"onUpdate:modelValue":w[8]||(w[8]=D=>v.value.grinding=D),modelModifiers:{number:!0},placeholder:"Шлифовка",type:"number",min:"0"},null,8,["modelValue"])]),l("div",Ml,[e(x,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>w[21]||(w[21]=[i("Смарт контроллер",-1)])),_:1,__:[21]}),e(f,{modelValue:v.value.smartContr,"onUpdate:modelValue":w[9]||(w[9]=D=>v.value.smartContr=D),modelModifiers:{number:!0},placeholder:"Смарт контроллер",type:"number",min:"0"},null,8,["modelValue"])])]),l("span",null," Стоимость: "+p(v.value.cost)+"р. ",1)]),e(h,{class:"w-full"},{default:t(()=>[l("div",Rl,[e(T,{variant:"destructive",onClick:c},{default:t(()=>w[22]||(w[22]=[i(" Удалить ",-1)])),_:1,__:[22]}),e(T,{disabled:U.value,onClick:y},{default:t(()=>w[23]||(w[23]=[i(" Сохранить ",-1)])),_:1,__:[23]},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Dl={class:"flex flex-col gap-5"},Tl={class:"relative"},Pl={class:"relative"},Ol={class:"relative"},El={class:"relative"},Il={class:"flex justify-between w-full gap-2"},We=ne({__name:"EditOtherReport",props:{report:{}},emits:["report-updated","close"],setup(L,{emit:B}){const{$useApi:z}=ie(),{toast:P}=re(),M=B,k=L,R=m(!0),U=m(!0),r=m({...k.report}),v=async()=>{try{await z.patch(`production/other-report/${r.value.id}`,r.value),R.value=!1,M("report-updated"),P({title:"Успех",description:"Отчет успешно обновлен"})}catch{P({title:"Ошибка",description:"Не удалось обновить отчет",variant:"destructive"})}},_=async()=>{try{await z.delete(`production/other-report/${r.value.id}`),R.value=!1,M("report-updated"),P({title:"Успех",description:"Отчет успешно удален"})}catch{P({title:"Ошибка",description:"Не удалось удалить отчет",variant:"destructive"})}};return ee(r,()=>{const{date:y,name:c,cost:n}=r.value;U.value=!(y&&c&&n)},{deep:!0}),ee(R,y=>{y||M("close")}),(y,c)=>{const n=Se,w=Re,j=Ce,$=Oe,s=Ue,x=Be,f=Ee,u=De,E=Ve,O=Me;return a(),d("div",null,[e(O,{open:R.value,"onUpdate:open":c[4]||(c[4]=A=>R.value=A)},{default:t(()=>[e(E,{class:"max-w-[300px] flex flex-col"},{default:t(()=>[e(j,null,{default:t(()=>[e(n,null,{default:t(()=>c[5]||(c[5]=[i("Редактировать отчет",-1)])),_:1,__:[5]}),e(w)]),_:1}),l("div",Dl,[l("div",Tl,[r.value.date?(a(),I($,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>c[6]||(c[6]=[i("Дата",-1)])),_:1,__:[6]})):S("",!0),e(s,{modelValue:r.value.date,"onUpdate:modelValue":c[0]||(c[0]=A=>r.value.date=A),type:"date",placeholder:"Дата",class:X(r.value.date?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",Pl,[r.value.name?(a(),I($,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>c[7]||(c[7]=[i("Описание",-1)])),_:1,__:[7]})):S("",!0),e(s,{modelValue:r.value.name,"onUpdate:modelValue":c[1]||(c[1]=A=>r.value.name=A),placeholder:"Описание",class:X(r.value.name?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",Ol,[r.value.cost?(a(),I($,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>c[8]||(c[8]=[i("Стоимость",-1)])),_:1,__:[8]})):S("",!0),e(s,{modelValue:r.value.cost,"onUpdate:modelValue":c[2]||(c[2]=A=>r.value.cost=A),type:"number",placeholder:"Стоимость",class:X(r.value.cost?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",El,[e(x,{modelValue:r.value.comment,"onUpdate:modelValue":c[3]||(c[3]=A=>r.value.comment=A),placeholder:"Комментарий"},null,8,["modelValue"]),r.value.comment?(a(),I($,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>c[9]||(c[9]=[i(" Комментарий ",-1)])),_:1,__:[9]})):S("",!0)]),l("span",null," Стоимость: "+p(r.value.cost)+"р. ",1)]),e(u,{class:"w-full"},{default:t(()=>[l("div",Il,[e(f,{variant:"destructive",onClick:_},{default:t(()=>c[10]||(c[10]=[i(" Удалить ",-1)])),_:1,__:[10]}),e(f,{disabled:U.value,onClick:v},{default:t(()=>c[11]||(c[11]=[i(" Сохранить ",-1)])),_:1,__:[11]},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Fl={class:"flex flex-col gap-5"},Nl={class:"relative"},Gl={class:"relative"},Ll={class:"flex justify-between"},zl={class:"relative flex items-center gap-2"},Bl={class:"relative flex items-center gap-4"},Al={class:"flex gap-2"},Wl={class:"relative"},Hl={class:"relative"},jl={class:"relative"},ql={class:"relative"},Yl={class:"relative"},Xl={class:"relative"},Kl={key:0,class:"relative"},Zl={class:"relative"},Ql={class:"flex justify-between w-full gap-2"},tt=ne({__name:"EditPackerReport",props:{report:{},curUser:{}},emits:["report-updated","close"],setup(L,{emit:B}){const{$useApi:z}=ie(),{toast:P}=re(),M=B,k=L,R=m(!0),U=m(!0),r=m({...k.report}),v=()=>{const{items:c,dimmers:n,overSize:w,isGift:j,dops:$,adapters:s,lam:x}=r.value;let f=0;console.log(k.curUser?.workSpaceId),k.curUser?.workSpaceId===8?f=c*100+s*60+x*20+n*60+(w?200:0)+(j?120:0)+$:f=c*100+s*60+x*20+n*60+(w?100:0)+(j?120:0)+$,r.value.cost=f},_=async()=>{try{U.value=!0,await z.patch(`production/packer-report/${r.value.id}`,r.value),R.value=!1,M("report-updated"),U.value=!1,P({title:"Успех",description:"Отчет успешно обновлен"})}catch(c){console.log(c)}},y=async()=>{try{await z.delete(`production/packer-report/${r.value.id}`),R.value=!1,M("report-updated"),P({title:"Успех",description:"Отчет успешно удален"})}catch(c){console.log(c)}};return ee(r,()=>{const{date:c,name:n,items:w}=r.value;v(),U.value=!(c&&n&&w>0)},{deep:!0}),ee(R,c=>{c||M("close")}),(c,n)=>{const w=Se,j=Re,$=Ce,s=Oe,x=Ue,f=wt,u=Be,E=Ee,O=De,A=Ve,F=Me;return a(),d("div",null,[e(F,{open:R.value,"onUpdate:open":n[12]||(n[12]=V=>R.value=V)},{default:t(()=>[e(A,{class:"max-w-[400px] flex flex-col top-0 translate-y-[0px]"},{default:t(()=>[e($,null,{default:t(()=>[e(w,null,{default:t(()=>n[13]||(n[13]=[i("Редактировать запись",-1)])),_:1,__:[13]}),e(j)]),_:1}),l("div",Fl,[l("div",Nl,[r.value.date?(a(),I(s,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[14]||(n[14]=[i("Дата смены",-1)])),_:1,__:[14]})):S("",!0),e(x,{modelValue:r.value.date,"onUpdate:modelValue":n[0]||(n[0]=V=>r.value.date=V),type:"date",min:new Date().toISOString().slice(0,10),placeholder:"Дата смены",class:X(r.value.date?"":"outline-1 outline-rose-300")},null,8,["modelValue","min","class"])]),l("div",Gl,[r.value.name?(a(),I(s,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[15]||(n[15]=[i("Название или ссылка",-1)])),_:1,__:[15]})):S("",!0),e(x,{modelValue:r.value.name,"onUpdate:modelValue":n[1]||(n[1]=V=>r.value.name=V),placeholder:"Название или ссылка",class:X(r.value.name?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",Ll,[l("div",zl,[e(f,{checked:r.value.overSize,"onUpdate:checked":n[2]||(n[2]=V=>r.value.overSize=V)},null,8,["checked"]),e(s,{class:""},{default:t(()=>n[16]||(n[16]=[i("Негабарит",-1)])),_:1,__:[16]})]),n[18]||(n[18]=l("div",null,"|",-1)),l("div",Bl,[e(f,{checked:r.value.isGift,"onUpdate:checked":n[3]||(n[3]=V=>r.value.isGift=V)},null,8,["checked"]),e(s,{class:""},{default:t(()=>n[17]||(n[17]=[i("Подарок",-1)])),_:1,__:[17]})])]),l("div",Al,[l("div",Wl,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[19]||(n[19]=[i("Уп-ка",-1)])),_:1,__:[19]}),e(x,{modelValue:r.value.items,"onUpdate:modelValue":n[4]||(n[4]=V=>r.value.items=V),modelModifiers:{number:!0},placeholder:"Уп-ка",type:"number",min:"0"},null,8,["modelValue"])]),l("div",Hl,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[20]||(n[20]=[i("Блоки",-1)])),_:1,__:[20]}),e(x,{modelValue:r.value.adapters,"onUpdate:modelValue":n[5]||(n[5]=V=>r.value.adapters=V),modelModifiers:{number:!0},placeholder:"Блоки",type:"number",min:"0"},null,8,["modelValue"])]),l("div",jl,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[21]||(n[21]=[i("Пленка",-1)])),_:1,__:[21]}),e(x,{modelValue:r.value.lam,"onUpdate:modelValue":n[6]||(n[6]=V=>r.value.lam=V),modelModifiers:{number:!0},placeholder:"Пленка",type:"number",min:"0"},null,8,["modelValue"])]),l("div",ql,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[22]||(n[22]=[i("Дим",-1)])),_:1,__:[22]}),e(x,{modelValue:r.value.dimmers,"onUpdate:modelValue":n[7]||(n[7]=V=>r.value.dimmers=V),modelModifiers:{number:!0},placeholder:"Дим",type:"number",min:"0"},null,8,["modelValue"])])]),l("div",Yl,[r.value.dopsComment?(a(),I(s,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[23]||(n[23]=[i("Доп работы",-1)])),_:1,__:[23]})):S("",!0),e(x,{modelValue:r.value.dopsComment,"onUpdate:modelValue":n[8]||(n[8]=V=>r.value.dopsComment=V),placeholder:"Доп работы"},null,8,["modelValue"])]),l("div",Xl,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[24]||(n[24]=[i("Стоимость за доп. работы",-1)])),_:1,__:[24]}),e(x,{modelValue:r.value.dops,"onUpdate:modelValue":n[9]||(n[9]=V=>r.value.dops=V),placeholder:"Стоимость за доп. работы",type:"number"},null,8,["modelValue"])]),["PACKER","LOGIST","MASTER"].includes(c.curUser?.role.shortName||"")?S("",!0):(a(),d("div",Kl,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[25]||(n[25]=[i("Штраф",-1)])),_:1,__:[25]}),e(x,{modelValue:r.value.penaltyCost,"onUpdate:modelValue":n[10]||(n[10]=V=>r.value.penaltyCost=V),placeholder:"Штраф",type:"number"},null,8,["modelValue"])])),l("div",Zl,[e(u,{modelValue:r.value.comment,"onUpdate:modelValue":n[11]||(n[11]=V=>r.value.comment=V),placeholder:"Комментарий"},null,8,["modelValue"]),r.value.comment?(a(),I(s,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[26]||(n[26]=[i(" Комментарий ",-1)])),_:1,__:[26]})):S("",!0)]),l("span",null," Стоимость: "+p(r.value.cost)+"р. ",1)]),e(O,{class:"w-full"},{default:t(()=>[l("div",Ql,[e(E,{variant:"destructive",onClick:y},{default:t(()=>n[27]||(n[27]=[i(" Удалить ",-1)])),_:1,__:[27]}),e(E,{disabled:U.value,onClick:_},{default:t(()=>n[28]||(n[28]=[i(" Сохранить ",-1)])),_:1,__:[28]},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Jl={class:"flex gap-4"},es={class:"flex flex-col gap-2"},ts={class:"w-full flex items-center gap-2"},ls={class:"w-[215px]"},ss={key:0,class:"text-center"},as={key:1,class:"text-red-500 text-center"},os={key:2,class:"text-center"},ns={key:3,class:"flex gap-4"},is={class:"w-full py-2.5 pl-4"},us=["href"],rs={key:1},ds={class:"flex items-center gap-2"},cs={key:0,class:"text-xs text-gray-500"},ps={key:1,class:"text-xs text-gray-500 border-t"},ms={key:2,class:"text-gray-600"},_s={key:0,class:"flex text-xs text-gray-600 justify-center items-center flex-col"},vs={class:"flex"},fs={key:0,class:"text-xs text-neutral-500 mt-1 border-t"},gs={key:0,class:"font-semibold text-green-600"},ys={key:1,class:"font-semibold text-red-500"},bs={class:"w-full min-w-[300px]"},xs=ne({__name:"List",props:{range:{}},setup(L){const B=Ie(),{$useApi:z}=ie(),{toast:P}=re(),M=L,k=m(""),R=B.user,U=m([]),r=m([]),v=m(!1),_=m(null),y=m(!1),c=m(null),n=m(!1),w=m(null),j=m(!1),$=m(null),s=m(!1),x=m(null),f=m([]),u=m("all"),E=m(0),O=m({els:0,metrs:0,mastersSalary:0,orders:0,ordersCost:0,mastersReports:0,packersReports:0,packages:0,packagersSalary:0,repairs:0,repairsCost:0,penalties:0,penaltiesCost:0,otherReports:0,otherReportsCost:0,totalCost:0}),A=async()=>{try{if(_.value=null,!M.range)return;if(u.value==="all"){const{data:h}=await z.get("production/orders",{params:M.range});U.value=h.orders,r.value=h.orders,O.value=h.totals}else{const{data:h}=await z.get(`production/${u.value}/orders`,{params:M.range});U.value=h.orders,r.value=h.orders,O.value=h.totals}}catch{_.value="Не удалось загрузить отчеты",P({title:"Ошибка",description:_.value,variant:"destructive"})}finally{v.value=!1}},F=async()=>{try{const{data:h}=await z.get("production/workspaces");f.value=h}catch(h){console.log(h)}finally{v.value=!1}},V=h=>{E.value=h.userId,console.log(h.report_type),h.report_type==="Сборка"?(c.value={...h},y.value=!0):h.report_type==="Другое"?($.value={...h},j.value=!0):h.report_type==="Упаковка"?(x.value={...h},s.value=!0):h.report_type==="Ремонт"&&(w.value={...h},n.value=!0)},T=async()=>{await A(),y.value=!1,c.value=null,n.value=!1,w.value=null,j.value=!1,$.value=null,s.value=!1,tt.value=null};return ee(u,async h=>{await A()},{deep:!0}),ee(()=>M.range,async()=>{await A()}),ee(k,async()=>{if(k.value.length>2)try{const{data:h}=await z.get("/production/reports/search",{params:{name:k.value}});if(U.value=h,r.value=h,!U.value.length)return}catch(h){console.log(h)}else await A()}),_e(async()=>{await A(),await F()}),(h,C)=>{const W=Ue,D=ze,Y=Le,le=Ge,N=we,g=ye,b=ge,G=fe,H=be,oe=xe,K=ve,ce=Pe,Q=_t,ue=vt,J=We,Fe=tt,me=kt,He=$t,je=ht,he=Vt,qe=Ut,Ye=Gt,Xe=st;return a(),d("div",Jl,[l("div",es,[l("div",ts,[l("div",ls,[e(W,{modelValue:k.value,"onUpdate:modelValue":C[0]||(C[0]=q=>k.value=q),placeholder:"Глобальный поиск..."},null,8,["modelValue"])])]),e(le,{modelValue:u.value,"onUpdate:modelValue":C[1]||(C[1]=q=>u.value=q)},{default:t(()=>[e(Y,null,{default:t(()=>[e(D,{value:"all"},{default:t(()=>C[7]||(C[7]=[i(" Все ",-1)])),_:1,__:[7]}),(a(!0),d(se,null,ae(f.value,q=>(a(),I(D,{key:q.id,value:q.id},{default:t(()=>[i(p(q.title),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),v.value?(a(),d("div",ss,"Загрузка...")):_.value?(a(),d("div",as,p(_.value),1)):U.value.length===0?(a(),d("div",os," Нет отчетов для выбранного мастера. ")):(a(),d("div",ns,[e(ce,{class:"h-[calc(100vh-225px)] rounded-sm shrink-0"},{default:t(()=>[e(K,{class:"bg-white text-sm relative"},{default:t(()=>[e(N),e(G,{class:"bg-gray-50 sticky top-0 z-50"},{default:t(()=>[e(b,null,{default:t(()=>[e(g,{class:"text-center font-semibold text-gray-700"},{default:t(()=>C[8]||(C[8]=[i("Дата",-1)])),_:1,__:[8]}),e(g,{class:"text-center font-semibold text-gray-700"},{default:t(()=>C[9]||(C[9]=[i("Работы",-1)])),_:1,__:[9]}),e(g,{class:"text-center font-semibold text-gray-700"},{default:t(()=>C[10]||(C[10]=[i("Исполнитель",-1)])),_:1,__:[10]}),e(g,{class:"text-center font-semibold text-gray-700"},{default:t(()=>C[11]||(C[11]=[i("Стоимость",-1)])),_:1,__:[11]})]),_:1})]),_:1}),(a(!0),d(se,null,ae(U.value,(q,Z)=>(a(),I(oe,{key:Z,class:"border-1 border-b-black"},{default:t(()=>[e(b,{class:"relative bg-slate-300 hover:bg-slate-300 font-semibold"},{default:t(()=>[e(H,{colspan:"3",class:"p-0"},{default:t(()=>[l("div",is,[q.name.startsWith("http")?(a(),d("a",{key:0,href:q.name,target:"_blank",class:"text-blue-600 hover:underline flex items-center",onClick:C[2]||(C[2]=Je(()=>{},["stop"]))},[C[12]||(C[12]=l("span",null," Карточка ",-1)),e(o(Lt),{class:"h-4"})],8,us)):(a(),d("div",rs,[l("span",null,p(q.name),1)]))])]),_:2},1024),e(H,{colspan:"1",class:"text-right text-green-600 pr-4"},{default:t(()=>[i(p(U.value[Z].orders.reduce((te,Ne)=>te+(Ne.cost||0)+(Ne.lightingCost??0),0)-U.value[Z].orders.reduce((te,Ne)=>te+(Ne.penaltyCost||0),0)+"₽"),1)]),_:2},1024)]),_:2},1024),(a(!0),d(se,null,ae(q.orders,(te,Ne)=>(a(),I(b,{key:Ne,class:X({"text-center bg-gray-50 cursor-pointer hover:bg-slate-200":!0,"bg-red-100":te.penaltyCost,"bg-blue-100/50":te.report_type==="Ремонт","bg-yellow-100/50":te.report_type==="Другое"}),onClick:lr=>V(te)},{default:t(()=>[e(H,{class:"text-xs text-gray-600 py-1.5"},{default:t(()=>[l("div",ds,[l("span",null,p(new Date(te.date).toLocaleDateString()),1),te.comment?(a(),I(o(Ae),{key:0})):S("",!0)])]),_:2},1024),e(H,{class:"py-1.5 flex flex-col text-wrap"},{default:t(()=>[l("span",null,p(te.penaltyCost?"Штраф":te.report_type),1),te.type?(a(),d("span",cs,p(te.type),1)):S("",!0),te.lightingType?(a(),d("span",ps," +"+p(te.lightingType),1)):S("",!0),te.dopsComment?(a(),d("span",ms," + "+p(te.dopsComment),1)):S("",!0)]),_:2},1024),e(H,{class:"py-1.5"},{default:t(()=>[l("span",null,p(te.user?.fullName??"Нет имени"),1),te.report_type==="Сборка"&&te.metrs||te.els?(a(),d("div",_s,[l("div",vs,[l("span",null,p(te.metrs)+"м./ ",1),l("span",null,p(te.els)+"эл. ",1)]),te.lightingType&&te.lightingLength&&te.lightingElements?(a(),d("span",fs,p(te.lightingLength)+"м./"+p(te.lightingElements)+"эл. ",1)):S("",!0)])):S("",!0)]),_:2},1024),e(H,{class:"py-1.5 flex flex-col items-center"},{default:t(()=>[te.cost||te.lightingCost?(a(),d("span",gs,"+"+p((te.cost||0)+(te.lightingCost??0))+"р.",1)):S("",!0),te.penaltyCost?(a(),d("span",ys,p(" -"+te.penaltyCost)+"р.",1)):S("",!0)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:2},1024))),128))]),_:1})]),_:1})])),y.value&&c.value&&o(R)?(a(),I(Q,{key:4,report:c.value,"cur-user":o(R),onReportUpdated:T,onClose:C[3]||(C[3]=q=>y.value=!1)},null,8,["report","cur-user"])):S("",!0),n.value&&w.value&&o(R)?(a(),I(ue,{key:5,report:w.value,"cur-user":o(R),onReportUpdated:T,onClose:C[4]||(C[4]=q=>n.value=!1)},null,8,["report","cur-user"])):S("",!0),j.value&&$.value?(a(),I(J,{key:6,report:$.value,onReportUpdated:T,onClose:C[5]||(C[5]=q=>j.value=!1)},null,8,["report"])):S("",!0),s.value&&x.value?(a(),I(Fe,{key:7,report:x.value,"cur-user":o(R),onReportUpdated:T,onClose:C[6]||(C[6]=q=>s.value=!1)},null,8,["report","cur-user"])):S("",!0)]),l("div",bs,[e(Xe,null,{default:t(()=>[e(je,null,{default:t(()=>[e(me,null,{default:t(()=>C[13]||(C[13]=[i("Статистика",-1)])),_:1,__:[13]}),e(He)]),_:1}),e(qe,null,{default:t(()=>[l("div",null,[C[14]||(C[14]=l("span",{class:"text-xl font-semibold text-gray-700"},"Фрезеровка",-1)),C[15]||(C[15]=l("ul",null,null,-1)),e(he),C[16]||(C[16]=l("span",{class:"text-xl font-semibold text-gray-700"},"Сборка",-1)),l("ul",null,[l("li",null,"Элементы: "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(O.value.els)),1),l("li",null,"Метры: "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(+O.value.metrs.toFixed(2)))+"м",1),l("li",null,"Вывески: "+p(O.value.mastersReports),1),l("li",null," Ремонты: "+p(O.value.repairs)+" на сумму "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(O.value.repairsCost)+"₽"),1),l("li",null," Зарплата мастеров: "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(+O.value.mastersSalary.toFixed(2))+"₽"),1)]),e(he),C[17]||(C[17]=l("span",{class:"text-xl font-semibold text-gray-700"},"Упаковка",-1)),l("ul",null,[l("li",null,"Упаковано: "+p(O.value.packages),1),l("li",null," Зарплата упаковщиков: "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(+O.value.packagersSalary.toFixed(2))+"₽"),1)]),e(he),C[18]||(C[18]=l("span",{class:"text-xl font-semibold text-gray-700"},"Остальное",-1)),l("ul",null,[l("li",null," Штрафы: "+p(O.value.penalties)+" на сумму "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(O.value.penaltiesCost)+"₽")+"р. ",1),l("li",null," Ремонты: "+p(O.value.repairs)+" на сумму "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(O.value.repairsCost)+"₽")+"р. ",1),l("li",null," Другое: "+p(O.value.otherReports)+" на сумму "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(O.value.otherReportsCost)+"₽")+"р. ",1)]),e(he),C[19]||(C[19]=l("span",{class:"text-xl font-semibold text-gray-700"},"Итого",-1)),l("ul",null,[l("li",null,"Затраты: "+p(("useMyFormatPrice"in h?h.useMyFormatPrice:o(pe))(O.value.totalCost)+"₽"),1)])])]),_:1}),e(Ye)]),_:1})])])}}}),ws={class:"flex flex-col gap-2 h-[calc(100vh-180px)] overflow-hidden min-h-0"},hs={class:"flex flex-wrap gap-2 items-center"},ks={key:0,class:"grow"},$s={class:"grow min-w-[200px]"},Us={class:"grow"},Vs={class:"min-w-[320px] grow rounded-lg p-2 border border-slate-200 bg-white text-slate-950 shadow-sm dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50"},Cs={class:"flex justify-between"},Ss={class:"grow"},Ms={key:0,class:"text-center"},Rs={key:1,class:"text-red-500 text-center"},Ds={key:2,class:"text-center"},Ts={key:3,class:"text-center"},Ps={key:4,class:"flex-1 min-h-0"},Os={class:"flex items-center gap-2"},Es={class:"flex flex-col items-center"},Is=["href"],Fs={key:1,class:"flex text-wrap flex-col items-center"},Ns={class:"text-wrap text-gray-600"},Gs={key:2,class:"text-xs text-gray-500 border-t"},Ls={key:0},zs={key:1},Bs={key:2,class:"flex flex-col items-center"},As={class:"flex"},Ws={key:0,class:"text-xs text-neutral-500 mt-1 border-t"},Hs={class:"flex flex-col items-center"},js={class:"font-semibold text-green-600"},qs={key:0,class:"font-semibold text-red-500"},Ys=ne({__name:"Masters",props:{range:{}},setup(L){const B=Ie(),{$useApi:z}=ie(),{toast:P}=re(),M=L,k=m(M.range.from),R=m(M.range.from.slice(0,7)),U=B.user,r=m([]),v=m(null),_=m([]),y=m([]),c=m(!1),n=m(null),w=m(!1),j=m(!1),$=m(null),s=m(null),x=m(!1),f=m(null),u=m(),E=m(0),O=m(0),A=m("all"),F=()=>{E.value=_.value.reduce((g,b)=>g+(b.cost||0)+(b.lightingCost??0)-(b.penaltyCost||0),0),O.value=_.value.reduce((g,b)=>g+(b.isOther?0:b.els),0)+_.value.reduce((g,b)=>g+(b.lightingElements||0),0)},V=async()=>{try{c.value=!0,n.value=null;const{data:g}=await z.get("production/masters");r.value=g,g.length>0?v.value=g[0]:(v.value=null,P({title:"Ошибка",description:"Список мастеров пуст",variant:"destructive"}))}catch{n.value="Не удалось загрузить список мастеров",P({title:"Ошибка",description:n.value,variant:"destructive"})}finally{c.value=!1}},T=async()=>{if(v.value&&M.range)try{c.value=!0,n.value=null;const{data:g}=await z.get(`production/master/${v.value.id}/reports`,{params:M.range});_.value=g,y.value=g,N(A.value),F()}catch{n.value="Не удалось загрузить отчеты",P({title:"Ошибка",description:n.value,variant:"destructive"})}finally{c.value=!1}},h=g=>{g.isRepair?(s.value={...g},j.value=!0):g.isOther?(f.value={...g},x.value=!0):($.value={...g},w.value=!0)},C=async()=>{await T(),w.value=!1,j.value=!1,x.value=!1,$.value=null,s.value=null,f.value=null},W=async()=>{if(v.value)try{const{data:g}=await z.get(`production/master/${v.value.id}/shifts`,{params:{period:R.value}});u.value=g.map(b=>b.shift_date)}catch{P({title:"Ошибка",description:"Не удалось загрузить смены",variant:"destructive"})}},D=g=>"Рабочих дней: "+g.length,Y=async()=>{if(v.value)try{const g=u.value?u.value.map(b=>new Date(b).toISOString().slice(0,10)):[];await z.post(`production/master/${v.value.id}/shifts`,{shiftDates:g,period:M.range.from.slice(0,7)}),P({title:"Успех",description:"Смены сохранены"})}catch(g){console.log(g),P({title:"Ошибка",description:"Не удалось сохранить смены",variant:"destructive"})}},le=g=>{const b=new Date(g);return`${b.getDate().toString().padStart(2,"0")}.${(b.getMonth()+1).toString().padStart(2,"0")}.${b.getFullYear()}`},N=g=>{if(g==="repairs"){_.value=y.value.filter(b=>b.isRepair===!0),F();return}if(g==="works"){_.value=y.value.filter(b=>b.isRepair!==!0&&b.isOther!==!0),F();return}if(g==="other"){_.value=y.value.filter(b=>b.isOther===!0),F();return}_.value=y.value};return ee(A,g=>{N(g),F()},{deep:!0}),ee(()=>M.range,async()=>{k.value=M.range.from,R.value=M.range.from.slice(0,7),await T(),await W()}),_e(async()=>{await V()}),ee(v,()=>{v.value&&(T(),W())}),(g,b)=>{const G=at,H=ze,oe=Le,K=Ge,ce=Ct,Q=we,ue=ye,J=ge,Fe=fe,me=be,He=xe,je=ve,he=Pe,qe=_t,Ye=vt,Xe=We;return a(),d("div",ws,[l("div",hs,[r.value.length>1?(a(),d("div",ks,[e(G,{items:r.value.map(q=>({value:q.id,label:q.fullName})),label:v.value?.fullName||"Выберите мастера",onSelectedItem:b[0]||(b[0]=q=>{v.value=r.value.find(Z=>Z.id===q)||null})},null,8,["items","label"])])):S("",!0),l("div",$s,[e(o(Te),{modelValue:u.value,"onUpdate:modelValue":[b[1]||(b[1]=q=>u.value=q),Y],"multi-dates":"","enable-time-picker":!1,locale:"ru",placeholder:"Выбрать смены","select-text":"Готово","cancel-text":"Закрыть","start-date":k.value,format:D,class:"grow","hide-offset-dates":"",clearable:!1},null,8,["modelValue","start-date"])]),l("div",Us,[e(K,{modelValue:A.value,"onUpdate:modelValue":b[2]||(b[2]=q=>A.value=q),class:"w-full"},{default:t(()=>[e(oe,{class:"w-full"},{default:t(()=>[e(H,{value:"all",class:"grow"},{default:t(()=>b[7]||(b[7]=[i(" Все ",-1)])),_:1,__:[7]}),e(H,{value:"works",class:"grow"},{default:t(()=>b[8]||(b[8]=[i(" Вывески ",-1)])),_:1,__:[8]}),e(H,{value:"repairs",class:"grow"},{default:t(()=>b[9]||(b[9]=[i(" Ремонты ",-1)])),_:1,__:[9]}),e(H,{value:"other",class:"grow"},{default:t(()=>b[10]||(b[10]=[i(" Другое ",-1)])),_:1,__:[10]})]),_:1})]),_:1},8,["modelValue"])]),l("div",Vs,[l("div",Cs,[l("span",null," Эл-ты: "+p(O.value),1),l("span",null," Сумма: "+p(E.value)+"р. ",1)])]),l("div",Ss,[o(U)?(a(),I(ce,{key:0,"master-id":v.value?.id??0,"cur-user":o(U),class:"w-full",onReportCreated:T},null,8,["master-id","cur-user"])):S("",!0)])]),c.value?(a(),d("div",Ms,"Загрузка...")):n.value?(a(),d("div",Rs,p(n.value),1)):v.value?_.value.length===0?(a(),d("div",Ts," Нет отчетов для выбранного мастера. ")):(a(),d("div",Ps,[e(he,{class:"h-full overflow-y-auto rounded-sm"},{default:t(()=>[e(je,{class:"bg-white rounded-sm relative"},{default:t(()=>[e(Q),e(Fe,{class:"sticky top-0 z-50 bg-gray-50"},{default:t(()=>[e(J,null,{default:t(()=>[e(ue,null,{default:t(()=>b[11]||(b[11]=[i("Дата",-1)])),_:1,__:[11]}),e(ue,{class:"text-center"},{default:t(()=>b[12]||(b[12]=[i("Название",-1)])),_:1,__:[12]}),e(ue,{class:"text-center"},{default:t(()=>b[13]||(b[13]=[i("Инфо",-1)])),_:1,__:[13]}),e(ue,{class:"text-center"},{default:t(()=>b[14]||(b[14]=[i("Стоимость",-1)])),_:1,__:[14]})]),_:1})]),_:1}),e(He,null,{default:t(()=>[(a(!0),d(se,null,ae(_.value,q=>(a(),I(J,{key:q.key,class:X({"cursor-pointer hover:bg-gray-100":!0,"bg-blue-100/50":q.isRepair,"bg-yellow-100/50":q.isOther,"bg-red-100":q.penaltyCost>0}),onClick:Z=>h(q)},{default:t(()=>[e(me,null,{default:t(()=>[l("div",Os,[l("span",null,p(le(q.date).slice(0,5)),1),q.comment?(a(),I(o(Ae),{key:0})):S("",!0)])]),_:2},1024),e(me,{class:"text-center"},{default:t(()=>[l("div",Es,[q.name.startsWith("http")?(a(),d("a",{key:0,href:q.name,target:"_blank",class:"text-blue-500 hover:underline",onClick:b[3]||(b[3]=Je(()=>{},["stop"]))},"Карточка",8,Is)):(a(),d("div",Fs,[l("span",null,p(q.name),1)])),l("span",Ns,"("+p(q.type)+")",1),q.lightingType?(a(),d("span",Gs," +"+p(q.lightingType),1)):S("",!0)])]),_:2},1024),e(me,{class:"text-center"},{default:t(()=>[q.isRepair?(a(),d("span",Ls," Ремонт ")):q.isOther?(a(),d("span",zs," Другое ")):(a(),d("div",Bs,[l("div",As,[l("span",null,p(q.metrs)+"м. ",1),b[15]||(b[15]=l("span",null,"/",-1)),l("span",null,p(q.els)+"эл. ",1)]),q.lightingType&&q.lightingLength&&q.lightingElements?(a(),d("span",Ws,p(q.lightingLength)+"м./"+p(q.lightingElements)+"эл. ",1)):S("",!0)]))]),_:2},1024),e(me,{class:"text-center"},{default:t(()=>[l("div",Hs,[l("span",js,"+"+p((q.cost||0)+(q.lightingCost??0))+"р.",1),q.penaltyCost?(a(),d("span",qs,p(" -"+q.penaltyCost)+"р.",1)):S("",!0)])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1})])):(a(),d("div",Ds," Выберите мастера для отображения отчетов. ")),w.value&&$.value&&o(U)?(a(),I(qe,{key:5,report:$.value,"cur-user":o(U),onReportUpdated:C,onClose:b[4]||(b[4]=q=>w.value=!1)},null,8,["report","cur-user"])):S("",!0),j.value&&s.value&&o(U)?(a(),I(Ye,{key:6,report:s.value,"cur-user":o(U),onReportUpdated:C,onClose:b[5]||(b[5]=q=>j.value=!1)},null,8,["report","cur-user"])):S("",!0),x.value&&f.value?(a(),I(Xe,{key:7,report:f.value,onReportUpdated:C,onClose:b[6]||(b[6]=q=>x.value=!1)},null,8,["report"])):S("",!0)])}}}),Xs={class:"flex gap-3 w-full"},Ks={class:"w-[500px] h-[calc(100vh-130px)] overflow-hidden rounded-md shrink-0"},Zs={class:"font-bold flex justify-between"},Qs={class:"mb-3"},Js={class:"flex items-center ml-auto"},ea={class:"whitespace-nowrap"},ta={class:"text-xs"},la={class:"min-w-[1050px] overflow-hidden"},sa={class:"flex gap-2 items-center mb-2"},aa={class:"mt-[-42px]"},oa=ne({__name:"Page",props:{range:{}},setup(L){const{$useApi:B}=ie();mt({title:"Закупки | Easy CRM"});const z=L,P=m(!1),M=m("0₽"),k=m([]),R=m([]),U=m([]),r=m({uniquePositions:[],uniqueCategories:[],uniqueSuppliers:[]}),v={date:new Date().toISOString().slice(0,10),shipmentDate:"",supplier:"",paymentMethod:"Счет",orderStatus:"Оформлен заказ",paymentStatus:"Не оплачен",deliveryMethod:"Доставка от поставщика",invoice:"",track:"",positions:[{name:"",quantity:1,priceForItem:1,category:""}]},_=m(v),y=async()=>{try{const{data:$}=await B.get("supplies/suppliers");k.value=$.map(x=>x.name)||[];const{data:s}=await B.get("supplies/positions");R.value=s||[]}catch($){console.log($)}},c=async()=>{try{if(!z.range)return;const{data:$}=await B.get("supplies",{params:z.range});U.value=$.supplies||[],r.value=$.filters||[],M.value=w(U.value.filter(s=>!!s.id).map(s=>s.id))}catch($){console.log($)}},n=m([]),w=$=>{const x=U.value.filter(u=>$.includes(u.id)).reduce((u,E)=>u+E.positions.reduce((O,A)=>O+A.quantity*A.priceForItem,0),0),f=r.value.uniqueCategories.map(u=>{const E=U.value.flatMap(F=>F.positions).filter(F=>F.category===u),O=Object.values(E.reduce((F,{name:V,priceForItem:T,quantity:h})=>(F[V]||(F[V]={name:V,quantity:0,price:0}),F[V].quantity+=h,F[V].price+=T*h,F),{})),A=O.reduce((F,V)=>F+V.price,0);return{title:u,totalPrice:A,items:O.sort((F,V)=>V.price-F.price)}});return n.value=f.sort((u,E)=>E.totalPrice-u.totalPrice),pe(+x.toFixed(2))+"₽"},j=$=>{P.value=!0,_.value=U.value.find(s=>s.id===$)||v,console.log(_.value)};return ee(()=>z.range,async()=>{await c()}),_e(async()=>{await y(),await c()}),($,s)=>{const x=$t,f=kt,u=ht,E=Vt,O=Ut,A=Pe,F=st,V=Wt,T=Ht,h=pt,C=Se,W=Re,D=Ce,Y=qt,le=De,N=Ve,g=Me;return a(),d("div",null,[l("div",Xs,[l("div",Ks,[e(F,null,{default:t(()=>[e(u,{class:"p-3 pb-2 text-right"},{default:t(()=>[e(x,null,{default:t(()=>s[5]||(s[5]=[i("Общая сумма",-1)])),_:1,__:[5]}),e(f,{class:"text-3xl font-semibold whitespace-nowrap"},{default:t(()=>[i(p(o(M)),1)]),_:1})]),_:1}),e(A,{class:"h-[calc(100vh-180px)]"},{default:t(()=>[e(O,{class:"pt-2"},{default:t(()=>[e(E),(a(!0),d(se,null,ae(o(n),b=>(a(),d("div",{key:b.title},[l("div",Zs,[l("span",null,p(b.title),1),l("span",null,p(("useMyFormatPrice"in $?$.useMyFormatPrice:o(pe))(+b.totalPrice.toFixed(2)))+"₽ ",1)]),l("ul",Qs,[(a(!0),d(se,null,ae(b.items,(G,H)=>(a(),d("li",{key:H,class:"flex items-center"},[l("span",null,p(G.name),1),l("div",Js,[l("span",ea,p(("useMyFormatPrice"in $?$.useMyFormatPrice:o(pe))(+G.price.toFixed(2)))+"₽",1),l("span",ta,"("+p(G.quantity)+"ед.)",1)])]))),128)),e(E)])]))),128))]),_:1})]),_:1})]),_:1})]),l("div",la,[l("div",sa,[e(V,{suppliers:o(k),"positions-list":o(R),onSupplieCreated:s[0]||(s[0]=async()=>{await c(),await y()})},null,8,["suppliers","positions-list"])]),l("div",aa,[(a(),I(T,{key:o(U).length,data:o(U),columns:o(jt),filters:o(r),onTableSorted:s[1]||(s[1]=b=>M.value=w(b)),onItemClicked:s[2]||(s[2]=b=>j(b))},null,8,["data","columns","filters"]))])])]),e(g,{open:o(P),"onUpdate:open":s[4]||(s[4]=b=>$e(P)?P.value=b:null)},{default:t(()=>[e(h),e(N,{class:"max-w-[1200px] flex flex-col"},{default:t(()=>[e(D,null,{default:t(()=>[e(C,null,{default:t(()=>s[6]||(s[6]=[i("Редактировать статью",-1)])),_:1,__:[6]}),e(W)]),_:1}),(a(),I(Y,{key:o(_).id,suppliers:o(k),supplie:o(_),"positions-list":o(R),onSupplieUpdated:s[3]||(s[3]=async()=>{P.value=!1,_.value=v,await c()})},null,8,["suppliers","supplie","positions-list"])),e(le)]),_:1})]),_:1},8,["open"])])}}}),na={class:"flex flex-col gap-2"},ia={class:"flex flex-col gap-2"},ua={class:"flex items-center"},ra={class:"w-full"},da={class:"flex items-center"},ca={class:"w-full"},pa={class:"flex flex-col gap-2"},ma={class:"flex gap-2 items-center"},_a={class:"w-full rounded-lg p-2 border border-slate-200 bg-white text-slate-950 shadow-sm dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50"},va={class:"flex justify-between"},fa={key:0,class:"text-center"},ga={key:1,class:"text-red-500 text-center"},ya={key:2,class:"text-center"},ba={key:3,class:"text-center"},xa={key:4},wa={class:"flex items-center gap-2"},ha={class:"flex flex-col items-center"},ka=["href"],$a={key:1,class:"flex text-wrap flex-col items-center"},Ua={class:"text-wrap text-gray-600"},Va={key:2,class:"text-xs text-gray-500 border-t"},Ca={key:0},Sa={key:1},Ma={key:2,class:"flex flex-col items-center"},Ra={class:"flex"},Da={key:0,class:"text-xs text-neutral-500 mt-1 border-t"},Ta={class:"flex flex-col items-center"},Pa={class:"font-semibold text-green-600"},Oa={key:0,class:"font-semibold text-red-500"},Ea=ne({__name:"MastersReportsTable",props:{period:{},currentMaster:{}},emits:["updated"],setup(L,{emit:B}){const z=Ie(),{$useApi:P}=ie(),{toast:M}=re(),k=L,R=z.user,U=m(new Date(k.period+"-01")),r=m(new Date(+k.period.split("-")[0],+k.period.split("-")[1],0)),v=m([]),_=m([]),y=m(!1),c=m(null),n=m(!1),w=m(!1),j=m(null),$=m(null),s=m(!1),x=m(null),f=m(),u=m([new Date(k.period).toISOString().slice(0,10),new Date(+k.period.split("-")[0],+k.period.split("-")[1],1).toISOString().slice(0,10)]),E=m(0),O=m(0),A=m("all"),F=()=>{E.value=v.value.reduce((b,G)=>b+(G.cost||0)+(G.lightingCost??0)-(G.penaltyCost||0),0),O.value=v.value.reduce((b,G)=>b+(G.isOther?0:G.els),0)+v.value.reduce((b,G)=>b+(G.lightingElements||0),0)},V=async()=>{if(k.currentMaster)try{y.value=!0,c.value=null;const b=new Date(u.value[0]).toISOString().slice(0,10),G=new Date(u.value[1]).toISOString().slice(0,10),{data:H}=await P.get(`production/master/${k.currentMaster.id}/reports`,{params:{from:b,to:G}});v.value=H,_.value=H,g(A.value),F()}catch{c.value="Не удалось загрузить отчеты",M({title:"Ошибка",description:c.value,variant:"destructive"})}finally{y.value=!1}},T=b=>{b.isRepair?($.value={...b},w.value=!0):b.isOther?(x.value={...b},s.value=!0):(j.value={...b},n.value=!0)},h=async()=>{await V(),n.value=!1,w.value=!1,s.value=!1,j.value=null,$.value=null,x.value=null},C=async()=>{if(k.currentMaster)try{const{data:b}=await P.get(`production/master/${k.currentMaster.id}/shifts`,{params:{period:k.period}});f.value=b.map(G=>G.shift_date)}catch{M({title:"Ошибка",description:"Не удалось загрузить смены",variant:"destructive"})}},W=b=>"Рабочих дней: "+b.length,D=b=>"Период с "+b.map(G=>{const H=new Date(G).toISOString().slice(0,10).split("-"),oe=H[2],K=H[1],ce=H[0];return`${oe}.${K}.${ce}`}).join(" по "),Y=B,le=async()=>{if(k.currentMaster)try{const b=f.value?f.value.map(G=>new Date(G).toISOString().slice(0,10)):[];await P.post(`production/master/${k.currentMaster.id}/shifts`,{shiftDates:b,period:k.period}),Y("updated"),M({title:"Успех",description:"Смены сохранены"})}catch(b){console.log(b),M({title:"Ошибка",description:"Не удалось сохранить смены",variant:"destructive"})}},N=b=>{const G=new Date(b);return`${G.getDate().toString().padStart(2,"0")}.${(G.getMonth()+1).toString().padStart(2,"0")}.${G.getFullYear()}`};ee(u,()=>{V()},{deep:!0});const g=b=>{if(b==="repairs"){v.value=_.value.filter(G=>G.isRepair===!0),F();return}if(b==="works"){v.value=_.value.filter(G=>G.isRepair!==!0&&G.isOther!==!0),F();return}if(b==="other"){v.value=_.value.filter(G=>G.isOther===!0),F();return}v.value=_.value};return ee(A,b=>{g(b),F()},{deep:!0}),_e(async()=>{await V(),await C()}),(b,G)=>{const H=ze,oe=Le,K=Ge,ce=Ct,Q=we,ue=ye,J=ge,Fe=fe,me=be,He=xe,je=ve,he=xt,qe=Pe,Ye=_t,Xe=vt,q=We;return a(),d("div",na,[l("div",ia,[l("div",ua,[l("div",ra,[e(o(Te),{modelValue:u.value,"onUpdate:modelValue":G[0]||(G[0]=Z=>u.value=Z),range:"","enable-time-picker":!1,"min-date":U.value,"max-date":r.value,"auto-apply":"",locale:"ru",placeholder:"Выбрать дни","select-text":"Готово","cancel-text":"Закрыть",class:"grow",format:D,clearable:!1},null,8,["modelValue","min-date","max-date"])])]),l("div",da,[l("div",ca,[e(o(Te),{modelValue:f.value,"onUpdate:modelValue":[G[1]||(G[1]=Z=>f.value=Z),le],"multi-dates":"","enable-time-picker":!1,locale:"ru","min-date":U.value,"max-date":r.value,"start-date":U.value,placeholder:"Выбрать смены","select-text":"Готово","cancel-text":"Закрыть",format:W,class:"grow",clearable:!1},null,8,["modelValue","min-date","max-date","start-date"])])]),l("div",pa,[l("div",ma,[e(K,{modelValue:A.value,"onUpdate:modelValue":G[2]||(G[2]=Z=>A.value=Z)},{default:t(()=>[e(oe,null,{default:t(()=>[e(H,{value:"all"},{default:t(()=>G[7]||(G[7]=[i(" Все ",-1)])),_:1,__:[7]}),e(H,{value:"works"},{default:t(()=>G[8]||(G[8]=[i(" Вывески ",-1)])),_:1,__:[8]}),e(H,{value:"repairs"},{default:t(()=>G[9]||(G[9]=[i(" Ремонты ",-1)])),_:1,__:[9]}),e(H,{value:"other"},{default:t(()=>G[10]||(G[10]=[i(" Другое ",-1)])),_:1,__:[10]})]),_:1})]),_:1},8,["modelValue"]),o(R)?(a(),I(ce,{key:0,"master-id":b.currentMaster?.id??0,"cur-user":o(R),class:"w-full",onReportCreated:h},null,8,["master-id","cur-user"])):S("",!0)]),l("div",_a,[l("div",va,[l("span",null," Эл-ты: "+p(O.value),1),l("span",null," Сумма: "+p(E.value)+"р. ",1)])])])]),y.value?(a(),d("div",fa,"Загрузка...")):c.value?(a(),d("div",ga,p(c.value),1)):k.currentMaster?v.value.length===0?(a(),d("div",ba," Нет отчетов для выбранного мастера. ")):(a(),d("div",xa,[e(qe,{class:"h-[calc(100vh-270px)]"},{default:t(()=>[e(je,{class:"bg-white rounded-sm"},{default:t(()=>[e(Q,null,{default:t(()=>[i("Отчеты мастера: "+p(k.currentMaster?.fullName),1)]),_:1}),e(Fe,null,{default:t(()=>[e(J,null,{default:t(()=>[e(ue,null,{default:t(()=>G[11]||(G[11]=[i("Дата",-1)])),_:1,__:[11]}),e(ue,{class:"text-center"},{default:t(()=>G[12]||(G[12]=[i("Название",-1)])),_:1,__:[12]}),e(ue,{class:"text-center"},{default:t(()=>G[13]||(G[13]=[i("Инфо",-1)])),_:1,__:[13]}),e(ue,{class:"text-center"},{default:t(()=>G[14]||(G[14]=[i("Стоимость",-1)])),_:1,__:[14]})]),_:1})]),_:1}),e(He,null,{default:t(()=>[(a(!0),d(se,null,ae(v.value,Z=>(a(),I(J,{key:Z.key,class:X({"cursor-pointer hover:bg-gray-100":!0,"bg-blue-100/50":Z.isRepair,"bg-yellow-100/50":Z.isOther,"bg-red-100":Z.penaltyCost>0}),onClick:te=>T(Z)},{default:t(()=>[e(me,null,{default:t(()=>[l("div",wa,[l("span",null,p(N(Z.date).slice(0,5)),1),Z.comment?(a(),I(o(Ae),{key:0})):S("",!0)])]),_:2},1024),e(me,{class:"text-center"},{default:t(()=>[l("div",ha,[Z.name.startsWith("http")?(a(),d("a",{key:0,href:Z.name,target:"_blank",class:"text-blue-500 hover:underline",onClick:G[3]||(G[3]=Je(()=>{},["stop"]))},"Карточка",8,ka)):(a(),d("div",$a,[l("span",null,p(Z.name),1)])),l("span",Ua,"("+p(Z.type)+")",1),Z.lightingType?(a(),d("span",Va," +"+p(Z.lightingType),1)):S("",!0)])]),_:2},1024),e(me,{class:"text-center"},{default:t(()=>[Z.isRepair?(a(),d("span",Ca," Ремонт ")):Z.isOther?(a(),d("span",Sa," Другое ")):(a(),d("div",Ma,[l("div",Ra,[l("span",null,p(Z.metrs)+"м. ",1),G[15]||(G[15]=l("span",null,"/",-1)),l("span",null,p(Z.els)+"эл. ",1)]),Z.lightingType&&Z.lightingLength&&Z.lightingElements?(a(),d("span",Da,p(Z.lightingLength)+"м./"+p(Z.lightingElements)+"эл. ",1)):S("",!0)]))]),_:2},1024),e(me,{class:"text-center"},{default:t(()=>[l("div",Ta,[l("span",Pa,"+"+p((Z.cost||0)+(Z.lightingCost??0))+"р.",1),Z.penaltyCost?(a(),d("span",Oa,p(" -"+Z.penaltyCost)+"р.",1)):S("",!0)])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),e(he,{orientation:"horizontal"})]),_:1})])):(a(),d("div",ya," Выберите мастера для отображения отчетов. ")),n.value&&j.value?(a(),I(Ye,{key:5,class:"z-[10000]",report:j.value,"cur-user":o(R),onReportUpdated:h,onClose:G[4]||(G[4]=Z=>n.value=!1)},null,8,["report","cur-user"])):S("",!0),w.value&&$.value?(a(),I(Xe,{key:6,class:"z-[10000]",report:$.value,onReportUpdated:h,onClose:G[5]||(G[5]=Z=>w.value=!1)},null,8,["report"])):S("",!0),s.value&&x.value?(a(),I(q,{key:7,class:"z-[10000]",report:x.value,onReportUpdated:h,onClose:G[6]||(G[6]=Z=>s.value=!1)},null,8,["report"])):S("",!0)])}}});function Qe(L,B){if(L.one!==void 0&&B===1)return L.one;const z=B%10,P=B%100;return z===1&&P!==11?L.singularNominative.replace("{{count}}",String(B)):z>=2&&z<=4&&(P<10||P>20)?L.singularGenitive.replace("{{count}}",String(B)):L.pluralGenitive.replace("{{count}}",String(B))}function de(L){return(B,z)=>z?.addSuffix?z.comparison&&z.comparison>0?L.future?Qe(L.future,B):"через "+Qe(L.regular,B):L.past?Qe(L.past,B):Qe(L.regular,B)+" назад":Qe(L.regular,B)}const Ia={lessThanXSeconds:de({regular:{one:"меньше секунды",singularNominative:"меньше {{count}} секунды",singularGenitive:"меньше {{count}} секунд",pluralGenitive:"меньше {{count}} секунд"},future:{one:"меньше, чем через секунду",singularNominative:"меньше, чем через {{count}} секунду",singularGenitive:"меньше, чем через {{count}} секунды",pluralGenitive:"меньше, чем через {{count}} секунд"}}),xSeconds:de({regular:{singularNominative:"{{count}} секунда",singularGenitive:"{{count}} секунды",pluralGenitive:"{{count}} секунд"},past:{singularNominative:"{{count}} секунду назад",singularGenitive:"{{count}} секунды назад",pluralGenitive:"{{count}} секунд назад"},future:{singularNominative:"через {{count}} секунду",singularGenitive:"через {{count}} секунды",pluralGenitive:"через {{count}} секунд"}}),halfAMinute:(L,B)=>B?.addSuffix?B.comparison&&B.comparison>0?"через полминуты":"полминуты назад":"полминуты",lessThanXMinutes:de({regular:{one:"меньше минуты",singularNominative:"меньше {{count}} минуты",singularGenitive:"меньше {{count}} минут",pluralGenitive:"меньше {{count}} минут"},future:{one:"меньше, чем через минуту",singularNominative:"меньше, чем через {{count}} минуту",singularGenitive:"меньше, чем через {{count}} минуты",pluralGenitive:"меньше, чем через {{count}} минут"}}),xMinutes:de({regular:{singularNominative:"{{count}} минута",singularGenitive:"{{count}} минуты",pluralGenitive:"{{count}} минут"},past:{singularNominative:"{{count}} минуту назад",singularGenitive:"{{count}} минуты назад",pluralGenitive:"{{count}} минут назад"},future:{singularNominative:"через {{count}} минуту",singularGenitive:"через {{count}} минуты",pluralGenitive:"через {{count}} минут"}}),aboutXHours:de({regular:{singularNominative:"около {{count}} часа",singularGenitive:"около {{count}} часов",pluralGenitive:"около {{count}} часов"},future:{singularNominative:"приблизительно через {{count}} час",singularGenitive:"приблизительно через {{count}} часа",pluralGenitive:"приблизительно через {{count}} часов"}}),xHours:de({regular:{singularNominative:"{{count}} час",singularGenitive:"{{count}} часа",pluralGenitive:"{{count}} часов"}}),xDays:de({regular:{singularNominative:"{{count}} день",singularGenitive:"{{count}} дня",pluralGenitive:"{{count}} дней"}}),aboutXWeeks:de({regular:{singularNominative:"около {{count}} недели",singularGenitive:"около {{count}} недель",pluralGenitive:"около {{count}} недель"},future:{singularNominative:"приблизительно через {{count}} неделю",singularGenitive:"приблизительно через {{count}} недели",pluralGenitive:"приблизительно через {{count}} недель"}}),xWeeks:de({regular:{singularNominative:"{{count}} неделя",singularGenitive:"{{count}} недели",pluralGenitive:"{{count}} недель"}}),aboutXMonths:de({regular:{singularNominative:"около {{count}} месяца",singularGenitive:"около {{count}} месяцев",pluralGenitive:"около {{count}} месяцев"},future:{singularNominative:"приблизительно через {{count}} месяц",singularGenitive:"приблизительно через {{count}} месяца",pluralGenitive:"приблизительно через {{count}} месяцев"}}),xMonths:de({regular:{singularNominative:"{{count}} месяц",singularGenitive:"{{count}} месяца",pluralGenitive:"{{count}} месяцев"}}),aboutXYears:de({regular:{singularNominative:"около {{count}} года",singularGenitive:"около {{count}} лет",pluralGenitive:"около {{count}} лет"},future:{singularNominative:"приблизительно через {{count}} год",singularGenitive:"приблизительно через {{count}} года",pluralGenitive:"приблизительно через {{count}} лет"}}),xYears:de({regular:{singularNominative:"{{count}} год",singularGenitive:"{{count}} года",pluralGenitive:"{{count}} лет"}}),overXYears:de({regular:{singularNominative:"больше {{count}} года",singularGenitive:"больше {{count}} лет",pluralGenitive:"больше {{count}} лет"},future:{singularNominative:"больше, чем через {{count}} год",singularGenitive:"больше, чем через {{count}} года",pluralGenitive:"больше, чем через {{count}} лет"}}),almostXYears:de({regular:{singularNominative:"почти {{count}} год",singularGenitive:"почти {{count}} года",pluralGenitive:"почти {{count}} лет"},future:{singularNominative:"почти через {{count}} год",singularGenitive:"почти через {{count}} года",pluralGenitive:"почти через {{count}} лет"}})},Fa=(L,B,z)=>Ia[L](B,z),Na={full:"EEEE, d MMMM y 'г.'",long:"d MMMM y 'г.'",medium:"d MMM y 'г.'",short:"dd.MM.y"},Ga={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},La={any:"{{date}}, {{time}}"},za={date:ot({formats:Na,defaultWidth:"full"}),time:ot({formats:Ga,defaultWidth:"full"}),dateTime:ot({formats:La,defaultWidth:"any"})},ft=["воскресенье","понедельник","вторник","среду","четверг","пятницу","субботу"];function Ba(L){const B=ft[L];switch(L){case 0:return"'в прошлое "+B+" в' p";case 1:case 2:case 4:return"'в прошлый "+B+" в' p";case 3:case 5:case 6:return"'в прошлую "+B+" в' p"}}function bt(L){const B=ft[L];return L===2?"'во "+B+" в' p":"'в "+B+" в' p"}function Aa(L){const B=ft[L];switch(L){case 0:return"'в следующее "+B+" в' p";case 1:case 2:case 4:return"'в следующий "+B+" в' p";case 3:case 5:case 6:return"'в следующую "+B+" в' p"}}const Wa={lastWeek:(L,B,z)=>{const P=L.getDay();return yt(L,B,z)?bt(P):Ba(P)},yesterday:"'вчера в' p",today:"'сегодня в' p",tomorrow:"'завтра в' p",nextWeek:(L,B,z)=>{const P=L.getDay();return yt(L,B,z)?bt(P):Aa(P)},other:"P"},Ha=(L,B,z,P)=>{const M=Wa[L];return typeof M=="function"?M(B,z,P):M},ja={narrow:["до н.э.","н.э."],abbreviated:["до н. э.","н. э."],wide:["до нашей эры","нашей эры"]},qa={narrow:["1","2","3","4"],abbreviated:["1-й кв.","2-й кв.","3-й кв.","4-й кв."],wide:["1-й квартал","2-й квартал","3-й квартал","4-й квартал"]},Ya={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],wide:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"]},Xa={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],wide:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]},Ka={narrow:["В","П","В","С","Ч","П","С"],short:["вс","пн","вт","ср","чт","пт","сб"],abbreviated:["вск","пнд","втр","срд","чтв","птн","суб"],wide:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"]},Za={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утро",afternoon:"день",evening:"вечер",night:"ночь"}},Qa={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утра",afternoon:"дня",evening:"вечера",night:"ночи"}},Ja=(L,B)=>{const z=Number(L),P=B?.unit;let M;return P==="date"?M="-е":P==="week"||P==="minute"||P==="second"?M="-я":M="-й",z+M},eo={ordinalNumber:Ja,era:Ke({values:ja,defaultWidth:"wide"}),quarter:Ke({values:qa,defaultWidth:"wide",argumentCallback:L=>L-1}),month:Ke({values:Ya,defaultWidth:"wide",formattingValues:Xa,defaultFormattingWidth:"wide"}),day:Ke({values:Ka,defaultWidth:"wide"}),dayPeriod:Ke({values:Za,defaultWidth:"any",formattingValues:Qa,defaultFormattingWidth:"wide"})},to=/^(\d+)(-?(е|я|й|ое|ье|ая|ья|ый|ой|ий|ый))?/i,lo=/\d+/i,so={narrow:/^((до )?н\.?\s?э\.?)/i,abbreviated:/^((до )?н\.?\s?э\.?)/i,wide:/^(до нашей эры|нашей эры|наша эра)/i},ao={any:[/^д/i,/^н/i]},oo={narrow:/^[1234]/i,abbreviated:/^[1234](-?[ыои]?й?)? кв.?/i,wide:/^[1234](-?[ыои]?й?)? квартал/i},no={any:[/1/i,/2/i,/3/i,/4/i]},io={narrow:/^[яфмаисонд]/i,abbreviated:/^(янв|фев|март?|апр|ма[йя]|июн[ья]?|июл[ья]?|авг|сент?|окт|нояб?|дек)\.?/i,wide:/^(январ[ья]|феврал[ья]|марта?|апрел[ья]|ма[йя]|июн[ья]|июл[ья]|августа?|сентябр[ья]|октябр[ья]|октябр[ья]|ноябр[ья]|декабр[ья])/i},uo={narrow:[/^я/i,/^ф/i,/^м/i,/^а/i,/^м/i,/^и/i,/^и/i,/^а/i,/^с/i,/^о/i,/^н/i,/^я/i],any:[/^я/i,/^ф/i,/^мар/i,/^ап/i,/^ма[йя]/i,/^июн/i,/^июл/i,/^ав/i,/^с/i,/^о/i,/^н/i,/^д/i]},ro={narrow:/^[впсч]/i,short:/^(вс|во|пн|по|вт|ср|чт|че|пт|пя|сб|су)\.?/i,abbreviated:/^(вск|вос|пнд|пон|втр|вто|срд|сре|чтв|чет|птн|пят|суб).?/i,wide:/^(воскресень[ея]|понедельника?|вторника?|сред[аы]|четверга?|пятниц[аы]|суббот[аы])/i},co={narrow:[/^в/i,/^п/i,/^в/i,/^с/i,/^ч/i,/^п/i,/^с/i],any:[/^в[ос]/i,/^п[он]/i,/^в/i,/^ср/i,/^ч/i,/^п[ят]/i,/^с[уб]/i]},po={narrow:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,abbreviated:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,wide:/^([дп]п|полночь|полдень|утр[оа]|день|дня|вечера?|ноч[ьи])/i},mo={any:{am:/^дп/i,pm:/^пп/i,midnight:/^полн/i,noon:/^полд/i,morning:/^у/i,afternoon:/^д[ен]/i,evening:/^в/i,night:/^н/i}},_o={ordinalNumber:At({matchPattern:to,parsePattern:lo,valueCallback:L=>parseInt(L,10)}),era:Ze({matchPatterns:so,defaultMatchWidth:"wide",parsePatterns:ao,defaultParseWidth:"any"}),quarter:Ze({matchPatterns:oo,defaultMatchWidth:"wide",parsePatterns:no,defaultParseWidth:"any",valueCallback:L=>L+1}),month:Ze({matchPatterns:io,defaultMatchWidth:"wide",parsePatterns:uo,defaultParseWidth:"any"}),day:Ze({matchPatterns:ro,defaultMatchWidth:"wide",parsePatterns:co,defaultParseWidth:"any"}),dayPeriod:Ze({matchPatterns:po,defaultMatchWidth:"wide",parsePatterns:mo,defaultParseWidth:"any"})},lt={code:"ru",formatDistance:Fa,formatLong:za,formatRelative:Ha,localize:eo,match:_o,options:{weekStartsOn:1,firstWeekContainsDate:1}},vo={class:"flex flex-col gap-2"},fo={class:"px-2"},go={class:"text-xl font-semibold py-2"},yo={key:0,class:"text-center"},bo={key:1,class:"text-red-500 text-center"},xo={key:2,class:"text-center"},wo={key:3},ho={class:"flex flex-col sm:flex-row gap-4"},ko={class:"flex-1"},$o={class:"text-lg font-bold text-green-600"},Uo={class:"flex-1"},Vo={class:"text-lg font-bold text-blue-600"},Co={class:"flex-1"},So={class:"text-lg font-bold text-blue-600"},Mo={class:"overflow-x-auto"},Ro={class:"flex flex-col"},Do=ne({__name:"Stat",props:{range:{}},setup(L){const{$useApi:B}=ie(),{toast:z}=re(),P=L,M=m(P.range.from.slice(0,7)),k=m(!1),R=m(null),U=m(null),r=m(!1),v=async()=>{try{k.value=!0,R.value=null;const{data:s}=await B.get("production/stat",{params:{period:M.value}});U.value=s}catch{R.value="Не удалось загрузить статистику",z({title:"Ошибка",description:R.value,variant:"destructive"})}finally{k.value=!1}},_=m(),y=async s=>{_.value=s,r.value=!0},c=s=>{const x=new Date(s),f=et(x,"dd",{locale:lt}),u=et(x,"EEEEEE",{locale:lt});return`${f} (${u})`},n=s=>{const f=new Date(s).getDay();return f===0||f===6},w=ke(()=>U.value?Object.values(U.value.shiftsSumByDate).reduce((s,x)=>s+x,0):0),j=ke(()=>U.value?Object.values(U.value.regularElsSumByDate).reduce((s,x)=>s+x,0):0),$=ke(()=>U.value?Object.values(U.value.specialElsSumByDate).reduce((s,x)=>s+x,0):0);return ee(()=>P.range,async()=>{M.value=P.range.from.slice(0,7),await v()}),_e(async()=>{await v()}),(s,x)=>{const f=Mt,u=Tt,E=Pt,O=Dt,A=Ea,F=Rt,V=St,T=st,h=we,C=ye,W=ge,D=fe,Y=be,le=xe,N=ve;return a(),d("div",vo,[e(V,{open:r.value,"onUpdate:open":x[0]||(x[0]=g=>r.value=g)},{default:t(()=>[e(f,{class:"hidden"}),e(F,{class:"p-0 min-w-[500px]"},{default:t(()=>[e(O,{class:"hidden"},{default:t(()=>[e(u),e(E)]),_:1}),l("div",fo,[l("div",go,p(_.value?.fullName),1),_.value?(a(),I(A,{key:_.value.id,period:M.value,"current-master":_.value,onUpdated:v},null,8,["period","current-master"])):S("",!0)])]),_:1})]),_:1},8,["open"]),k.value?(a(),d("div",yo,"Загрузка...")):R.value?(a(),d("div",bo,p(R.value),1)):!U.value||U.value.masters.length===0?(a(),d("div",xo," Нет данных за выбранный период ")):(a(),d("div",wo,[e(T,{class:"mb-4 p-4 bg-white rounded-sm shadow-sm"},{default:t(()=>[l("div",ho,[l("div",ko,[x[1]||(x[1]=l("h3",{class:"text-sm font-semibold text-gray-700"}," Общее количество смен ",-1)),l("p",$o,p(w.value),1)]),l("div",Uo,[x[2]||(x[2]=l("h3",{class:"text-sm font-semibold text-gray-700"}," Общее количество обычных элементов ",-1)),l("p",Vo,p(j.value),1)]),l("div",Co,[x[3]||(x[3]=l("h3",{class:"text-sm font-semibold text-gray-700"}," Общее количество специальных элементов ",-1)),l("p",So,p($.value),1)])])]),_:1}),l("div",Mo,[e(N,{class:"bg-white rounded-sm text-xs w-full"},{default:t(()=>[e(h,null,{default:t(()=>[i("Статистика мастеров за "+p(M.value),1)]),_:1}),e(D,null,{default:t(()=>[e(W,null,{default:t(()=>[e(C,{class:"p-2 sticky left-0 bg-gray-300 font-bold border border-black/50"},{default:t(()=>x[4]||(x[4]=[i("Мастер (Рейтинг)",-1)])),_:1,__:[4]}),(a(!0),d(se,null,ae(U.value.dates,g=>(a(),I(C,{key:g,class:"p-1 text-center bg-gray-300 border border-black/50"},{default:t(()=>[l("div",Ro,[l("span",null,p(c(g).split(" ")[0]),1),l("span",null,p(c(g).split(" ")[1]),1)])]),_:2},1024))),128))]),_:1})]),_:1}),e(le,null,{default:t(()=>[e(W,null,{default:t(()=>[e(Y,{class:"p-2 sticky left-0 bg-gray-300 font-semibold border border-black/50"},{default:t(()=>x[5]||(x[5]=[i("Смены",-1)])),_:1,__:[5]}),(a(!0),d(se,null,ae(U.value.dates,g=>(a(),I(Y,{key:g,class:"p-1 text-center bg-green-500/50 border border-black/50"},{default:t(()=>[i(p(U.value.shiftsSumByDate[g]||0),1)]),_:2},1024))),128))]),_:1}),e(W,null,{default:t(()=>[e(Y,{class:"p-2 sticky left-0 bg-gray-300 font-semibold border border-black/50"},{default:t(()=>x[6]||(x[6]=[i("Элементы",-1)])),_:1,__:[6]}),(a(!0),d(se,null,ae(U.value.dates,g=>(a(),I(Y,{key:g,class:"p-1 text-center bg-gray-300/50 border border-black/50"},{default:t(()=>[i(p(U.value.regularElsSumByDate[g]||0)+" / "+p(U.value.specialElsSumByDate[g]||0),1)]),_:2},1024))),128))]),_:1}),(a(!0),d(se,null,ae(U.value.masters,g=>(a(),I(W,{key:g.masterId,class:"cursor-pointer",onClick:b=>y({id:g.masterId,fullName:g.fullName})},{default:t(()=>[e(Y,{class:"p-2 sticky left-0 bg-gray-300 border border-black/50"},{default:t(()=>[i(p(g.fullName)+" ("+p(g.rating)+") ",1)]),_:2},1024),(a(!0),d(se,null,ae(U.value.dates,b=>(a(),I(Y,{key:b,class:X(["p-1 text-center border border-black/50",{"bg-blue-100/50":n(b),"bg-green-500/50":g.shiftsByDate[b],"font-bold":g.elsByDate[b].regular||g.elsByDate[b].special}])},{default:t(()=>[i(p(g.elsByDate[b].regular||0)+" / "+p(g.elsByDate[b].special||0),1)]),_:2},1032,["class"]))),128))]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})])]))])}}}),To={class:""},Po={class:"flex flex-col gap-5"},Oo={class:"relative"},Eo={class:"relative"},Io={class:"flex justify-between"},Fo={class:"relative flex items-center gap-2"},No={class:"relative flex items-center gap-4"},Go={class:"flex gap-2"},Lo={class:"relative"},zo={class:"relative"},Bo={class:"relative"},Ao={class:"relative"},Wo={class:"relative"},Ho={class:"relative"},jo={class:"flex flex-col gap-2"},qo={key:0,class:"relative"},Yo={class:"relative"},Xo={class:"flex justify-between w-full"},Ko={class:"flex flex-col gap-5"},Zo={class:"relative"},Qo={class:"relative"},Jo={class:"relative"},en={class:"relative"},tn={class:"flex justify-between w-full"},Et=ne({__name:"CreatePackerReport",props:{packerId:{},curUser:{}},emits:["report-created"],setup(L,{emit:B}){const{$useApi:z}=ie(),{toast:P}=re(),M=B,k=L,R=m(!1),U=m(!0),r=m("new"),v={date:new Date().toISOString().slice(0,10),name:"",overSize:!1,isGift:!1,items:1,adapters:1,lam:1,cost:0,dimmers:0,userId:k.packerId,dops:0,dopsComment:"",comment:"",penaltyCost:0},_=m({...v}),y={date:new Date().toISOString().slice(0,10),name:"",cost:0,userId:k.packerId},c=m({...y}),n=()=>{const{items:$,dimmers:s,overSize:x,isGift:f,dops:u,adapters:E,lam:O}=_.value;let A=0;console.log(k.curUser?.workSpaceId),k.curUser?.workSpaceId===8?A=$*100+E*60+O*20+s*60+(x?200:0)+(f?120:0)+u:A=$*100+E*60+O*20+s*60+(x?100:0)+(f?120:0)+u,_.value.cost=A},w=async()=>{try{await z.post("production/packer-report",{..._.value,userId:k.packerId}),R.value=!1,M("report-created"),P({title:"Успех",description:"Отчет успешно создан"})}catch{P({title:"Ошибка",description:"Не удалось создать отчет",variant:"destructive"})}},j=async()=>{try{await z.post("production/other-report",{...c.value,userId:k.packerId}),R.value=!1,M("report-created"),P({title:"Успех",description:"Отчет успешно создан"})}catch{P({title:"Ошибка",description:"Не удалось создать отчет",variant:"destructive"})}};return ee(c,()=>{const{date:$,name:s,cost:x}=c.value;U.value=!($&&s&&x)},{deep:!0}),ee(_,()=>{const{date:$,name:s,items:x,adapters:f,lam:u,dimmers:E}=_.value;n(),k.curUser?.role.shortName==="PACKER"||k.curUser?.role.shortName==="MASTER"||k.curUser?.role.shortName==="LOGIST"?U.value=!($&&s&&(x||f||u||E)):U.value=!($&&s)},{deep:!0}),ee(R,$=>{$||(_.value={...v,userId:k.packerId},c.value={...y,userId:k.packerId})}),ee(r,()=>{_.value={...v,userId:k.packerId},c.value={...y,userId:k.packerId},U.value=!0}),($,s)=>{const x=Ee,f=pt,u=Se,E=Re,O=Ce,A=ze,F=Le,V=Oe,T=Ue,h=wt,C=Be,W=Ot,D=Ge,Y=De,le=Ve,N=Me;return a(),d("div",null,[e(N,{open:R.value,"onUpdate:open":s[17]||(s[17]=g=>R.value=g)},{default:t(()=>[e(f,{"as-child":""},{default:t(()=>[e(x,{class:"w-full"},{default:t(()=>s[18]||(s[18]=[i("Создать",-1)])),_:1,__:[18]})]),_:1}),e(le,{class:"max-w-[400px] flex flex-col top-0 translate-y-[0px]"},{default:t(()=>[e(O,null,{default:t(()=>[e(u,null,{default:t(()=>s[19]||(s[19]=[i("Создать запись",-1)])),_:1,__:[19]}),e(E)]),_:1}),l("div",To,[e(D,{modelValue:r.value,"onUpdate:modelValue":s[16]||(s[16]=g=>r.value=g)},{default:t(()=>[e(F,{class:"w-full mb-4"},{default:t(()=>[e(A,{class:"w-full",value:"new"},{default:t(()=>s[20]||(s[20]=[i(" Новое ",-1)])),_:1,__:[20]}),e(A,{class:"w-full",value:"other"},{default:t(()=>s[21]||(s[21]=[i(" Другое ",-1)])),_:1,__:[21]})]),_:1}),e(W,{value:"new"},{default:t(()=>[l("div",Po,[l("div",Oo,[_.value.date?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[22]||(s[22]=[i("Дата смены",-1)])),_:1,__:[22]})):S("",!0),e(T,{modelValue:_.value.date,"onUpdate:modelValue":s[0]||(s[0]=g=>_.value.date=g),type:"date",min:new Date().toISOString().slice(0,10),placeholder:"Дата смены",class:X(_.value.date?"":"outline-1 outline-rose-300")},null,8,["modelValue","min","class"])]),l("div",Eo,[_.value.name?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[23]||(s[23]=[i("Название или ссылка",-1)])),_:1,__:[23]})):S("",!0),e(T,{modelValue:_.value.name,"onUpdate:modelValue":s[1]||(s[1]=g=>_.value.name=g),placeholder:"Название или ссылка",class:X(_.value.name?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",Io,[l("div",Fo,[e(h,{checked:_.value.overSize,"onUpdate:checked":s[2]||(s[2]=g=>_.value.overSize=g)},null,8,["checked"]),e(V,{class:""},{default:t(()=>s[24]||(s[24]=[i("Негабарит",-1)])),_:1,__:[24]})]),s[26]||(s[26]=l("div",null,"|",-1)),l("div",No,[e(h,{checked:_.value.isGift,"onUpdate:checked":s[3]||(s[3]=g=>_.value.isGift=g)},null,8,["checked"]),e(V,{class:""},{default:t(()=>s[25]||(s[25]=[i("Подарок",-1)])),_:1,__:[25]})])]),l("div",Go,[l("div",Lo,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[27]||(s[27]=[i("Уп-ка",-1)])),_:1,__:[27]}),e(T,{modelValue:_.value.items,"onUpdate:modelValue":s[4]||(s[4]=g=>_.value.items=g),modelModifiers:{number:!0},placeholder:"Уп-ка",type:"number",min:"0"},null,8,["modelValue"])]),l("div",zo,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[28]||(s[28]=[i("Блоки",-1)])),_:1,__:[28]}),e(T,{modelValue:_.value.adapters,"onUpdate:modelValue":s[5]||(s[5]=g=>_.value.adapters=g),modelModifiers:{number:!0},placeholder:"Блоки",type:"number",min:"0"},null,8,["modelValue"])]),l("div",Bo,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[29]||(s[29]=[i("Пленка",-1)])),_:1,__:[29]}),e(T,{modelValue:_.value.lam,"onUpdate:modelValue":s[6]||(s[6]=g=>_.value.lam=g),modelModifiers:{number:!0},placeholder:"Пленка",type:"number",min:"0"},null,8,["modelValue"])]),l("div",Ao,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[30]||(s[30]=[i("Дим",-1)])),_:1,__:[30]}),e(T,{modelValue:_.value.dimmers,"onUpdate:modelValue":s[7]||(s[7]=g=>_.value.dimmers=g),modelModifiers:{number:!0},placeholder:"Дим",type:"number",min:"0"},null,8,["modelValue"])])]),l("div",Wo,[_.value.dopsComment?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[31]||(s[31]=[i("Доп работы",-1)])),_:1,__:[31]})):S("",!0),e(T,{modelValue:_.value.dopsComment,"onUpdate:modelValue":s[8]||(s[8]=g=>_.value.dopsComment=g),placeholder:"Доп работы"},null,8,["modelValue"])]),l("div",Ho,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[32]||(s[32]=[i("Стоимость",-1)])),_:1,__:[32]}),e(T,{modelValue:_.value.dops,"onUpdate:modelValue":s[9]||(s[9]=g=>_.value.dops=g),placeholder:"Стоимость",type:"number"},null,8,["modelValue"])]),l("div",jo,[["PACKER","LOGIST","MASTER"].includes($.curUser?.role.shortName||"")?S("",!0):(a(),d("div",qo,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[33]||(s[33]=[i("Штраф",-1)])),_:1,__:[33]}),e(T,{modelValue:_.value.penaltyCost,"onUpdate:modelValue":s[10]||(s[10]=g=>_.value.penaltyCost=g),placeholder:"Штраф",type:"number"},null,8,["modelValue"])])),l("div",Yo,[e(C,{modelValue:_.value.comment,"onUpdate:modelValue":s[11]||(s[11]=g=>_.value.comment=g),placeholder:"Комментарий"},null,8,["modelValue"]),_.value.comment?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[34]||(s[34]=[i(" Комментарий ",-1)])),_:1,__:[34]})):S("",!0)])]),l("span",null," Стоимость: "+p(_.value.cost)+"р. ",1)]),l("div",Xo,[e(x,{disabled:U.value,onClick:w},{default:t(()=>s[35]||(s[35]=[i(" Создать ",-1)])),_:1,__:[35]},8,["disabled"])])]),_:1}),e(W,{value:"other"},{default:t(()=>[l("div",Ko,[l("div",Zo,[c.value.date?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[36]||(s[36]=[i("Дата",-1)])),_:1,__:[36]})):S("",!0),e(T,{modelValue:c.value.date,"onUpdate:modelValue":s[12]||(s[12]=g=>c.value.date=g),type:"date",min:new Date().toISOString().slice(0,10),placeholder:"Дата",class:X(c.value.date?"":"outline-1 outline-rose-300")},null,8,["modelValue","min","class"])]),l("div",Qo,[c.value.name?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[37]||(s[37]=[i("Описание",-1)])),_:1,__:[37]})):S("",!0),e(T,{modelValue:c.value.name,"onUpdate:modelValue":s[13]||(s[13]=g=>c.value.name=g),placeholder:"Описание",class:X(c.value.name?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",Jo,[c.value.cost?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[38]||(s[38]=[i("Стоимость",-1)])),_:1,__:[38]})):S("",!0),e(T,{modelValue:c.value.cost,"onUpdate:modelValue":s[14]||(s[14]=g=>c.value.cost=g),type:"number",placeholder:"Стоимость",class:X(c.value.cost?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",en,[e(C,{modelValue:c.value.comment,"onUpdate:modelValue":s[15]||(s[15]=g=>c.value.comment=g),placeholder:"Комментарий"},null,8,["modelValue"]),c.value.comment?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[39]||(s[39]=[i(" Комментарий ",-1)])),_:1,__:[39]})):S("",!0)]),l("span",null," Стоимость: "+p(c.value.cost)+"р. ",1)]),l("div",tn,[e(x,{disabled:U.value,onClick:j},{default:t(()=>s[40]||(s[40]=[i(" Создать ",-1)])),_:1,__:[40]},8,["disabled"])])]),_:1})]),_:1},8,["modelValue"])]),e(Y)]),_:1})]),_:1},8,["open"])])}}}),ln={class:"flex flex-col gap-2"},sn={class:"flex flex-col gap-2"},an={key:0,class:"flex gap-2"},on={class:"flex items-center gap-2"},nn={class:"min-w-[200px]"},un={class:"w-full rounded-lg p-2 border border-slate-200 bg-white text-slate-950 shadow-sm dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50"},rn={class:"flex justify-end"},dn={key:0,class:"text-center"},cn={key:1,class:"text-red-500 text-center"},pn={key:2,class:"text-center"},mn={key:3,class:"text-center"},_n={key:4},vn={class:"flex items-center gap-2"},fn={class:"flex flex-col items-center"},gn=["href"],yn={key:1,class:"flex flex-col text-wrap text-gray-600"},bn={key:2,class:"text-wrap text-gray-600"},xn={class:"flex flex-col gap-1"},wn={key:0},hn={key:1},kn={key:2},$n={key:3},Un={key:4},Vn={class:"flex flex-col"},Cn={class:"font-semibold text-green-600"},Sn={key:0,class:"font-semibold text-red-500"},Mn=ne({__name:"Packers",props:{range:{}},setup(L){const B=Ie(),{$useApi:z}=ie(),{toast:P}=re(),M=L,k=B.user,R=m(M.range.from.slice(0,7)),U=m(M.range.from),r=m([]),v=m(null),_=m([]),y=m(!1),c=m(null),n=m(!1),w=m(null),j=m(),$=m(!1),s=m(null),x=m(0),f=async()=>{try{y.value=!0,c.value=null;const{data:h}=await z.get("production/packers");r.value=h,h.length>0?v.value=h[0]:(v.value=null,P({title:"Ошибка",description:"Список упаковщиков пуст",variant:"destructive"}))}catch{c.value="Не удалось загрузить список упаковщиков",P({title:"Ошибка",description:c.value,variant:"destructive"})}finally{y.value=!1}},u=async()=>{if(v.value&&M.range)try{y.value=!0,c.value=null;const{data:h}=await z.get(`production/packer/${v.value.id}/reports`,{params:M.range});_.value=h,x.value=h.reduce((C,W)=>C+W.cost-W.penaltyCost,0)}catch{c.value="Не удалось загрузить отчеты",P({title:"Ошибка",description:c.value,variant:"destructive"})}finally{y.value=!1}},E=h=>{h.isOther?(s.value={...h},$.value=!0):(w.value={...h},n.value=!0)},O=async()=>{await u(),n.value=!1,w.value=null},A=async()=>{if(v.value)try{const{data:h}=await z.get(`production/packer/${v.value.id}/shifts`,{params:{period:R.value}});j.value=h.map(C=>C.shift_date)}catch{P({title:"Ошибка",description:"Не удалось загрузить смены",variant:"destructive"})}},F=h=>"Рабочих дней: "+h.length,V=async()=>{if(v.value)try{const h=j.value?j.value.map(C=>new Date(C).toISOString().slice(0,10)):[];await z.post(`production/packer/${v.value.id}/shifts`,{shiftDates:h,period:R.value}),P({title:"Успех",description:"Смены сохранены"})}catch(h){console.log(h),P({title:"Ошибка",description:"Не удалось сохранить смены",variant:"destructive"})}},T=h=>{const C=new Date(h);return`${C.getDate().toString().padStart(2,"0")}.${(C.getMonth()+1).toString().padStart(2,"0")}.${C.getFullYear()}`};return _e(async()=>{await f()}),ee(v,()=>{v.value&&(u(),A())}),ee(()=>M.range,async()=>{U.value=M.range.from,R.value=M.range.from.slice(0,7),await u(),await A()}),(h,C)=>{const W=at,D=we,Y=ye,le=ge,N=fe,g=be,b=xe,G=ve,H=Pe,oe=Et,K=tt,ce=We;return a(),d("div",ln,[l("div",sn,[r.value.length>1||!["PACKER","LOGIST","MASTER"].includes(o(k)?.role.shortName||"")?(a(),d("div",an,[e(W,{items:r.value.map(Q=>({value:Q.id,label:Q.fullName})),class:"w-[180px]",label:v.value?.fullName||"Выберите упаковщика",onSelectedItem:C[0]||(C[0]=Q=>{v.value=r.value.find(ue=>ue.id===Q)||null})},null,8,["items","label"])])):S("",!0),l("div",on,[l("div",nn,[e(o(Te),{modelValue:j.value,"onUpdate:modelValue":[C[1]||(C[1]=Q=>j.value=Q),V],"multi-dates":"","enable-time-picker":!1,locale:"ru","start-date":U.value,placeholder:"Выбрать смены","select-text":"Готово","cancel-text":"Закрыть","hide-offset-dates":"",format:F,class:"grow",clearable:!1},null,8,["modelValue","start-date"])]),l("div",un,[l("div",rn,[l("span",null," Сумма: "+p(x.value)+"р. ",1)])])])]),y.value?(a(),d("div",dn,"Загрузка...")):c.value?(a(),d("div",cn,p(c.value),1)):v.value?_.value.length===0?(a(),d("div",mn," Нет отчетов для выбранного упаковщика ")):(a(),d("div",_n,[e(H,{class:"h-[calc(100vh-300px)] rounded-sm"},{default:t(()=>[e(G,{class:"bg-white rounded-sm relative"},{default:t(()=>[e(D),e(N,{class:"bg-gray-50 sticky top-0 z-50"},{default:t(()=>[e(le,null,{default:t(()=>[e(Y,null,{default:t(()=>C[5]||(C[5]=[i("Дата",-1)])),_:1,__:[5]}),e(Y,{class:"text-center"},{default:t(()=>C[6]||(C[6]=[i("Название",-1)])),_:1,__:[6]}),e(Y,{class:"text-center"},{default:t(()=>C[7]||(C[7]=[i("Инфо",-1)])),_:1,__:[7]}),e(Y,{class:"text-center"},{default:t(()=>C[8]||(C[8]=[i("Стоимость",-1)])),_:1,__:[8]})]),_:1})]),_:1}),e(b,null,{default:t(()=>[(a(!0),d(se,null,ae(_.value,Q=>(a(),I(le,{key:Q.id,class:X({"cursor-pointer hover:bg-gray-100":!0,"bg-yellow-100/50":Q.isOther,"bg-red-100":Q.penaltyCost>0}),onClick:ue=>E(Q)},{default:t(()=>[e(g,null,{default:t(()=>[l("div",vn,[l("span",null,p(T(Q.date).slice(0,5)),1),Q.comment?(a(),I(o(Ae),{key:0})):S("",!0)])]),_:2},1024),e(g,{class:"text-center"},{default:t(()=>[l("div",fn,[Q.name.startsWith("http")?(a(),d("a",{key:0,href:Q.name,target:"_blank",class:"text-blue-500 hover:underline",onClick:C[2]||(C[2]=Je(()=>{},["stop"]))},"Карточка",8,gn)):(a(),d("div",yn,[l("span",null,p(Q.name),1)])),Q.dopsComment?(a(),d("span",bn," + "+p(Q.dopsComment),1)):S("",!0)])]),_:2},1024),Q.isOther?(a(),I(g,{key:0,class:"text-center"},{default:t(()=>C[9]||(C[9]=[i(" Другое ",-1)])),_:1,__:[9]})):(a(),I(g,{key:1,class:"text-center"},{default:t(()=>[l("div",xn,[Q.items?(a(),d("span",wn,p(Q.items)+" выв.",1)):S("",!0),Q.dimmers?(a(),d("span",hn,p(Q.dimmers)+" дим.",1)):S("",!0),Q.adapters?(a(),d("span",kn,p(Q.adapters)+" блок",1)):S("",!0),Q.lam?(a(),d("span",$n,p(Q.lam)+" пленка",1)):S("",!0),Q.overSize?(a(),d("span",Un,"Не габарит")):S("",!0)])]),_:2},1024)),e(g,{class:"text-center"},{default:t(()=>[l("div",Vn,[l("span",Cn,"+"+p(Q.cost)+"р.",1),Q.penaltyCost?(a(),d("span",Sn,p(" -"+Q.penaltyCost)+"р.",1)):S("",!0)])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1})])):(a(),d("div",pn," Выберите упаковщика для отображения отчетов ")),e(oe,{"packer-id":v.value?.id??0,"cur-user":o(k),class:"w-full mb-4 fixed bottom-0 left-0 px-4",onReportCreated:u},null,8,["packer-id","cur-user"]),n.value&&w.value?(a(),I(K,{key:5,report:w.value,"cur-user":o(k),onReportUpdated:O,onClose:C[3]||(C[3]=Q=>n.value=!1)},null,8,["report","cur-user"])):S("",!0),$.value&&s.value?(a(),I(ce,{key:6,report:s.value,onReportUpdated:O,onClose:C[4]||(C[4]=Q=>$.value=!1)},null,8,["report"])):S("",!0)])}}}),Rn={class:"flex flex-col gap-2"},Dn={class:"flex flex-col gap-2"},Tn={class:"flex gap-2"},Pn={class:"flex items-center"},On={class:"w-full"},En={class:"rounded-lg p-2 border border-slate-200 bg-white text-slate-950 shadow-sm dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50"},In={class:"flex justify-end"},Fn={key:0,class:"text-center"},Nn={key:1,class:"text-red-500 text-center"},Gn={key:2,class:"text-center"},Ln={key:3},zn={class:"flex items-center gap-2"},Bn={class:"flex flex-col"},An={class:"font-semibold text-green-600"},Wn=ne({__name:"Logist",props:{range:{}},setup(L){const B=Ie(),{$useApi:z}=ie(),{toast:P}=re(),M=L,k=m(M.range.from.slice(0,7)),R=m(M.range.from),U=B.user,r=m([]),v=m(null),_=m(!1),y=m(null),c=m(),n=m([]),w=m(0),j=async()=>{try{_.value=!0,y.value=null;const{data:f}=await z.get("production/logists");r.value=f,f.length>0?v.value=f[0]:(v.value=null,P({title:"Ошибка",description:"Список логистов пуст",variant:"destructive"}))}catch{y.value="Не удалось загрузить список логистов",P({title:"Ошибка",description:y.value,variant:"destructive"})}finally{_.value=!1}},$=async()=>{if(v.value&&M.range)try{const{data:f}=await z.get(`production/logist/${v.value.id}/shifts`,{params:M.range});c.value=f.map(u=>u.shift_date),n.value=f||[],w.value=n.value.reduce((u,E)=>u+E.cost,0)}catch{P({title:"Ошибка",description:"Не удалось загрузить смены",variant:"destructive"})}},s=f=>"Рабочих дней: "+f.length,x=async()=>{if(v.value)try{const f=c.value?c.value.map(u=>new Date(u).toISOString().slice(0,10)):[];await z.post(`production/logists/${v.value.id}/shifts`,{shiftDates:f,period:k.value}),$(),P({title:"Успех",description:"Смены сохранены"})}catch(f){console.log(f),P({title:"Ошибка",description:"Не удалось сохранить смены",variant:"destructive"})}};return _e(async()=>{await j()}),ee(v,()=>{v.value&&$()}),ee(()=>M.range,async()=>{R.value=M.range.from,k.value=M.range.from.slice(0,7),await $()}),(f,u)=>{const E=at,O=we,A=ye,F=ge,V=fe,T=be,h=xe,C=ve;return a(),d("div",Rn,[l("div",Dn,[l("div",Tn,[r.value.length>1||o(U)?.role.shortName!=="PACKER"?(a(),I(E,{key:0,items:r.value.map(W=>({value:W.id,label:W.fullName})),class:"w-[180px]",label:v.value?.fullName||"Выберите упаковщика",onSelectedItem:u[0]||(u[0]=W=>{v.value=r.value.find(D=>D.id===W)||null})},null,8,["items","label"])):S("",!0)]),l("div",Pn,[l("div",On,[e(o(Te),{modelValue:c.value,"onUpdate:modelValue":[u[1]||(u[1]=W=>c.value=W),x],"multi-dates":"","enable-time-picker":!1,locale:"ru","start-date":R.value,"hide-offset-dates":"",placeholder:"Выбрать смены","select-text":"Готово","cancel-text":"Закрыть",format:s,class:"grow",clearable:!1},null,8,["modelValue","start-date"])])])]),l("div",En,[l("div",In,[l("span",null," Сумма: "+p(w.value)+"р. ",1)])]),_.value?(a(),d("div",Fn,"Загрузка...")):y.value?(a(),d("div",Nn,p(y.value),1)):v.value?(a(),d("div",Ln,[e(C,{class:"bg-white rounded-sm"},{default:t(()=>[e(O,null,{default:t(()=>[i("Отчеты логиста: "+p(v.value?.fullName),1)]),_:1}),e(V,null,{default:t(()=>[e(F,null,{default:t(()=>[e(A,null,{default:t(()=>u[2]||(u[2]=[i("Дата",-1)])),_:1,__:[2]}),e(A,{class:"text-center"},{default:t(()=>u[3]||(u[3]=[i("Стоимость",-1)])),_:1,__:[3]})]),_:1})]),_:1}),e(h,null,{default:t(()=>[(a(!0),d(se,null,ae(n.value,W=>(a(),I(F,{key:W.id,class:X({"cursor-pointer hover:bg-gray-100":!0})},{default:t(()=>[e(T,null,{default:t(()=>[l("div",zn,[l("span",null,p(("dateFormat"in f?f.dateFormat:o(Yt))(W.shift_date).slice(0,5)),1)])]),_:2},1024),e(T,{class:"text-center"},{default:t(()=>[l("div",Bn,[l("span",An,"+"+p(W.cost)+"р.",1)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):(a(),d("div",Gn," Выберите логиста для отображения отчетов "))])}}}),Hn={class:"flex flex-col gap-2"},jn={class:"flex flex-col gap-2"},qn={class:"flex items-center"},Yn={class:"w-full"},Xn={class:"flex items-center"},Kn={class:"w-full"},Zn={class:"flex gap-2 items-center"},Qn={class:"w-full rounded-lg p-2 border border-slate-200 bg-white text-slate-950 shadow-sm dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50"},Jn={key:0,class:"text-center"},ei={key:1,class:"text-red-500 text-center"},ti={key:2,class:"text-center"},li={key:3,class:"text-center"},si={class:"flex items-center gap-2"},ai={class:"flex flex-col items-center"},oi=["href"],ni={key:1,class:"flex flex-col text-wrap"},ii={key:2,class:"text-wrap text-gray-600"},ui={class:"flex flex-col gap-1"},ri={key:0},di={key:1},ci={key:2},pi={key:3},mi={key:4},_i={class:"flex flex-col"},vi={class:"font-semibold text-green-600"},fi={key:0,class:"font-semibold text-red-500"},gi=ne({__name:"PackersReportTable",props:{period:{},curentPacker:{}},emits:["updated"],setup(L,{emit:B}){const z=Ie(),{$useApi:P}=ie(),{toast:M}=re(),k=L,R=z.user,U=m(k.period),r=m(new Date(k.period+"-01")),v=m(new Date(+k.period.split("-")[0],+k.period.split("-")[1],0)),_=m([]),y=m(!1),c=m(null),n=m(!1),w=m(null),j=m(!1),$=m(null),s=m(),x=m(0),f=m([new Date(k.period).toISOString().slice(0,10),new Date(+k.period.split("-")[0],+k.period.split("-")[1],1).toISOString().slice(0,10)]),u=async()=>{if(k.curentPacker)try{y.value=!0,c.value=null;const W=new Date(f.value[0]).toISOString().slice(0,10),D=new Date(f.value[1]).toISOString().slice(0,10),{data:Y}=await P.get(`production/packer/${k.curentPacker.id}/reports`,{params:{from:W,to:D}});_.value=Y,x.value=Y.reduce((le,N)=>le+N.cost-N.penaltyCost,0)}catch{c.value="Не удалось загрузить отчеты",M({title:"Ошибка",description:c.value,variant:"destructive"})}finally{y.value=!1}},E=W=>{W.isOther?($.value={...W},j.value=!0):(w.value={...W},n.value=!0)},O=async()=>{await u(),n.value=!1,w.value=null},A=async()=>{if(k.curentPacker)try{const{data:W}=await P.get(`production/packer/${k.curentPacker.id}/shifts`,{params:{period:U.value}});s.value=W.map(D=>D.shift_date)}catch{M({title:"Ошибка",description:"Не удалось загрузить смены",variant:"destructive"})}},F=W=>"Рабочих дней: "+W.length,V=W=>"Период с "+W.map(D=>{const Y=new Date(D).toISOString().slice(0,10).split("-"),le=Y[2],N=Y[1],g=Y[0];return`${le}.${N}.${g}`}).join(" по "),T=async()=>{if(k.curentPacker)try{const W=s.value?s.value.map(D=>new Date(D).toISOString().slice(0,10)):[];await P.post(`production/packer/${k.curentPacker.id}/shifts`,{shiftDates:W,period:U.value}),M({title:"Успех",description:"Смены сохранены"}),C("updated")}catch(W){console.log(W),M({title:"Ошибка",description:"Не удалось сохранить смены",variant:"destructive"})}},h=W=>{const D=new Date(W);return`${D.getDate().toString().padStart(2,"0")}.${(D.getMonth()+1).toString().padStart(2,"0")}.${D.getFullYear()}`},C=B;return ee(f,()=>{u()},{deep:!0}),_e(async()=>{await u(),await A()}),(W,D)=>{const Y=Et,le=we,N=ye,g=ge,b=fe,G=be,H=xe,oe=ve,K=xt,ce=Pe,Q=tt,ue=We;return a(),d("div",Hn,[l("div",jn,[l("div",qn,[l("div",Yn,[e(o(Te),{modelValue:o(f),"onUpdate:modelValue":D[0]||(D[0]=J=>$e(f)?f.value=J:null),range:"","enable-time-picker":!1,"min-date":o(r),"max-date":o(v),"auto-apply":"",locale:"ru",placeholder:"Выбрать дни","select-text":"Готово","cancel-text":"Закрыть",class:"grow",format:V,clearable:!1},null,8,["modelValue","min-date","max-date"])])]),l("div",Xn,[l("div",Kn,[e(o(Te),{modelValue:o(s),"onUpdate:modelValue":[D[1]||(D[1]=J=>$e(s)?s.value=J:null),T],"multi-dates":"","enable-time-picker":!1,locale:"ru","min-date":o(r),"max-date":o(v),"start-date":o(r),placeholder:"Выбрать смены","select-text":"Готово","cancel-text":"Закрыть",format:F,class:"grow",clearable:!1},null,8,["modelValue","min-date","max-date","start-date"])])])]),l("div",Zn,[e(Y,{"packer-id":W.curentPacker?.id??0,"cur-user":o(R),class:"w-full",onReportCreated:O},null,8,["packer-id","cur-user"]),l("div",Qn,[l("span",null," Сумма: "+p(o(x))+"р. ",1)])]),o(y)?(a(),d("div",Jn,"Загрузка...")):o(c)?(a(),d("div",ei,p(o(c)),1)):W.curentPacker?o(_).length===0?(a(),d("div",li," Нет отчетов для выбранного упаковщика ")):(a(),I(ce,{key:4,class:"h-[calc(100vh-200px)]"},{default:t(()=>[e(oe,{class:"bg-white rounded-sm"},{default:t(()=>[e(le,null,{default:t(()=>[i("Отчеты упаковщика: "+p(W.curentPacker?.fullName),1)]),_:1}),e(b,null,{default:t(()=>[e(g,null,{default:t(()=>[e(N,null,{default:t(()=>D[5]||(D[5]=[i("Дата",-1)])),_:1,__:[5]}),e(N,{class:"text-center"},{default:t(()=>D[6]||(D[6]=[i("Название",-1)])),_:1,__:[6]}),e(N,{class:"text-center"},{default:t(()=>D[7]||(D[7]=[i("Инфо",-1)])),_:1,__:[7]}),e(N,{class:"text-center"},{default:t(()=>D[8]||(D[8]=[i("Стоимость",-1)])),_:1,__:[8]})]),_:1})]),_:1}),e(H,null,{default:t(()=>[(a(!0),d(se,null,ae(o(_),J=>(a(),I(g,{key:J.id,class:X({"cursor-pointer hover:bg-gray-100":!0,"bg-yellow-100/50":J.isOther,"bg-red-100":J.penaltyCost>0}),onClick:Fe=>E(J)},{default:t(()=>[e(G,null,{default:t(()=>[l("div",si,[l("span",null,p(h(J.date).slice(0,5)),1),J.comment?(a(),I(o(Ae),{key:0})):S("",!0)])]),_:2},1024),e(G,{class:"text-center"},{default:t(()=>[l("div",ai,[J.name.startsWith("http")?(a(),d("a",{key:0,href:J.name,target:"_blank",class:"text-blue-500 hover:underline",onClick:D[2]||(D[2]=Je(()=>{},["stop"]))},"Карточка",8,oi)):(a(),d("div",ni,[l("span",null,p(J.name),1)])),J.dopsComment?(a(),d("span",ii," + "+p(J.dopsComment),1)):S("",!0)])]),_:2},1024),J.isOther?(a(),I(G,{key:0,class:"text-center"},{default:t(()=>D[9]||(D[9]=[i(" Другое ",-1)])),_:1,__:[9]})):(a(),I(G,{key:1,class:"text-center"},{default:t(()=>[l("div",ui,[J.items?(a(),d("span",ri,p(J.items)+" выв.",1)):S("",!0),J.dimmers?(a(),d("span",di,p(J.dimmers)+" дим.",1)):S("",!0),J.adapters?(a(),d("span",ci,p(J.adapters)+" блок",1)):S("",!0),J.lam?(a(),d("span",pi,p(J.lam)+" пленка",1)):S("",!0),J.overSize?(a(),d("span",mi,"Не габарит")):S("",!0)])]),_:2},1024)),e(G,{class:"text-center"},{default:t(()=>[l("div",_i,[l("span",vi,"+"+p(J.cost)+"р.",1),J.penaltyCost?(a(),d("span",fi,p(" -"+J.penaltyCost)+"р.",1)):S("",!0)])]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),e(K,{orientation:"horizontal"})]),_:1})):(a(),d("div",ti," Выберите упаковщика для отображения отчетов ")),o(n)&&o(w)?(a(),I(Q,{key:5,report:o(w),"cur-user":o(R),onReportUpdated:O,onClose:D[3]||(D[3]=J=>n.value=!1)},null,8,["report","cur-user"])):S("",!0),o(j)&&o($)?(a(),I(ue,{key:6,report:o($),onReportUpdated:O,onClose:D[4]||(D[4]=J=>j.value=!1)},null,8,["report"])):S("",!0)])}}}),yi={class:"flex flex-col gap-2"},bi={class:"px-2"},xi={class:"text-xl font-semibold py-2"},wi={key:0,class:"text-center"},hi={key:1,class:"text-red-500 text-center"},ki={key:2,class:"text-center"},$i={key:3},Ui={class:"flex flex-col sm:flex-row gap-4"},Vi={class:"flex-1"},Ci={class:"text-lg font-bold text-green-600"},Si={class:"flex-1"},Mi={class:"text-lg font-bold text-blue-600"},Ri={class:"overflow-x-auto"},Di=ne({__name:"PackersStat",props:{range:{}},setup(L){const{$useApi:B}=ie(),{toast:z}=re(),P=L,M=m(P.range.from.slice(0,7)),k=m(!1),R=m(null),U=m(null),r=m(),v=m(!1),_=async()=>{try{k.value=!0,R.value=null;const{data:$}=await B.get("production/packer-stat",{params:{period:M.value}});U.value=$}catch{R.value="Не удалось загрузить статистику",z({title:"Ошибка",description:R.value,variant:"destructive"})}finally{k.value=!1}},y=$=>{const s=new Date($),x=et(s,"dd",{locale:lt}),f=et(s,"EEEEEE",{locale:lt});return`${x} (${f})`},c=$=>{const x=new Date($).getDay();return x===0||x===6},n=ke(()=>U.value?Object.values(U.value.shiftsSumByDate).reduce(($,s)=>$+s,0):0),w=ke(()=>U.value?Object.values(U.value.itemsSumByDate).reduce(($,s)=>$+s,0):0),j=async $=>{r.value=$,v.value=!0};return ee(()=>P.range,async()=>{M.value=P.range.from.slice(0,7),await _()}),_e(async()=>{await _()}),($,s)=>{const x=Mt,f=Tt,u=Pt,E=Dt,O=gi,A=Rt,F=St,V=st,T=we,h=ye,C=ge,W=fe,D=be,Y=xe,le=ve;return a(),d("div",yi,[e(F,{open:v.value,"onUpdate:open":s[0]||(s[0]=N=>v.value=N)},{default:t(()=>[e(x,{class:"hidden"}),e(A,{class:"min-w-[500px] p-0"},{default:t(()=>[e(E,{class:"hidden"},{default:t(()=>[e(f),e(u)]),_:1}),l("div",bi,[l("div",xi,p(r.value?.fullName),1),r.value?(a(),I(O,{key:0,period:M.value,"curent-packer":r.value,onUpdated:_},null,8,["period","curent-packer"])):S("",!0)])]),_:1})]),_:1},8,["open"]),k.value?(a(),d("div",wi,"Загрузка...")):R.value?(a(),d("div",hi,p(R.value),1)):!U.value||U.value.packers.length===0?(a(),d("div",ki," Нет данных за выбранный период ")):(a(),d("div",$i,[e(V,{class:"mb-4 p-4 bg-white rounded-sm shadow-sm"},{default:t(()=>[l("div",Ui,[l("div",Vi,[s[1]||(s[1]=l("h3",{class:"text-sm font-semibold text-gray-700"}," Общее количество смен ",-1)),l("p",Ci,p(n.value),1)]),l("div",Si,[s[2]||(s[2]=l("h3",{class:"text-sm font-semibold text-gray-700"}," Общее количество вывесок ",-1)),l("p",Mi,p(w.value),1)])])]),_:1}),l("div",Ri,[e(le,{class:"bg-white rounded-sm text-xs w-full border border-black"},{default:t(()=>[e(T,null,{default:t(()=>[i("Статистика упаковщиков за "+p(M.value),1)]),_:1}),e(W,null,{default:t(()=>[e(C,null,{default:t(()=>[e(h,{class:"p-2 sticky left-0 bg-gray-300 font-bold border border-black"},{default:t(()=>s[3]||(s[3]=[i("Упаковщик",-1)])),_:1,__:[3]}),(a(!0),d(se,null,ae(U.value.dates,(N,g)=>(a(),I(h,{key:N,class:"p-1 text-center bg-gray-300 border border-black"},{default:t(()=>[i(p(y(N).split(" ")[0]),1),s[4]||(s[4]=l("br",null,null,-1)),i(" "+p(y(N).split(" ")[1]),1)]),_:2,__:[4]},1024))),128))]),_:1})]),_:1}),e(Y,null,{default:t(()=>[e(C,null,{default:t(()=>[e(D,{class:"p-2 sticky left-0 bg-gray-300 font-semibold border border-black"},{default:t(()=>s[5]||(s[5]=[i("Смены",-1)])),_:1,__:[5]}),(a(!0),d(se,null,ae(U.value.dates,(N,g)=>(a(),I(D,{key:N,class:"p-1 text-center bg-green-500/50 border border-black"},{default:t(()=>[i(p(U.value.shiftsSumByDate[N]||0),1)]),_:2},1024))),128))]),_:1}),e(C,null,{default:t(()=>[e(D,{class:"p-2 sticky left-0 bg-gray-300 font-semibold border border-black"},{default:t(()=>s[6]||(s[6]=[i("Вывески",-1)])),_:1,__:[6]}),(a(!0),d(se,null,ae(U.value.dates,(N,g)=>(a(),I(D,{key:N,class:"p-1 text-center bg-gray-300/50 border border-black"},{default:t(()=>[i(p(U.value.itemsSumByDate[N]||0),1)]),_:2},1024))),128))]),_:1}),(a(!0),d(se,null,ae(U.value.packers,N=>(a(),I(C,{key:N.packerId,class:"cursor-pointer",onClick:g=>j({id:N.packerId,fullName:N.fullName})},{default:t(()=>[e(D,{class:"p-2 sticky left-0 bg-gray-300 border border-black"},{default:t(()=>[i(p(N.fullName),1)]),_:2},1024),(a(!0),d(se,null,ae(U.value.dates,(g,b)=>(a(),I(D,{key:g,class:X(["p-1 text-center border border-black",{"bg-blue-100/50":c(g),"bg-green-500/50":N.shiftsByDate[g],"font-bold":N.itemsByDate[g]}])},{default:t(()=>[i(p(N.itemsByDate[g]||0),1)]),_:2},1032,["class"]))),128))]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})])]))])}}}),Ti={class:"w-full"},Pi={class:""},Oi={class:"flex flex-col gap-5"},Ei={class:"relative"},Ii={class:"flex gap-2"},Fi={class:"relative"},Ni={class:"flex gap-2"},Gi={class:"relative"},Li={class:"flex gap-2"},zi={class:"flex gap-2"},Bi={class:"relative"},Ai={class:"flex gap-2"},Wi={class:"relative"},Hi={class:"relative"},ji={key:0,class:"relative"},qi={class:"relative"},Yi={class:"flex justify-end w-full"},Xi={class:"flex flex-col gap-5"},Ki={class:"relative"},Zi={class:"relative"},Qi={class:"relative"},Ji={class:"flex justify-end w-full"},eu=ne({__name:"ReportCreate",props:{frezerId:{},curUser:{}},emits:["report-created"],setup(L,{emit:B}){const{$useApi:z}=ie(),{toast:P}=re(),M=B,k=L,R=m(!1),U=m(!0),r=m("new"),v={date:new Date().toISOString().slice(0,10),items:0,sheets:0,remake:0,hours:0,cost:0,square:0,userId:k.frezerId,comment:"",penaltyCost:0},_=m({...v}),y={date:new Date().toISOString().slice(0,10),name:"",cost:0,userId:k.frezerId},c=m({...y}),n=()=>{const{hours:$}=_.value,s=$*300;_.value.cost=s},w=async()=>{try{U.value=!0,await z.post("production/frezer-report",{..._.value,userId:k.frezerId}),R.value=!1,U.value=!1,M("report-created"),P({title:"Успех",description:"Отчет успешно создан"})}catch($){console.log($)}},j=async()=>{try{U.value=!0,await z.post("production/other-report",{...c.value,userId:k.frezerId}),R.value=!1,U.value=!1,M("report-created"),P({title:"Успех",description:"Отчет успешно создан"})}catch($){console.log($)}};return ee(_,()=>{n();const{date:$,items:s,sheets:x,hours:f,square:u}=_.value;U.value=!($&&s&&x&&f&&u)},{deep:!0}),ee(c,()=>{const{date:$,name:s,cost:x}=c.value;U.value=!($&&s&&x)},{deep:!0}),ee(R,$=>{$||(_.value={...v},c.value={...y,userId:k.frezerId})}),ee(r,()=>{_.value={...v},c.value={...y,userId:k.masterId},U.value=!0}),($,s)=>{const x=Ee,f=pt,u=Se,E=Re,O=Ce,A=ze,F=Le,V=Oe,T=Ue,h=Be,C=Ot,W=Ge,D=De,Y=Ve,le=Me;return a(),d("div",Ti,[e(le,{open:o(R),"onUpdate:open":s[12]||(s[12]=N=>$e(R)?R.value=N:null)},{default:t(()=>[e(f,{"as-child":""},{default:t(()=>[e(x,{class:"w-full"},{default:t(()=>s[13]||(s[13]=[i("Создать",-1)])),_:1,__:[13]})]),_:1}),e(Y,{class:"max-w-[400px] flex flex-col top-0 translate-y-[0px]"},{default:t(()=>[e(O,null,{default:t(()=>[e(u,null,{default:t(()=>s[14]||(s[14]=[i("Создать запись",-1)])),_:1,__:[14]}),e(E)]),_:1}),e(W,{modelValue:o(r),"onUpdate:modelValue":s[11]||(s[11]=N=>$e(r)?r.value=N:null)},{default:t(()=>[e(F,{class:"w-full mb-4"},{default:t(()=>[e(A,{class:"w-full",value:"new"},{default:t(()=>s[15]||(s[15]=[i(" Новое ",-1)])),_:1,__:[15]}),e(A,{class:"w-full",value:"other"},{default:t(()=>s[16]||(s[16]=[i(" Другое ",-1)])),_:1,__:[16]})]),_:1}),e(C,{value:"new"},{default:t(()=>[l("div",Pi,[l("div",Oi,[l("div",Ei,[o(_).date?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[17]||(s[17]=[i("Дата смены",-1)])),_:1,__:[17]})):S("",!0),e(T,{modelValue:o(_).date,"onUpdate:modelValue":s[0]||(s[0]=N=>o(_).date=N),type:"date",placeholder:"Дата смены",class:X(o(_).date?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",Ii,[l("div",Fi,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[18]||(s[18]=[i("Вывески",-1)])),_:1,__:[18]}),l("div",Ni,[e(T,{modelValue:o(_).items,"onUpdate:modelValue":s[1]||(s[1]=N=>o(_).items=N),modelModifiers:{number:!0},placeholder:"Вывески",type:"number",min:"0",class:X(o(_).items>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),l("div",Gi,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[19]||(s[19]=[i("Целые листы",-1)])),_:1,__:[19]}),l("div",Li,[e(T,{modelValue:o(_).sheets,"onUpdate:modelValue":s[2]||(s[2]=N=>o(_).sheets=N),modelModifiers:{number:!0},placeholder:"Целые листы",type:"number",min:"0",class:X(o(_).sheets>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])])]),l("div",zi,[l("div",Bi,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[20]||(s[20]=[i("Площадь",-1)])),_:1,__:[20]}),l("div",Ai,[e(T,{modelValue:o(_).square,"onUpdate:modelValue":s[3]||(s[3]=N=>o(_).square=N),modelModifiers:{number:!0},placeholder:"Площадь",type:"number",min:"0",class:X(o(_).square>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),l("div",Wi,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[21]||(s[21]=[i("Часы работы",-1)])),_:1,__:[21]}),e(T,{modelValue:o(_).hours,"onUpdate:modelValue":s[4]||(s[4]=N=>o(_).hours=N),modelModifiers:{number:!0},placeholder:"Часы работы",type:"number",min:"0",class:X(o(_).hours>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),l("div",Hi,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[22]||(s[22]=[i("Переделки(м2)",-1)])),_:1,__:[22]}),e(T,{modelValue:o(_).remake,"onUpdate:modelValue":s[5]||(s[5]=N=>o(_).remake=N),modelModifiers:{number:!0},placeholder:"Переделки(м2)",type:"number",min:"0",class:X(o(_).remake>=0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),$.curUser?.role.shortName!=="FRZ"?(a(),d("div",ji,[e(V,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[23]||(s[23]=[i("Штраф",-1)])),_:1,__:[23]}),e(T,{modelValue:o(_).penaltyCost,"onUpdate:modelValue":s[6]||(s[6]=N=>o(_).penaltyCost=N),placeholder:"Штраф",type:"number"},null,8,["modelValue"])])):S("",!0),l("div",qi,[e(h,{modelValue:o(_).comment,"onUpdate:modelValue":s[7]||(s[7]=N=>o(_).comment=N),placeholder:"Комментарий",disabled:$.curUser?.role.shortName==="FRZ"},null,8,["modelValue","disabled"]),o(_).comment?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[24]||(s[24]=[i(" Комментарий ",-1)])),_:1,__:[24]})):S("",!0)]),l("span",null," Стоимость: "+p(o(_).cost)+"р. ",1)]),l("div",Yi,[e(x,{disabled:o(U),onClick:w},{default:t(()=>s[25]||(s[25]=[i(" Создать ",-1)])),_:1,__:[25]},8,["disabled"])])])]),_:1}),e(C,{value:"other"},{default:t(()=>[l("div",Xi,[l("div",Ki,[o(c).date?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[26]||(s[26]=[i("Дата",-1)])),_:1,__:[26]})):S("",!0),e(T,{modelValue:o(c).date,"onUpdate:modelValue":s[8]||(s[8]=N=>o(c).date=N),type:"date",placeholder:"Дата",class:X(o(c).date?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",Zi,[o(c).name?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[27]||(s[27]=[i("Описание",-1)])),_:1,__:[27]})):S("",!0),e(T,{modelValue:o(c).name,"onUpdate:modelValue":s[9]||(s[9]=N=>o(c).name=N),placeholder:"Описание",class:X(o(c).name?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",Qi,[o(c).cost?(a(),I(V,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[28]||(s[28]=[i("Стоимость",-1)])),_:1,__:[28]})):S("",!0),e(T,{modelValue:o(c).cost,"onUpdate:modelValue":s[10]||(s[10]=N=>o(c).cost=N),type:"number",placeholder:"Стоимость",class:X(o(c).cost?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("span",null," Стоимость: "+p(o(c).cost)+"р. ",1)]),l("div",Ji,[e(x,{disabled:o(U),onClick:j},{default:t(()=>s[29]||(s[29]=[i(" Создать ",-1)])),_:1,__:[29]},8,["disabled"])])]),_:1})]),_:1},8,["modelValue"]),e(D)]),_:1})]),_:1},8,["open"])])}}}),tu={class:"w-full"},lu={class:""},su={class:"flex flex-col gap-5"},au={class:"relative"},ou={class:"flex gap-2"},nu={class:"relative"},iu={class:"flex gap-2"},uu={class:"relative"},ru={class:"flex gap-2"},du={class:"flex gap-2"},cu={class:"relative"},pu={class:"flex gap-2"},mu={class:"relative"},_u={class:"relative"},vu={key:0,class:"relative"},fu={class:"relative"},gu={class:"flex justify-between w-full gap-2"},yu=ne({__name:"ReportEdit",props:{report:{},curUser:{}},emits:["report-updated","close"],setup(L,{emit:B}){const{$useApi:z}=ie(),{toast:P}=re(),M=B,k=L,R=m(!0),U=m(!0),r=m({...k.report}),v=()=>{const{hours:c}=r.value,n=c*300;r.value.cost=n},_=async()=>{try{U.value=!0,await z.patch(`production/frezer-report/${r.value.id}`,{...r.value}),R.value=!1,U.value=!1,M("report-updated"),P({title:"Успех",description:"Отчет успешно отредактирован"})}catch(c){console.log(c)}},y=async()=>{try{await z.delete(`production/frezer-report/${r.value.id}`),R.value=!1,M("report-updated"),P({title:"Успех",description:"Отчет успешно удален"})}catch(c){console.log(c)}};return ee(r,()=>{v();const{date:c,items:n,sheets:w,hours:j,square:$}=r.value;U.value=!(c&&n&&w&&j&&$)},{deep:!0}),ee(R,c=>{c||M("close")}),(c,n)=>{const w=Se,j=Re,$=Ce,s=Oe,x=Ue,f=Be,u=Ee,E=De,O=Ve,A=Me;return a(),d("div",tu,[e(A,{open:o(R),"onUpdate:open":n[8]||(n[8]=F=>$e(R)?R.value=F:null)},{default:t(()=>[e(O,{class:"max-w-[400px] flex flex-col top-0 translate-y-[0px]"},{default:t(()=>[e($,null,{default:t(()=>[e(w,null,{default:t(()=>n[9]||(n[9]=[i("Редактировать запись",-1)])),_:1,__:[9]}),e(j)]),_:1}),l("div",lu,[l("div",su,[l("div",au,[o(r).date?(a(),I(s,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[10]||(n[10]=[i("Дата смены",-1)])),_:1,__:[10]})):S("",!0),e(x,{modelValue:o(r).date,"onUpdate:modelValue":n[0]||(n[0]=F=>o(r).date=F),type:"date",placeholder:"Дата смены",class:X(o(r).date?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),l("div",ou,[l("div",nu,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[11]||(n[11]=[i("Вывески",-1)])),_:1,__:[11]}),l("div",iu,[e(x,{modelValue:o(r).items,"onUpdate:modelValue":n[1]||(n[1]=F=>o(r).items=F),modelModifiers:{number:!0},placeholder:"Вывески",type:"number",min:"0",class:X(o(r).items>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),l("div",uu,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[12]||(n[12]=[i("Целые листы",-1)])),_:1,__:[12]}),l("div",ru,[e(x,{modelValue:o(r).sheets,"onUpdate:modelValue":n[2]||(n[2]=F=>o(r).sheets=F),modelModifiers:{number:!0},placeholder:"Целые листы",type:"number",min:"0",class:X(o(r).sheets>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])])]),l("div",du,[l("div",cu,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[13]||(n[13]=[i("Площадь",-1)])),_:1,__:[13]}),l("div",pu,[e(x,{modelValue:o(r).square,"onUpdate:modelValue":n[3]||(n[3]=F=>o(r).square=F),modelModifiers:{number:!0},placeholder:"Площадь",type:"number",min:"0",class:X(o(r).square>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),l("div",mu,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[14]||(n[14]=[i("Часы работы",-1)])),_:1,__:[14]}),e(x,{modelValue:o(r).hours,"onUpdate:modelValue":n[4]||(n[4]=F=>o(r).hours=F),modelModifiers:{number:!0},placeholder:"Часы работы",type:"number",min:"0",class:X(o(r).hours>0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])]),l("div",_u,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[15]||(n[15]=[i("Переделки(м2)",-1)])),_:1,__:[15]}),e(x,{modelValue:o(r).remake,"onUpdate:modelValue":n[5]||(n[5]=F=>o(r).remake=F),modelModifiers:{number:!0},placeholder:"Переделки(м2)",type:"number",min:"0",class:X(o(r).remake>=0?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),c.curUser?.role.shortName!=="FRZ"?(a(),d("div",vu,[e(s,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>n[16]||(n[16]=[i("Штраф",-1)])),_:1,__:[16]}),e(x,{modelValue:o(r).penaltyCost,"onUpdate:modelValue":n[6]||(n[6]=F=>o(r).penaltyCost=F),placeholder:"Штраф",type:"number"},null,8,["modelValue"])])):S("",!0),l("div",fu,[e(f,{modelValue:o(r).comment,"onUpdate:modelValue":n[7]||(n[7]=F=>o(r).comment=F),placeholder:"Комментарий",disabled:c.curUser?.role.shortName==="FRZ"},null,8,["modelValue","disabled"]),o(r).comment?(a(),I(s,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>n[17]||(n[17]=[i(" Комментарий ",-1)])),_:1,__:[17]})):S("",!0)]),l("span",null," Стоимость: "+p(o(r).cost)+"р. ",1)]),l("div",gu,[e(u,{variant:"destructive",onClick:y},{default:t(()=>n[18]||(n[18]=[i(" Удалить ",-1)])),_:1,__:[18]}),e(u,{disabled:o(U),onClick:_},{default:t(()=>n[19]||(n[19]=[i(" Сохранить ",-1)])),_:1,__:[19]},8,["disabled"])])]),e(E)]),_:1})]),_:1},8,["open"])])}}}),bu={class:"flex flex-col gap-2"},xu={class:"flex flex-col gap-2"},wu={class:"flex gap-2 flex-wrap items-center"},hu={class:"flex justify-between w-[300px] rounded-lg p-2 border border-slate-200 bg-white text-slate-950 shadow-sm"},ku={key:0,class:"text-center"},$u={key:1,class:"text-red-500 text-center"},Uu={key:2,class:"text-center"},Vu={key:3,class:"text-center"},Cu={key:4},Su={class:"flex items-center gap-2"},Mu={class:"font-semibold"},Ru={class:"text-center"},Du={class:"flex flex-col"},Tu={class:"font-semibold text-green-600"},Pu={key:0,class:"text-xs text-gray-500"},Ou={key:1,class:"font-semibold text-red-500"},Eu={key:0},Iu={key:1,class:"text-xs text-gray-500"},Fu={key:2,class:"text-xs text-gray-500"},Nu={key:0,class:"flex flex-col"},Gu={key:1,class:"flex flex-col"},Lu=ne({__name:"index",props:{range:{}},setup(L){mt({title:"Фререзовка | Easy CRM",meta:[{name:"viewport",content:"width=device-width, initial-scale=1.0"}]});const B=Ie(),{$useApi:z}=ie(),{toast:P}=re(),M=L,k=B.user,R=m(M.range.from.slice(0,7)),U=m([]),r=m(null),v=m([]),_=m([]),y=m(!1),c=m(null),n=m(!1),w=m(null),j=m(!1),$=m(null),s=m(0),x=m(0),f=async()=>{try{y.value=!0,c.value=null;const{data:V}=await z.get("production/frezers");U.value=V,V.length>0?r.value=V[0]:(r.value=null,P({title:"Ошибка",description:"Список фрезеровщиков пуст",variant:"destructive"}))}catch{c.value="Не удалось загрузить список фрезеровщиков",P({title:"Ошибка",description:c.value,variant:"destructive"})}finally{y.value=!1}},u=async()=>{if(r.value&&M.range)try{y.value=!0,c.value=null;const{data:V}=await z.get(`production/frezer/${r.value.id}/reports`,{params:M.range}),T=V.map(h=>({...h,avgCostPerItem:h.items>0?Number((h.cost/h.items).toFixed(2)):0,materialCostSheets:h.sheets*6e3,materialCostSquare:h.square*2e3,avgSubstrateCost:h.items>0?(h.sheets*6e3/h.items).toFixed(2):0,totalCostPerItem:h.items>0?(h.cost/h.items+h.sheets*6e3/h.items).toFixed(2):0}));v.value=T,_.value=T,F()}catch{c.value="Не удалось загрузить отчеты",P({title:"Ошибка",description:c.value,variant:"destructive"})}finally{y.value=!1}},E=V=>{const T=new Date(V);return`${T.getDate().toString().padStart(2,"0")}.${(T.getMonth()+1).toString().padStart(2,"0")}.${T.getFullYear()}`},O=V=>{if(V.isOther){$.value={...V},j.value=!0;return}w.value={...V},n.value=!0},A=async()=>{await u(),n.value=!1,w.value=null},F=()=>{s.value=v.value.reduce((V,T)=>V+(T.cost-T.penaltyCost),0),x.value=v.value.reduce((V,T)=>V+(T.hours??0),0)};return _e(async()=>{await f()}),ee(r,()=>{r.value&&u()}),ee(()=>M.range,async()=>{R.value=M.range.from.slice(0,7),await u()}),(V,T)=>{const h=at,C=eu,W=we,D=ye,Y=ge,le=fe,N=be,g=xe,b=ve,G=Pe,H=yu,oe=We;return a(),d("div",bu,[l("div",xu,[l("div",wu,[o(U).length>1||o(k)?.role.shortName!=="FRZ"?(a(),I(h,{key:0,items:o(U).map(K=>({value:K.id,label:K.fullName})),label:o(r)?.fullName||"Выберите фрезеровщика",onSelectedItem:T[0]||(T[0]=K=>{r.value=o(U).find(ce=>ce.id===K)||null})},null,8,["items","label"])):S("",!0),l("div",null,[o(k)?(a(),I(C,{key:0,"frezer-id":o(r)?.id??0,"cur-user":o(k),onReportCreated:u},null,8,["frezer-id","cur-user"])):S("",!0)]),l("div",hu,[l("span",null," Часы: "+p(o(x)),1),l("span",null," Сумма: "+p(o(s))+"р. ",1)])])]),o(y)?(a(),d("div",ku,"Загрузка...")):o(c)?(a(),d("div",$u,p(o(c)),1)):o(r)?o(v).length===0?(a(),d("div",Vu," Нет отчетов для выбранного мастера. ")):(a(),d("div",Cu,[e(G,{class:"h-[calc(100vh-325px)] rounded-sm"},{default:t(()=>[e(b,{class:"bg-white rounded-sm relative"},{default:t(()=>[e(W),e(le,{class:"sticky top-0 z-50 bg-gray-50"},{default:t(()=>[e(Y,null,{default:t(()=>[e(D,null,{default:t(()=>T[3]||(T[3]=[i("Дата",-1)])),_:1,__:[3]}),e(D,{class:"text-center"},{default:t(()=>T[4]||(T[4]=[i("Подложки",-1)])),_:1,__:[4]}),e(D,{class:"text-center"},{default:t(()=>T[5]||(T[5]=[i("Листы",-1)])),_:1,__:[5]}),e(D,{class:"text-center"},{default:t(()=>T[6]||(T[6]=[i("Площадь",-1)])),_:1,__:[6]}),e(D,{class:"text-center"},{default:t(()=>T[7]||(T[7]=[i("В ЗП",-1)])),_:1,__:[7]}),e(D,{class:"text-center"},{default:t(()=>T[8]||(T[8]=[i("Переделки(м2)",-1)])),_:1,__:[8]}),e(D,{class:"text-center whitespace-break-spaces"},{default:t(()=>T[9]||(T[9]=[i("Стоимость подложки",-1)])),_:1,__:[9]}),e(D,{class:"text-center whitespace-break-spaces"},{default:t(()=>T[10]||(T[10]=[i("Стоимость материала",-1)])),_:1,__:[10]})]),_:1})]),_:1}),e(g,null,{default:t(()=>[(a(!0),d(se,null,ae(o(v),K=>(a(),I(Y,{key:K.id,class:X({"cursor-pointer hover:bg-gray-100":!0,"bg-yellow-100/50":K.isOther,"bg-red-100":K.penaltyCost>0}),onClick:ce=>O(K)},{default:t(()=>[e(N,null,{default:t(()=>[l("div",Su,[l("span",null,p(E(K.date).slice(0,5)),1),K.comment?(a(),I(o(Ae),{key:0})):S("",!0)])]),_:2},1024),e(N,{class:"text-center"},{default:t(()=>[l("span",Mu,p(K.items??0)+" шт.",1)]),_:2},1024),e(N,null,{default:t(()=>[l("div",Ru,[l("span",null,p(K.sheets??0)+" шт.",1)])]),_:2},1024),e(N,{class:"text-center"},{default:t(()=>[l("span",null,p(K.square??0)+"м2.",1)]),_:2},1024),e(N,{class:"text-center"},{default:t(()=>[l("div",Du,[l("span",Tu," +"+p(K.cost)+"р. ",1),K.isOther?S("",!0):(a(),d("span",Pu,"за "+p(K.hours)+"ч.",1)),K.penaltyCost?(a(),d("span",Ou,p(" -"+K.penaltyCost)+"р.",1)):S("",!0)])]),_:2},1024),e(N,{class:"text-center"},{default:t(()=>[l("span",{class:X({"text-red-500 font-semibold":K.remake})},p(K.remake??0)+"м2.",3)]),_:2},1024),e(N,{class:"text-center flex flex-col"},{default:t(()=>[K.isOther?S("",!0):(a(),d("span",Eu,p(K.totalCostPerItem)+"р.",1)),K.isOther?S("",!0):(a(),d("span",Iu,"Фрезеровка - "+p(K.avgCostPerItem)+"р.",1)),K.isOther?S("",!0):(a(),d("span",Fu,"Материал - "+p(K.avgSubstrateCost)+"р.",1))]),_:2},1024),e(N,{class:"text-center"},{default:t(()=>[K.isOther?(a(),d("div",Gu,[l("span",null,p(K.name),1)])):(a(),d("div",Nu,[l("span",null,"По листам - "+p(K.materialCostSheets.toFixed(2))+"р.",1),l("span",null,"По площади - "+p(K.materialCostSquare.toFixed(2))+"р.",1)]))]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1})])):(a(),d("div",Uu," Выберите мастера для отображения отчетов. ")),o(n)&&o(w)?(a(),I(H,{key:5,report:o(w),"cur-user":o(k),onReportUpdated:A,onClose:T[1]||(T[1]=K=>n.value=!1)},null,8,["report","cur-user"])):S("",!0),o(j)&&o($)?(a(),I(oe,{key:6,report:o($),onReportUpdated:A,onClose:T[2]||(T[2]=K=>j.value=!1)},null,8,["report"])):S("",!0)])}}}),zu={class:"relative h-screen hidden-scrollbar"},Bu={class:"w-full fixed z-10"},Au={class:"h-[full] flex px-4 gap-2 mx-[auto] max-w-[2048px] pt-16"},Wu={class:"flex flex-col gap-2 w-full"},Hu={class:"flex gap-2 items-center flex-wrap"},ju={key:1,class:"md:hidden w-[240px]"},qu={key:0},Yu={key:1},Xu={key:2},Ku={key:3},Zu={key:4},Qu={key:5},Ju={key:6},er={key:7},tr={key:8},nd=ne({__name:"index",setup(L){const{$useApi:B}=ie();mt({title:"Производство | Easy CRM"});const z=m(new Date().toISOString().slice(0,7)),P=m({month:new Date().getMonth(),year:new Date().getFullYear()}),M=m([]),k=m(""),R=m(null),U=v=>{R.value=v},r=async()=>{const{data:v}=await B.get("production/predata");M.value=v.tabs,k.value=v.tabs[0].value};return ee(P,v=>{const{month:_,year:y}=v;z.value=new Date(y,_+1).toISOString().slice(0,7)}),_e(async()=>{await r()}),(v,_)=>{const y=It,c=Ft,n=ze,w=Le,j=Ge,$=ut,s=it,x=Nt,f=dt,u=ct,E=rt,O=nt,A=xs,F=Ys,V=oa,T=Do,h=Mn,C=Wn,W=Di,D=Lu;return a(),d("div",zu,[l("div",Bu,[e(y)]),l("div",Au,[l("div",Wu,[l("div",Hu,[e(c,{onRangeUpdated:U}),o(M).length&&o(M).length>1?(a(),I(j,{key:0,modelValue:o(k),"onUpdate:modelValue":_[0]||(_[0]=Y=>$e(k)?k.value=Y:null),class:"hidden md:block w-[400px]"},{default:t(()=>[e(w,null,{default:t(()=>[(a(!0),d(se,null,ae(o(M),Y=>(a(),I(n,{key:Y.value,value:Y.value},{default:t(()=>[i(p(Y.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])):S("",!0),o(M).length>1?(a(),d("div",ju,[e(O,{modelValue:o(k),"onUpdate:modelValue":_[1]||(_[1]=Y=>$e(k)?k.value=Y:null)},{default:t(()=>[e(s,null,{default:t(()=>[e($,{placeholder:"Выберите раздел"})]),_:1}),e(E,null,{default:t(()=>[e(u,null,{default:t(()=>[e(x,null,{default:t(()=>_[2]||(_[2]=[i("Разделы",-1)])),_:1,__:[2]}),(a(!0),d(se,null,ae(o(M),Y=>(a(),I(f,{key:Y.value,value:Y.value},{default:t(()=>[i(p(Y.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])])):S("",!0)]),o(k)==="orders"&&o(R)?(a(),d("div",qu,[e(A,{range:o(R)},null,8,["range"])])):S("",!0),o(k)==="masters"&&o(R)?(a(),d("div",Yu,[e(F,{range:o(R)},null,8,["range"])])):o(k)==="supplie"&&o(R)?(a(),d("div",Xu,[e(V,{range:o(R)},null,8,["range"])])):o(k)==="table"&&o(R)?(a(),d("div",Ku,[e(T,{range:o(R)},null,8,["range"])])):o(k)==="package"&&o(R)?(a(),d("div",Zu,[e(h,{range:o(R)},null,8,["range"])])):o(k)==="logist"&&o(R)?(a(),d("div",Qu,[e(C,{range:o(R)},null,8,["range"])])):o(k)==="packers-stat"&&o(R)?(a(),d("div",Ju,[e(W,{range:o(R)},null,8,["range"])])):o(k)==="frezer"&&o(R)?(a(),d("div",er,[e(D,{range:o(R)},null,8,["range"])])):o(k)==="salaries"&&o(R)?(a(),d("div",tr,"Зарплаты")):S("",!0)])])])}}});export{nd as default};
