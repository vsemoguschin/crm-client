import{_}from"./CDst0A0O.js";import{_ as h}from"./Bye7C16d.js";import{_ as v}from"./DLFIBFui.js";import{e as g,f as x,g as k,r as m,i as w,c as o,b as i,a as t,w as y,F as S,n as N,l as I,o as a,d as T}from"./BbheI0mw.js";import{u as A}from"./DzJc7hp_.js";import{u as C}from"./CCknexPU.js";import"./B9M8ggfK.js";import"./D0Fd2yXn.js";import"./oLxPQbNe.js";import"./D2GZmoDz.js";import"./CaPtdwNj.js";import"./DVdymwQ5.js";import"./KSX9JOtw.js";import"./ZTyVILcU.js";import"./s39mgViW.js";import"./CJOOd8Dx.js";import"./BR3DQNok.js";import"./odSmgr3d.js";const E={class:"relative h-screen hidden-scrollbar"},R={key:0,class:"flex items-center justify-center h-screen"},$={key:1,class:"flex items-center justify-center h-screen"},b={class:"text-center"},B={class:"w-full fixed z-10"},F={class:"h-[full] flex p-4 gap-4 mx-[auto] max-w-[2048px] pt-16"},ee=g({__name:"with-sidebar",setup(L){C();const u=A(),s=x(),{$useApi:p}=k(),r=m(!0),n=m(!1),c=async()=>{if(!localStorage.getItem("accessToken")){r.value=!1,await s.push("/login");return}try{const{data:e}=await p.get("/profile");u.setUser(e),e.role.shortName==="DIZ"&&await s.push("/diz"),["MASTER","PACKER","FRZ","FINANCIER"].includes(e.role.shortName)&&await s.push("/production")}catch{n.value=!0,localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),await s.push("/login")}finally{r.value=!1}};return w(()=>{c()}),(l,e)=>{const f=_,d=h;return a(),o("div",E,[r.value?(a(),o("div",R,e[0]||(e[0]=[t("span",null,"Загрузка...",-1)]))):n.value?(a(),o("div",$,[t("div",b,[e[2]||(e[2]=t("p",{class:"text-red-500"},"Ошибка загрузки профиля",-1)),i(f,{variant:"outline",onClick:c},{default:y(()=>e[1]||(e[1]=[T("Повторить",-1)])),_:1,__:[1]})])])):(a(),o(S,{key:2},[t("div",B,[i(d)]),t("div",F,[N(l.$slots,"default")])],64)),i(I(v))])}}});export{ee as default};
