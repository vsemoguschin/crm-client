import{a as ie,_ as re}from"./Bmr5wyhr.js";import{a as Z,b as I,_ as ee}from"./CNLsaPwj.js";import{_ as te}from"./BCRlC5xu.js";import{_ as se}from"./fRExJa2e.js";import{_ as de}from"./DnQg8zF_.js";import{_ as ue,a as ce,b as _e}from"./DkMjgWCi.js";import{_ as me}from"./CY7rJOej.js";import{a as pe,b as fe,_ as le}from"./CjugPKIA.js";import{_ as ge}from"./CP8umD4q.js";import ve from"./CNFJry-h.js";import{_ as ye}from"./D8Osd5Ax.js";import{b as we,c as $e,d as xe}from"./DkkQ8vn7.js";import{_ as be}from"./Da2JRHOT.js";import{e as oe,g as ae,r as y,m as k,o as c,w as t,b as e,d,t as i,l as s,c as p,F as U,z as N,a as o,D as T,K as ke,J as X,u as he}from"./LcRD3ia0.js";import{_ as Ce}from"./CaSHqX9y.js";import{_ as Ue}from"./Bf5Xhgcu.js";import{_ as Ne}from"./cLgFti_O.js";import"./DfRdkKc3.js";import"./D5ydJhlK.js";import"./D9TSNOAg.js";import"./BdQOAs7V.js";import"./BOGtf0gU.js";import"./QkXyQO2w.js";import"./B-kig6KZ.js";import"./BqmAL8DW.js";import"./Pvv-dh1L.js";import"./C0YhWajo.js";import"./BcuVElyA.js";import"./mqOaxR0N.js";import"./D6LOIvye.js";import"./D8EW8v7U.js";import"./AeDsR3BR.js";import"./BcyKike4.js";import"./CCJdEHHg.js";import"./BgkA-2sO.js";import"./Dbg8U1qb.js";import"./DaWZu8wl.js";import"./voh6vBZz.js";const De={class:"gap-3 flex-1 border p-2 rounded-md"},Me={class:"text-gray-600"},Ve={class:""},Oe={class:""},ze={class:""},Le={class:""},Te={class:"gap-3 flex-1 border p-2 rounded-md"},Fe={class:"text-gray-600"},Pe={class:""},Ae={class:""},Be={class:""},Ee={key:0,class:""},Re={class:"gap-3 flex-1 border p-2 rounded-md"},Se={class:"text-gray-600"},je={class:""},He={class:""},Ge={key:0},Je={class:"gap-3 flex-1 border p-2 rounded-md"},Ke={class:"gap-1 text-gray-600"},Qe={class:""},We={class:""},qe={class:""},Xe={class:""},Ye={class:""},Ze={key:0,class:"gap-3 flex-1 border p-2 rounded-md"},Ie={class:"text-gray-600 pb-2"},et={class:"w-full flex justify-between mt-3"},tt=oe({__name:"OrderCard",props:{currentOrder:{},stages:{},workers:{}},emits:["update-orders-list"],setup(Y,{emit:v}){const{$useApi:f}=ae(),a=y({...Y.currentOrder}),D=y({...a.value.frezer}),F=y({...a.value.laminater}),m=y({...a.value.master}),M=y({...a.value.packer}),P=v,S=async r=>{await f.delete(`/orders/${r}`),P("update-orders-list")},C=async()=>{const{data:r}=await f.get(`/orders/${a.value.id}`);a.value=r},G=async(r,l)=>{console.log(r,l);const{data:g}=await f.patch(`/orders/${r}/stage/${l}`);return await C(),console.log(g)},j=async(r,l)=>{console.log(r,l);const{data:g}=await f.patch(`/orders/${r}/frezer/${l}`);return await C(),console.log(g)},B=async(r,l)=>{console.log(r,l);const{data:g}=await f.patch(`/orders/${r}/laminater/${l}`);return await C(),console.log(g)},H=async(r,l)=>{console.log(r,l);const{data:g}=await f.patch(`/orders/${r}/master/${l}`);return await C(),console.log(g)},J=async(r,l)=>{console.log(r,l);const{data:g}=await f.patch(`/orders/${r}/packer/${l}`);return await C(),console.log(g)};return(r,l)=>{const g=I,_=ve,u=ye,V=$e,w=ie,O=be,$=fe,z=pe,x=xe,b=we,E=te,K=Z,Q=se,W=le,R=ge,q=ee;return c(),k(q,null,{default:t(()=>[e(K,{class:"bg-slate-50 p-2 pl-4"},{default:t(()=>[e(g,null,{default:t(()=>[d(i(s(a).title),1)]),_:1}),e(E,{class:"flex items-center gap-2"},{default:t(()=>[d("Статус: "+i(s(a).stage?.title||"Выгрузка")+" ",1),e(b,null,{default:t(()=>[e(V,{"as-child":""},{default:t(()=>[e(u,{size:"icon",class:"h-6 w-6"},{default:t(()=>[e(_,{name:"mdi:skew-more",color:"white",size:"20px"})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(w,{class:"text-center"},{default:t(()=>l[6]||(l[6]=[d("Переместить ",-1)])),_:1,__:[6]}),e(O),e(z,{modelValue:s(a).stage.title,"onUpdate:modelValue":l[0]||(l[0]=n=>s(a).stage.title=n)},{default:t(()=>[(c(!0),p(U,null,N(r.stages,n=>(c(),k($,{key:n.id,value:n.title,onClick:A=>G(s(a).id,n.id)},{default:t(()=>[d(i(n.title),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,{class:"flex gap-2 p-2 flex-col"},{default:t(()=>[o("div",De,[l[8]||(l[8]=o("div",{class:"font-semibold pb-2"},"Задание на фрезеровку",-1)),o("ul",Me,[o("li",Ve,"Материал: "+i(s(a).material),1),o("li",Oe," Размеры: "+i(s(a).boardHeight)+"/"+i(s(a).boardWidth)+" см ",1),o("li",ze,"Отверстия: "+i(s(a).holeType),1),o("li",Le,"Подставка: "+i(s(a).stand===!0?"Да":"Нет"),1),o("li",null,[d(" Выполнил: "+i(s(a).frezer?.fullName)+" ",1),e(b,null,{default:t(()=>[e(V,{"as-child":""},{default:t(()=>[e(u,{size:"icon",class:"h-6 w-6"},{default:t(()=>[e(_,{name:"mingcute:edit-line",color:"white",size:"20px"})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(w,{class:"text-center"},{default:t(()=>l[7]||(l[7]=[d("Назначить ",-1)])),_:1,__:[7]}),e(O),e(z,{modelValue:s(D).fullName,"onUpdate:modelValue":l[1]||(l[1]=n=>s(D).fullName=n)},{default:t(()=>[(c(!0),p(U,null,N(r.workers,n=>(c(),k($,{key:n.id,value:n.fullName,onClick:A=>j(s(a).id,n.id)},{default:t(()=>[d(i(n.fullName)+" - "+i(n.role.fullName),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])])]),o("div",Te,[l[10]||(l[10]=o("div",{class:"font-semibold pb-2"},"Задание на пленку",-1)),o("ul",Fe,[o("li",Pe,"Пленка: "+i(s(a).laminate||"Нет"),1),o("li",Ae,"Акрил: "+i(s(a).acrylic||"Нет"),1),o("li",Be,"Печать: "+i(s(a).print===!0?"Да":"Нет"),1),s(a).print?(c(),p("li",Ee," Качество: "+i(s(a).printQuality===!0?"Согласовано":"Не согласовано"),1)):T("",!0),o("li",null,[d(" Выполнил: "+i(s(a).laminater?.fullName)+" ",1),e(b,null,{default:t(()=>[e(V,{"as-child":""},{default:t(()=>[e(u,{size:"icon",class:"h-6 w-6"},{default:t(()=>[e(_,{name:"mingcute:edit-line",color:"white",size:"20px"})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(w,{class:"text-center"},{default:t(()=>l[9]||(l[9]=[d("Назначить ",-1)])),_:1,__:[9]}),e(O),e(z,{modelValue:s(F).fullName,"onUpdate:modelValue":l[2]||(l[2]=n=>s(F).fullName=n)},{default:t(()=>[(c(!0),p(U,null,N(r.workers,n=>(c(),k($,{key:n.id,value:n.fullName,onClick:A=>B(s(a).id,n.id)},{default:t(()=>[d(i(n.fullName),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])])]),o("div",Re,[l[14]||(l[14]=o("div",{class:"font-semibold pb-2"},"Задание на сборку",-1)),o("ul",Se,[o("li",je,"Назначение: "+i(s(a).type),1),o("li",He,"Провод от вывески(акустика): "+i(s(a).wireLength),1),l[13]||(l[13]=o("li",{class:""},"Неон:",-1)),(c(!0),p(U,null,N(s(a).neons,n=>(c(),p("li",{key:n.id,class:"pl-3"},[l[11]||(l[11]=d(" - ",-1)),o("span",null,i(n.color)+"("+i(n.width)+") / "+i(n.length)+"см ",1),n.width==="Подсветка"?(c(),p("span",Ge,i(n.elements)+"(эл).",1)):T("",!0)]))),128)),o("li",null,"Элементы: "+i(s(a).elements),1),o("li",null,"Подарок: "+i(s(a).gift===!0?"Да":"Нет"),1),o("li",null,[d(" Выполнил: "+i(s(a).master?.fullName)+" ",1),e(b,null,{default:t(()=>[e(V,{"as-child":""},{default:t(()=>[e(u,{size:"icon",class:"h-6 w-6"},{default:t(()=>[e(_,{name:"mingcute:edit-line",color:"white",size:"20px"})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(w,{class:"text-center"},{default:t(()=>l[12]||(l[12]=[d("Назначить ",-1)])),_:1,__:[12]}),e(O),e(z,{modelValue:s(m).fullName,"onUpdate:modelValue":l[3]||(l[3]=n=>s(m).fullName=n)},{default:t(()=>[(c(!0),p(U,null,N(r.workers,n=>(c(),k($,{key:n.id,value:n.fullName,onClick:A=>H(s(a).id,n.id)},{default:t(()=>[d(i(n.fullName),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])])]),o("div",Je,[l[17]||(l[17]=o("div",{class:"font-semibold pb-2"},"Задание на упаковку",-1)),o("ul",Ke,[o("li",Qe,"Тип блока: "+i(s(a).adapter),1),o("li",We,[l[15]||(l[15]=d(" Провод от блока: ",-1)),o("span",null,i(s(a).plug),1)]),o("li",qe,"Крепления: "+i(s(a).fitting),1),o("li",Xe,"Диммер: "+i(s(a).dimmer===!0?"Да":"Нет"),1),o("li",Ye," Подарочная упаковка: "+i(s(a).giftPack===!0?"Да":"Нет"),1),o("li",null,"Подарок: "+i(s(a).gift===!0?"Да":"Нет"),1),o("li",null,[d(" Выполнил: "+i(s(a).packer?.fullName)+" ",1),e(b,null,{default:t(()=>[e(V,{"as-child":""},{default:t(()=>[e(u,{size:"icon",class:"h-6 w-6"},{default:t(()=>[e(_,{name:"mingcute:edit-line",color:"white",size:"20px"})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(w,{class:"text-center"},{default:t(()=>l[16]||(l[16]=[d("Назначить ",-1)])),_:1,__:[16]}),e(O),e(z,{modelValue:s(M).fullName,"onUpdate:modelValue":l[4]||(l[4]=n=>s(M).fullName=n)},{default:t(()=>[(c(!0),p(U,null,N(r.workers,n=>(c(),k($,{key:n.id,value:n.fullName,onClick:A=>J(s(a).id,n.id)},{default:t(()=>[d(i(n.fullName),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])])]),s(a).description?(c(),p("div",Ze,[l[18]||(l[18]=o("div",{class:"font-semibold pb-2"},"Доп. информация",-1)),o("div",Ie,i(s(a).description),1)])):T("",!0)]),_:1}),e(R,null,{default:t(()=>[o("div",et,[e(W,{order:s(a),onOrderEdited:C},null,8,["order"]),e(u,{onClick:l[5]||(l[5]=()=>S(s(a).id))},{default:t(()=>[e(_,{name:"mi:delete",color:"white",size:"25px"})]),_:1})])]),_:1})]),_:1})}}}),st={class:"flex relative"},lt={class:"w-[50px] fixed"},ot={class:"p-3 w-full ml-[50px] flex justify-center gap-3"},at={class:"flex flex-col max-w-[720px] gap-3"},nt={class:"flex flex-col w-full"},it={class:"mr-3 rounded overflow-hidden w-full"},rt={class:"flex flex-col"},dt=["href"],ut=["href"],ct={class:"w-full h-full flex flex-col gap-2"},_t=["href"],Yt=oe({__name:"[id] copy",async setup(Y){let v,f;const{$useApi:h}=ae(),D=ke().params.id,F={id:0,title:"Пусто",price:1e4,status:"null",deadline:"-----",clothingMethod:"string",description:"string",source:"string",adTag:"string",discont:"string",sphere:"string",city:"string",region:"string",cardLink:"string",paid:"string",totalPrice:1,dopsPrice:1,recievedPayments:1,remainder:1,firstPayment:"string",clientType:"string",recievedPay:1,createdAt:"",dealers:[],client:{id:0,fullName:"string",workSpaceId:0,groupId:0,phone:"string",type:"string",chatLink:"string",gender:"string",firstContact:"string",adLink:"string",inn:"string"},preorder:{preview:"string"},deliveries:[{id:0,method:"string",type:"string",description:"string",track:"string",status:"string",price:0}]},m=y(F),M=y(F.deliveries),P=y(F.orders),S=y([]),C=y([]),{data:G}=([v,f]=X(()=>h.get("/stages")),v=await v,f(),v),{data:j}=([v,f]=X(()=>h.get("production/workers")),v=await v,f(),v);S.value=G||[],C.value=j||[];const B=y([]),H=async()=>{const{data:_}=await h.get(`production/deals/${D}`);m.value=_,M.value=_.deliveries||[],P.value=_.orders||[];const{data:u}=await h.get("kaiten/card/"+_.card_id);console.log(u),u!=="Nope"&&(m.value.preorder=u),B.value=_.files,he({title:m.value.title+" | Easy CRM"||"Easy CRM"})};H();const J=()=>{console.log("deal-updated"),H()},r=async()=>{const{data:_}=await h.get(`/deals/${D}/files`);console.log(_.files),B.value=_.files||[]};[v,f]=X(()=>r()),await v,f();const l=async()=>{const{data:_}=await h.get(`/deals/${D}/deliveries`);M.value=_.deliveries||[]},g=async()=>{const{data:_}=await h.get(`/deals/${D}/orders`);P.value=_.orders||[]};return(_,u)=>{const V=re,w=I,O=te,$=Z,z=de,x=se,b=ee,E=_e,K=ce,Q=le,W=tt,R=me,q=Ce,n=Ue,A=Ne,ne=ue;return c(),p("div",st,[o("div",lt,[e(V)]),o("div",ot,[o("div",at,[e(b,{class:"overflow-hidden"},{default:t(()=>[e($,{class:"bg-slate-50 p-3 pt-2"},{default:t(()=>[e(w,null,{default:t(()=>[d(i(s(m).title),1)]),_:1}),e(O,null,{default:t(()=>[d(" Готовность: "+i(s(m).deadline),1),u[0]||(u[0]=o("br",null,null,-1)),d(" Статус: "+i(s(m).status),1)]),_:1,__:[0]})]),_:1}),s(m).preorder?(c(),k(x,{key:0,class:"p-2"},{default:t(()=>[o("div",nt,[o("div",it,[e(z,{src:s(m).preorder.preview,alt:"Preview",class:"preview-image w-full"},null,8,["src"])]),o("div",rt,[o("a",{class:"underline decoration-solid cursor-pointer text-blue-600",href:s(m).preorder?.card_link,target:"_blank"},"Ссылка на карточку",8,dt),o("a",{class:"underline decoration-solid cursor-pointer text-blue-600",href:s(m).preorder.maket+"?name="+s(m).title+".cdr&dl=true"},"Макет",8,ut)])])]),_:1})):T("",!0)]),_:1}),e(ne,{"default-value":"Заказы",class:""},{default:t(()=>[e(K,null,{default:t(()=>[e(E,{value:"Заказы"},{default:t(()=>u[1]||(u[1]=[d("Заказы ",-1)])),_:1,__:[1]}),e(E,{value:"Доставки"},{default:t(()=>u[2]||(u[2]=[d("Доставки ",-1)])),_:1,__:[2]}),e(E,{value:"Файлы"},{default:t(()=>u[3]||(u[3]=[d("Файлы ",-1)])),_:1,__:[3]})]),_:1}),e(R,{value:"Заказы"},{default:t(()=>[e(b,{class:"overflow-hidden pb-6"},{default:t(()=>[e($,{class:"p-2 pb-2 bg-slate-50 flex"},{default:t(()=>[e(w,{class:"flex items-center"},{default:t(()=>[e(Q,{deal:s(m),class:"mr-3 justify-between",onOrderCreated:J},null,8,["deal"]),u[4]||(u[4]=d(" Список заказов ",-1))]),_:1,__:[4]})]),_:1}),s(P)?.length?(c(),k(x,{key:0,class:"p-2 h-full"},{default:t(()=>[o("div",ct,[(c(!0),p(U,null,N(s(P),L=>(c(),p("div",{key:L.id},[e(W,{"current-order":L,stages:s(S),workers:s(j),onUpdateOrdersList:g},null,8,["current-order","stages","workers"])]))),128))])]),_:1})):T("",!0)]),_:1})]),_:1}),e(R,{value:"Доставки"},{default:t(()=>[e(b,{class:"overflow-hidden"},{default:t(()=>[e($,{class:"p-2 pb-2 bg-slate-50 flex"},{default:t(()=>[e(w,{class:"flex items-center"},{default:t(()=>[e(q,{deal:s(m),class:"mr-3",onDeliveryCreated:l},null,8,["deal"]),u[5]||(u[5]=d(" Список доставок ",-1))]),_:1,__:[5]})]),_:1}),s(M)?.length?(c(),k(x,{key:0,class:"p-2"},{default:t(()=>[e(n,{deliveries:s(M),onDeliveryEdited:l,onDeliveryDeleted:l},null,8,["deliveries"])]),_:1})):T("",!0)]),_:1})]),_:1}),e(R,{value:"Файлы"},{default:t(()=>[e(b,{class:"overflow-hidden"},{default:t(()=>[e($,{class:"p-2 pb-2 bg-slate-50 flex"},{default:t(()=>[e(w,{class:"flex items-center gap-3"},{default:t(()=>[e(A,{deal:s(m),onFileUploaded:r},null,8,["deal"]),u[6]||(u[6]=d(" Файлы ",-1))]),_:1,__:[6]})]),_:1}),e(x,{class:"p-2"},{default:t(()=>[(c(!0),p(U,null,N(s(B),L=>(c(),p("div",{key:L.id},[L.type!=="imgs"?(c(),p("a",{key:0,class:"underline decoration-solid cursor-pointer text-blue-600",href:L.url,target:"_blank"},i(L.name),9,_t)):T("",!0)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})])])])}}});export{Yt as default};
