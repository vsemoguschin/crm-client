import{_ as K}from"./Bmr5wyhr.js";import{_ as S}from"./D8Osd5Ax.js";import{b as P,c as R,f as q,d as G}from"./DkkQ8vn7.js";import{_ as H}from"./mqOaxR0N.js";import{_ as J}from"./Dbg8U1qb.js";import{e as V,r as s,g as T,c as w,a as i,b as o,w as n,o as l,d as x,t as U,M as O,K as Q,f as W,v,i as X,m as B,D as Y,l as b,F as Z,z as ee,be as te}from"./LcRD3ia0.js";import{u as oe}from"./BOGtf0gU.js";import{u as se}from"./QkXyQO2w.js";import{_ as ae}from"./DyWTjfgC.js";import{_ as ne}from"./DlAUqK2U.js";import"./DfRdkKc3.js";import"./D5ydJhlK.js";import"./D9TSNOAg.js";import"./BdQOAs7V.js";import"./D8EW8v7U.js";import"./D6LOIvye.js";const re={class:"fixed inset-0 flex items-center justify-center bg-black/40 z-50"},le={class:"w-full max-w-md rounded-xl bg-white p-6 shadow-lg"},ie={class:"flex justify-end gap-2"},ue=V({__name:"BoardCreateForm",emits:["created","close"],setup(I,{emit:_}){const u=_,a=s(""),c=s(""),d=s(!1),{$api:h}=T();async function k(){if(a.value.trim()){d.value=!0;try{const r={title:a.value.trim(),description:c.value.trim()||null},e=await h.$post("/boards",r);u("created"),y()}catch(r){console.error("createBoard failed",r),O({variant:"destructive",title:"Ошибка",description:"Не удалось создать доску."})}finally{d.value=!1}}}function y(){u("close"),a.value="",c.value=""}return(r,e)=>{const C=H,p=J,$=S;return l(),w("div",re,[i("div",le,[e[3]||(e[3]=i("h2",{class:"mb-4 text-lg font-semibold"},"Создать новую доску",-1)),o(C,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=m=>a.value=m),placeholder:"Название доски",class:"mb-3 w-full rounded-lg border border-neutral-200 px-3 py-2 outline-none focus:ring-2 focus:ring-indigo-500"},null,8,["modelValue"]),o(p,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=m=>c.value=m),placeholder:"Описание (необязательно)",class:"mb-4 w-full rounded-lg border border-neutral-200 px-3 py-2 outline-none focus:ring-2 focus:ring-indigo-500"},null,8,["modelValue"]),i("div",ie,[o($,{variant:"ghost",class:"px-4 py-2 rounded-lg border border-neutral-200",onClick:y},{default:n(()=>e[2]||(e[2]=[x(" Отмена ",-1)])),_:1,__:[2]}),o($,{class:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",disabled:d.value,onClick:k},{default:n(()=>[x(U(d.value?"Создание...":"Создать"),1)]),_:1},8,["disabled"])])])])}}}),ce={class:"relative h-screen hidden-scrollbar"},de={class:"w-full fixed z-10"},me={class:"min-h-screen bg-neutral-800 pt-14"},_e={class:"absolute top-[62px] left-4 flex items-center gap-3"},pe={class:"mt-[2px] flex items-center gap-1"},fe={key:1,class:"text-neutral-400 text-sm"},ge=V({__name:"boards",setup(I){const _=Q(),u=W();v(()=>Number(_.params.id)),v(()=>Number(_.params.taskId)),se();const a=oe(),{$useApi:c,$api:d}=T(),h=s(!0),k=s(!1),y=s([]);s(0);const r=s(!1),e=s(!1),C=v(()=>a.user),p=v(()=>C.value?.boards??[]),$=v(()=>{const f=Number(_.params.id);return p.value.find(t=>Number(t.id)===f)?.title||"Выбрать доску"}),m=async()=>{r.value=!0;try{const f=await d.$get("/boards");y.value=f??[]}finally{r.value=!1}},M=async()=>{if(!localStorage.getItem("accessToken")){h.value=!1,await u.push("/login");return}try{const{data:t}=await c.get("/profile");a.setUser(t)}catch{k.value=!0,localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),await u.push("/login")}finally{h.value=!1}};return X(()=>{M(),m(),console.log("layouts")}),(f,t)=>{const D=K,N=S,L=R,F=q,z=G,A=P,j=ue,E=te;return l(),w("div",ce,[i("div",de,[o(D)]),i("div",me,[i("div",_e,[i("div",pe,[o(N,{class:"rounded-sm text-2xl bg-neutral-800 hover:bg-neutral-800 hover:text-neutral-300 text-neutral-300 font-medium",variant:"ghost",title:"Создать доску",onClick:t[0]||(t[0]=g=>e.value=!0)},{default:n(()=>t[2]||(t[2]=[x(" + ",-1)])),_:1,__:[2]}),b(p).length?(l(),B(A,{key:0},{default:n(()=>[o(L,{"as-child":""},{default:n(()=>[o(N,{class:"bg-neutral-800 h-9 text-xl py-3 border-1 border-neutral-500/20 text-neutral-300 hover:bg-neutral-700"},{default:n(()=>[x(U(b($))+" ▾ ",1)]),_:1})]),_:1}),o(z,{class:"bg-neutral-800 text-neutral-300"},{default:n(()=>[(l(!0),w(Z,null,ee(b(p),g=>(l(),B(F,{key:g.id,class:"cursor-pointer",onClick:ve=>b(u).push(`/boards/${g.id}`)},{default:n(()=>[x(U(g.title),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):(l(),w("div",fe,"Нет доступных досок"))])]),e.value?(l(),B(j,{key:0,onCreated:m,onClose:t[1]||(t[1]=g=>e.value=!1)})):Y("",!0),o(E)]),o(b(ae))])}}}),De=ne(ge,[["__scopeId","data-v-b4aebb57"]]);export{De as default};
