import{_ as tt}from"./mqOaxR0N.js";import{S as Et,aA as xa,O as ka,c as we,aB as wa,aC as $a,_ as Le}from"./D8Osd5Ax.js";import{g as Te,h as Ca,t as Ia,i as Va,j as Ct,k as Sa,l as Ta,m as it,r as qt,S as It,P as _e,n as Ae,o as Aa,p as De,q as Je,s as Ba,v as Ea,w as Ke,D as qa,x as Ua,y as Pe,z as Fa,T as Ma,A as Da,e as ut,_ as Ut,B as Oa,C as La,E as Pa,u as Ft,b as za,c as Ra,d as Na,f as ja}from"./DkkQ8vn7.js";import{v as ne,r as E,B as he,O as Ka,$ as xe,l as t,av as He,aX as Ha,Z as Wa,e as Q,_ as Ga,a$ as Xa,G as Vt,a1 as Ya,m as N,o as p,w as u,n as ue,x as fe,c as w,D as K,F as pe,z as me,b as r,aF as We,as as Ve,k as ve,aV as Qa,i as be,bd as Ja,a0 as Za,H as Me,E as el,d as M,p as dt,t as D,q as Mt,g as Be,a as v,X as Ne,aB as tl,A as Ie,a2 as st,a3 as Dt,a4 as rt,y as Oe,I as ct,C as Ot,ax as al,aD as Lt,aT as ll,h as nl,f as ol,K as sl}from"./LcRD3ia0.js";import{c as Pt,X as Ze}from"./D5ydJhlK.js";import{_ as rl,a as il,b as ul}from"./DkMjgWCi.js";import{_ as dl}from"./CY7rJOej.js";import{_ as cl}from"./Da2JRHOT.js";import{_ as pt}from"./BcuVElyA.js";import{_ as zt}from"./YaXf-8Sh.js";import{_ as ft,a as mt,b as vt,c as ht,d as gt}from"./AeDsR3BR.js";import{_ as yt}from"./CCJdEHHg.js";import{r as Se,u as pl}from"./D8EW8v7U.js";import{S as fl}from"./xEZuT4Nf.js";import{_ as bt}from"./Dbg8U1qb.js";import{_ as ml}from"./BgkA-2sO.js";import{b as vl,_ as hl,a as gl}from"./CACSUplU.js";import{_ as at}from"./DlAUqK2U.js";import{_ as yl,a as bl,b as _l,c as xl,d as kl}from"./B-kig6KZ.js";import{_ as wl}from"./BqmAL8DW.js";import{_ as $l}from"./Pvv-dh1L.js";import{u as Cl}from"./BOGtf0gU.js";function St(l){return typeof l=="string"?`'${l}'`:new Il().serialize(l)}const Il=function(){class l{#e=new Map;compare(e,n){const s=typeof e,i=typeof n;return s==="string"&&i==="string"?e.localeCompare(n):s==="number"&&i==="number"?e-n:String.prototype.localeCompare.call(this.serialize(e,!0),this.serialize(n,!0))}serialize(e,n){if(e===null)return"null";switch(typeof e){case"string":return n?e:`'${e}'`;case"bigint":return`${e}n`;case"object":return this.$object(e);case"function":return this.$function(e)}return String(e)}serializeObject(e){const n=Object.prototype.toString.call(e);if(n!=="[object Object]")return this.serializeBuiltInType(n.length<10?`unknown:${n}`:n.slice(8,-1),e);const s=e.constructor,i=s===Object||s===void 0?"":s.name;if(i!==""&&globalThis[i]===s)return this.serializeBuiltInType(i,e);if(typeof e.toJSON=="function"){const f=e.toJSON();return i+(f!==null&&typeof f=="object"?this.$object(f):`(${this.serialize(f)})`)}return this.serializeObjectEntries(i,Object.entries(e))}serializeBuiltInType(e,n){const s=this["$"+e];if(s)return s.call(this,n);if(typeof n?.entries=="function")return this.serializeObjectEntries(e,n.entries());throw new Error(`Cannot serialize ${e}`)}serializeObjectEntries(e,n){const s=Array.from(n).sort((f,d)=>this.compare(f[0],d[0]));let i=`${e}{`;for(let f=0;f<s.length;f++){const[d,m]=s[f];i+=`${this.serialize(d,!0)}:${this.serialize(m)}`,f<s.length-1&&(i+=",")}return i+"}"}$object(e){let n=this.#e.get(e);return n===void 0&&(this.#e.set(e,`#${this.#e.size}`),n=this.serializeObject(e),this.#e.set(e,n)),n}$function(e){const n=Function.prototype.toString.call(e);return n.slice(-15)==="[native code] }"?`${e.name||""}()[native]`:`${e.name}(${e.length})${n.replace(/\s*\n\s*/g,"")}`}$Array(e){let n="[";for(let s=0;s<e.length;s++)n+=this.serialize(e[s]),s<e.length-1&&(n+=",");return n+"]"}$Date(e){try{return`Date(${e.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(e){return`ArrayBuffer[${new Uint8Array(e).join(",")}]`}$Set(e){return`Set${this.$Array(Array.from(e).sort((n,s)=>this.compare(n,s)))}`}$Map(e){return this.serializeObjectEntries("Map",e.entries())}}for(const a of["Error","RegExp","URL"])l.prototype["$"+a]=function(e){return`${a}(${e})`};for(const a of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])l.prototype["$"+a]=function(e){return`${a}[${e.join(",")}]`};for(const a of["BigInt64Array","BigUint64Array"])l.prototype["$"+a]=function(e){return`${a}[${e.join("n,")}${e.length>0?"n":""}]`};return l}();function et(l,a){return l===a||St(l)===St(a)}function Vl(l){return new URL(window.location.href)}/**
 * @license lucide-vue-next v0.514.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=Pt("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.514.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=Pt("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);function Al(l,a,e){const n=l.findIndex(d=>et(d,a)),s=l.findIndex(d=>et(d,e));if(n===-1||s===-1)return[];const[i,f]=[n,s].sort((d,m)=>d-m);return l.slice(i,f+1)}function Bl(){let l=document.activeElement;if(l==null)return null;for(;l!=null&&l.shadowRoot!=null&&l.shadowRoot.activeElement!=null;)l=l.shadowRoot.activeElement;return l}const El=["INPUT","TEXTAREA"];function ql(l,a,e,n={}){if(!a||n.enableIgnoredElement&&El.includes(a.nodeName))return null;const{arrowKeyOptions:s="both",attributeName:i="[data-reka-collection-item]",itemsArray:f=[],loop:d=!0,dir:m="ltr",preventScroll:B=!0,focus:_=!1}=n,[g,b,h,y,x,U]=[l.key==="ArrowRight",l.key==="ArrowLeft",l.key==="ArrowUp",l.key==="ArrowDown",l.key==="Home",l.key==="End"],$=h||y,T=g||b;if(!x&&!U&&(!$&&!T||s==="vertical"&&T||s==="horizontal"&&$))return null;const ie=f;if(!ie.length)return null;B&&l.preventDefault();let F=null;return T||$?F=Rt(ie,a,{goForward:$?y:m==="ltr"?g:b,loop:d}):x?F=ie.at(0)||null:U&&(F=ie.at(-1)||null),_&&F?.focus(),F}function Rt(l,a,e,n=l.length){if(--n===0)return null;const s=l.indexOf(a),i=e.goForward?s+1:s-1;if(!e.loop&&(i<0||i>=l.length))return null;const f=(i+l.length)%l.length,d=l[f];return d?d.hasAttribute("disabled")&&d.getAttribute("disabled")!=="false"?Rt(l,d,e,n):d:null}const[Nt,Tu]=Te("ConfigProvider"),Ul=Ca(()=>{const l=E(new Map),a=E(),e=ne(()=>{for(const f of l.value.values())if(f)return!0;return!1}),n=Nt({scrollBody:E(!0)});let s=null;const i=()=>{document.body.style.paddingRight="",document.body.style.marginRight="",document.body.style.pointerEvents="",document.documentElement.style.removeProperty("--scrollbar-width"),document.body.style.overflow=a.value??"",Ct&&s?.(),a.value=void 0};return he(e,(f,d)=>{if(!Va)return;if(!f){d&&i();return}a.value===void 0&&(a.value=document.body.style.overflow);const m=window.innerWidth-document.documentElement.clientWidth,B={padding:m,margin:0},_=n.scrollBody?.value?typeof n.scrollBody.value=="object"?Ka({padding:n.scrollBody.value.padding===!0?m:n.scrollBody.value.padding,margin:n.scrollBody.value.margin===!0?m:n.scrollBody.value.margin},B):B:{padding:0,margin:0};m>0&&(document.body.style.paddingRight=typeof _.padding=="number"?`${_.padding}px`:String(_.padding),document.body.style.marginRight=typeof _.margin=="number"?`${_.margin}px`:String(_.margin),document.documentElement.style.setProperty("--scrollbar-width",`${m}px`),document.body.style.overflow="hidden"),Ct&&(s=Sa(document,"touchmove",g=>Ml(g),{passive:!1})),xe(()=>{document.body.style.pointerEvents="none",document.body.style.overflow="hidden"})},{immediate:!0,flush:"sync"}),l});function Fl(l){const a=Math.random().toString(36).substring(2,7),e=Ul();e.value.set(a,l??!1);const n=ne({get:()=>e.value.get(a)??!1,set:s=>e.value.set(a,s)});return Ia(()=>{e.value.delete(a)}),n}function jt(l){const a=window.getComputedStyle(l);if(a.overflowX==="scroll"||a.overflowY==="scroll"||a.overflowX==="auto"&&l.clientWidth<l.scrollWidth||a.overflowY==="auto"&&l.clientHeight<l.scrollHeight)return!0;{const e=l.parentNode;return!(e instanceof Element)||e.tagName==="BODY"?!1:jt(e)}}function Ml(l){const a=l||window.event,e=a.target;return e instanceof Element&&jt(e)?!1:a.touches.length>1?!0:(a.preventDefault&&a.cancelable&&a.preventDefault(),!1)}function _t(l){const a=Nt({dir:E("ltr")});return ne(()=>l?.value||a.dir?.value||"ltr")}function Kt(l){const a=ne(()=>t(l)),e=ne(()=>new Intl.Collator("en",{usage:"search",...a.value}));return{startsWith:(f,d)=>d.length===0?!0:(f=f.normalize("NFC"),d=d.normalize("NFC"),e.value.compare(f.slice(0,d.length),d)===0),endsWith:(f,d)=>d.length===0?!0:(f=f.normalize("NFC"),d=d.normalize("NFC"),e.value.compare(f.slice(-d.length),d)===0),contains:(f,d)=>{if(d.length===0)return!0;f=f.normalize("NFC"),d=d.normalize("NFC");let m=0;const B=d.length;for(;m+B<=f.length;m++){const _=f.slice(m,m+B);if(e.value.compare(d,_)===0)return!0}return!1}}}function Ht(l){return ne(()=>Ta(l)?!!it(l)?.closest("form"):!0)}var Dl=function(l){if(typeof document>"u")return null;var a=Array.isArray(l)?l[0]:l;return a.ownerDocument.body},Fe=new WeakMap,Xe=new WeakMap,Ye={},ot=0,Wt=function(l){return l&&(l.host||Wt(l.parentNode))},Ol=function(l,a){return a.map(function(e){if(l.contains(e))return e;var n=Wt(e);return n&&l.contains(n)?n:(console.error("aria-hidden",e,"in not contained inside",l,". Doing nothing"),null)}).filter(function(e){return!!e})},Ll=function(l,a,e,n){var s=Ol(a,Array.isArray(l)?l:[l]);Ye[e]||(Ye[e]=new WeakMap);var i=Ye[e],f=[],d=new Set,m=new Set(s),B=function(g){!g||d.has(g)||(d.add(g),B(g.parentNode))};s.forEach(B);var _=function(g){!g||m.has(g)||Array.prototype.forEach.call(g.children,function(b){if(d.has(b))_(b);else try{var h=b.getAttribute(n),y=h!==null&&h!=="false",x=(Fe.get(b)||0)+1,U=(i.get(b)||0)+1;Fe.set(b,x),i.set(b,U),f.push(b),x===1&&y&&Xe.set(b,!0),U===1&&b.setAttribute(e,"true"),y||b.setAttribute(n,"true")}catch($){console.error("aria-hidden: cannot operate on ",b,$)}})};return _(a),d.clear(),ot++,function(){f.forEach(function(g){var b=Fe.get(g)-1,h=i.get(g)-1;Fe.set(g,b),i.set(g,h),b||(Xe.has(g)||g.removeAttribute(n),Xe.delete(g)),h||g.removeAttribute(e)}),ot--,ot||(Fe=new WeakMap,Fe=new WeakMap,Xe=new WeakMap,Ye={})}},Pl=function(l,a,e){e===void 0&&(e="data-aria-hidden");var n=Array.from(Array.isArray(l)?l:[l]),s=Dl(l);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),Ll(n,s,e,"aria-hidden")):function(){return null}};function zl(l){let a;he(()=>it(l),e=>{e?a=Pl(e):a&&a()}),He(()=>{a&&a()})}function ze(l,a="reka"){return`${a}-${Ha?.()}`}function Rl(){return{ALT:"Alt",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",BACKSPACE:"Backspace",CAPS_LOCK:"CapsLock",CONTROL:"Control",DELETE:"Delete",END:"End",ENTER:"Enter",ESCAPE:"Escape",F1:"F1",F10:"F10",F11:"F11",F12:"F12",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",HOME:"Home",META:"Meta",PAGE_DOWN:"PageDown",PAGE_UP:"PageUp",SHIFT:"Shift",SPACE:" ",TAB:"Tab",CTRL:"Control",ASTERISK:"*",SPACE_CODE:"Space"}}function Nl(l){const a=qt("",1e3);return{search:a,handleTypeaheadSearch:(s,i)=>{a.value=a.value+s;{const f=Bl(),d=i.map(b=>({...b,textValue:b.value?.textValue??b.ref.textContent?.trim()??""})),m=d.find(b=>b.ref===f),B=d.map(b=>b.textValue),_=Kl(B,a.value,m?.textValue),g=d.find(b=>b.textValue===_);return g&&g.ref.focus(),g?.ref}},resetTypeahead:()=>{a.value=""}}}function jl(l,a){return l.map((e,n)=>l[(a+n)%l.length])}function Kl(l,a,e){const s=a.length>1&&Array.from(a).every(B=>B===a[0])?a[0]:a,i=e?l.indexOf(e):-1;let f=jl(l,Math.max(i,0));s.length===1&&(f=f.filter(B=>B!==e));const m=f.find(B=>B.toLowerCase().startsWith(s.toLowerCase()));return m!==e?m:void 0}function qe(){const l=E(),a=ne(()=>["#text","#comment"].includes(l.value?.$el.nodeName)?l.value?.$el.nextElementSibling:it(l));return{primitiveElement:l,currentElement:a}}const Tt="data-reka-collection-item";function Ge(l={}){const{key:a="",isProvider:e=!1}=l,n=`${a}CollectionProvider`;let s;if(e){const _=E(new Map);s={collectionRef:E(),itemMap:_},Ya(n,s)}else s=Wa(n);const i=(_=!1)=>{const g=s.collectionRef.value;if(!g)return[];const b=Array.from(g.querySelectorAll(`[${Tt}]`)),y=Array.from(s.itemMap.value.values()).sort((x,U)=>b.indexOf(x.ref)-b.indexOf(U.ref));return _?y:y.filter(x=>x.ref.dataset.disabled!=="")},f=Q({name:"CollectionSlot",setup(_,{slots:g}){const{primitiveElement:b,currentElement:h}=qe();return he(h,()=>{s.collectionRef.value=h.value}),()=>Vt(It,{ref:b},g)}}),d=Q({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(_,{slots:g,attrs:b}){const{primitiveElement:h,currentElement:y}=qe();return Ga(x=>{if(y.value){const U=Xa(y.value);s.itemMap.value.set(U,{ref:y.value,value:_.value}),x(()=>s.itemMap.value.delete(U))}}),()=>Vt(It,{...b,[Tt]:"",ref:h},g)}}),m=ne(()=>Array.from(s.itemMap.value.values())),B=ne(()=>s.itemMap.value.size);return{getItems:i,reactiveItems:m,itemMapSize:B,CollectionSlot:f,CollectionItem:d}}const Hl={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Wl(l,a){return a!=="rtl"?l:l==="ArrowLeft"?"ArrowRight":l==="ArrowRight"?"ArrowLeft":l}function Gl(l,a,e){const n=Wl(l.key,e);if(!(a==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(a==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Hl[n]}var Xl=Q({__name:"VisuallyHidden",props:{feature:{type:String,required:!1,default:"focusable"},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(l){return(a,e)=>(p(),N(t(_e),{as:a.as,"as-child":a.asChild,"aria-hidden":a.feature==="focusable"?"true":void 0,"data-hidden":a.feature==="fully-hidden"?"":void 0,tabindex:a.feature==="fully-hidden"?"-1":void 0,style:{position:"absolute",border:0,width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",whiteSpace:"nowrap",wordWrap:"normal"}},{default:u(()=>[ue(a.$slots,"default")]),_:3},8,["as","as-child","aria-hidden","data-hidden","tabindex"]))}}),Yl=Xl,Ql=Q({inheritAttrs:!1,__name:"VisuallyHiddenInputBubble",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(l){const a=l,{primitiveElement:e,currentElement:n}=qe(),s=ne(()=>a.checked??a.value);return he(s,(i,f)=>{if(!n.value)return;const d=n.value,m=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(m,"value").set;if(_&&i!==f){const g=new Event("input",{bubbles:!0}),b=new Event("change",{bubbles:!0});_.call(d,i),d.dispatchEvent(g),d.dispatchEvent(b)}}),(i,f)=>(p(),N(Yl,fe({ref_key:"primitiveElement",ref:e},{...a,...i.$attrs},{as:"input"}),null,16))}}),At=Ql,Jl=Q({inheritAttrs:!1,__name:"VisuallyHiddenInput",props:{name:{type:String,required:!0},value:{type:null,required:!0},checked:{type:Boolean,required:!1,default:void 0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},feature:{type:String,required:!1,default:"fully-hidden"}},setup(l){const a=l,e=ne(()=>typeof a.value=="object"&&Array.isArray(a.value)&&a.value.length===0&&a.required),n=ne(()=>typeof a.value=="string"||typeof a.value=="number"||typeof a.value=="boolean"||a.value===null||a.value===void 0?[{name:a.name,value:a.value}]:typeof a.value=="object"&&Array.isArray(a.value)?a.value.flatMap((s,i)=>typeof s=="object"?Object.entries(s).map(([f,d])=>({name:`${a.name}[${i}][${f}]`,value:d})):{name:`${a.name}[${i}]`,value:s}):a.value!==null&&typeof a.value=="object"&&!Array.isArray(a.value)?Object.entries(a.value).map(([s,i])=>({name:`${a.name}[${s}]`,value:i})):[]);return(s,i)=>(p(),w(pe,null,[K(" We render single input if it's required "),e.value?(p(),N(At,fe({key:s.name},{...a,...s.$attrs},{name:s.name,value:s.value}),null,16,["name","value"])):(p(!0),w(pe,{key:1},me(n.value,f=>(p(),N(At,fe({key:f.name},{ref_for:!0},{...a,...s.$attrs},{name:f.name,value:f.value}),null,16,["name","value"]))),128))],2112))}}),Gt=Jl,Zl=Q({__name:"ComboboxAnchor",props:{reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(l){const{forwardRef:a}=Ae();return(e,n)=>(p(),N(t(Aa),{"as-child":"",reference:e.reference},{default:u(()=>[r(t(_e),fe({ref:t(a),"as-child":e.asChild,as:e.as},e.$attrs),{default:u(()=>[ue(e.$slots,"default")]),_:3},16,["as-child","as"])]),_:3},8,["reference"]))}}),en=Zl;function tn(l,a,e){return l===void 0?!1:Array.isArray(l)?l.some(n=>je(n,a,e)):je(l,a,e)}function je(l,a,e){return l===void 0||a===void 0?!1:typeof l=="string"?l===a:typeof e=="function"?e(l,a):typeof e=="string"?l?.[e]===a?.[e]:et(l,a)}const[lt,an]=Te("ListboxRoot");var ln=Q({__name:"ListboxRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},orientation:{type:String,required:!1,default:"vertical"},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},selectionBehavior:{type:String,required:!1,default:"toggle"},highlightOnHover:{type:Boolean,required:!1},by:{type:[String,Function],required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","highlight","entryFocus","leave"],setup(l,{expose:a,emit:e}){const n=l,s=e,{multiple:i,highlightOnHover:f,orientation:d,disabled:m,selectionBehavior:B,dir:_}=We(n),{getItems:g}=Ge({isProvider:!0}),{handleTypeaheadSearch:b}=Nl(),{primitiveElement:h,currentElement:y}=qe(),x=Rl(),U=_t(_),$=Ht(y),T=E(),ie=E(!1),F=E(!0),j=De(n,"modelValue",s,{defaultValue:n.defaultValue??(i.value?[]:void 0),passive:n.modelValue===void 0,deep:!0});function de(c){if(ie.value=!0,n.multiple){const z=Array.isArray(j.value)?[...j.value]:[],G=z.findIndex(k=>je(k,c,n.by));n.selectionBehavior==="toggle"?(G===-1?z.push(c):z.splice(G,1),j.value=z):(j.value=[c],T.value=c)}else n.selectionBehavior==="toggle"&&je(j.value,c,n.by)?j.value=void 0:j.value=c;setTimeout(()=>{ie.value=!1},1)}const oe=E(null),X=E(null),A=E(!1),I=E(!1),S=Je(),O=Je(),H=Je();function Y(){return g().map(c=>c.ref).filter(c=>c.dataset.disabled!=="")}function V(c,z=!0){if(!c)return;oe.value=c,F.value&&oe.value.focus(),z&&oe.value.scrollIntoView({block:"nearest"});const G=g().find(k=>k.ref===c);s("highlight",G)}function o(c){if(A.value)H.trigger(c);else{const z=g().find(G=>je(G.value,c,n.by));z&&(oe.value=z.ref,V(z.ref))}}function R(c){oe.value&&oe.value.isConnected&&(c.preventDefault(),c.stopPropagation(),I.value||oe.value.click())}function q(c){if(F.value){if(ie.value=!0,A.value)O.trigger(c);else{const z=c.altKey||c.ctrlKey||c.metaKey;if(z&&c.key==="a"&&i.value){const G=g(),k=G.map(P=>P.value);j.value=[...k],c.preventDefault(),V(G[G.length-1].ref)}else if(!z){const G=b(c.key,g());G&&V(G)}}setTimeout(()=>{ie.value=!1},1)}}function ae(){I.value=!0}function ce(){xe(()=>{I.value=!1})}function se(){xe(()=>{const c=new KeyboardEvent("keydown",{key:"PageUp"});$e(c)})}function ge(c){const z=oe.value;z?.isConnected&&(X.value=z),oe.value=null,s("leave",c)}function ye(c){const z=new CustomEvent("listbox.entryFocus",{bubbles:!1,cancelable:!0});if(c.currentTarget?.dispatchEvent(z),s("entryFocus",z),!z.defaultPrevented)if(X.value)V(X.value);else{const G=Y()?.[0];V(G)}}function $e(c){const z=Gl(c,d.value,U.value);if(!z)return;let G=Y();if(oe.value){if(z==="last")G.reverse();else if(z==="prev"||z==="next"){z==="prev"&&G.reverse();const k=G.indexOf(oe.value);G=G.slice(k+1)}ke(c,G[0])}if(G.length){const k=!oe.value&&z==="prev"?G.length-1:0;V(G[k])}if(A.value)return O.trigger(c)}function ke(c,z){if(!(A.value||n.selectionBehavior!=="replace"||!i.value||!Array.isArray(j.value)||(c.altKey||c.ctrlKey||c.metaKey)&&!c.shiftKey)&&c.shiftKey){const k=g().filter(le=>le.ref.dataset.disabled!=="");let P=k.find(le=>le.ref===z)?.value;if(c.key===x.END?P=k[k.length-1].value:c.key===x.HOME&&(P=k[0].value),!P||!T.value)return;const J=Al(k.map(le=>le.value),T.value,P);j.value=J}}async function L(c){if(await xe(),A.value)S.trigger(c);else{const z=Y(),G=z.find(k=>k.dataset.state==="checked");G?V(G):z.length&&V(z[0])}}return he(j,()=>{ie.value||xe(()=>{L()})},{immediate:!0,deep:!0}),a({highlightedElement:oe,highlightItem:o,highlightFirstItem:se,highlightSelected:L,getItems:g}),an({modelValue:j,onValueChange:de,multiple:i,orientation:d,dir:U,disabled:m,highlightOnHover:f,highlightedElement:oe,isVirtual:A,virtualFocusHook:S,virtualKeydownHook:O,virtualHighlightHook:H,by:n.by,firstValue:T,selectionBehavior:B,focusable:F,onLeave:ge,onEnter:ye,changeHighlight:V,onKeydownEnter:R,onKeydownNavigation:$e,onKeydownTypeAhead:q,onCompositionStart:ae,onCompositionEnd:ce,highlightFirstItem:se}),(c,z)=>(p(),N(t(_e),{ref_key:"primitiveElement",ref:h,as:c.as,"as-child":c.asChild,dir:t(U),"data-disabled":t(m)?"":void 0,onPointerleave:ge,onFocusout:z[0]||(z[0]=async G=>{const k=G.relatedTarget||G.target;await xe(),oe.value&&t(y)&&!t(y).contains(k)&&ge(G)})},{default:u(()=>[ue(c.$slots,"default",{modelValue:t(j)}),t($)&&c.name?(p(),N(t(Gt),{key:0,name:c.name,value:t(j),disabled:t(m),required:c.required},null,8,["name","value","disabled","required"])):K("v-if",!0)]),_:3},8,["as","as-child","dir","data-disabled"]))}}),nn=ln,on=Q({__name:"ListboxContent",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(l){const{CollectionSlot:a}=Ge(),e=lt(),n=qt(!1,10);return(s,i)=>(p(),N(t(a),null,{default:u(()=>[r(t(_e),{role:"listbox",as:s.as,"as-child":s.asChild,tabindex:t(e).focusable.value?t(e).highlightedElement.value?"-1":"0":void 0,"aria-orientation":t(e).orientation.value,"aria-multiselectable":!!t(e).multiple.value,"data-orientation":t(e).orientation.value,onMousedown:i[0]||(i[0]=ve(f=>n.value=!0,["left"])),onFocus:i[1]||(i[1]=f=>{t(n)||t(e).onEnter(f)}),onKeydown:[i[2]||(i[2]=Ve(ve(f=>{t(e).focusable.value&&t(e).onKeydownNavigation(f)},["prevent"]),["down","up","left","right","home","end"])),Ve(t(e).onKeydownEnter,["enter"]),t(e).onKeydownTypeAhead]},{default:u(()=>[ue(s.$slots,"default")]),_:3},8,["as","as-child","tabindex","aria-orientation","aria-multiselectable","data-orientation","onKeydown"])]),_:3}))}}),sn=on,rn=Q({__name:"ListboxFilter",props:{modelValue:{type:String,required:!1},autoFocus:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},emits:["update:modelValue"],setup(l,{emit:a}){const e=l,s=De(e,"modelValue",a,{defaultValue:"",passive:e.modelValue===void 0}),i=lt(),{primitiveElement:f,currentElement:d}=qe(),m=ne(()=>e.disabled||i.disabled.value||!1),B=E();return Qa(()=>B.value=i.highlightedElement.value?.id),be(()=>{i.focusable.value=!1,setTimeout(()=>{e.autoFocus&&d.value?.focus()},1)}),He(()=>{i.focusable.value=!0}),(_,g)=>(p(),N(t(_e),{ref_key:"primitiveElement",ref:f,as:_.as,"as-child":_.asChild,value:t(s),disabled:m.value?"":void 0,"data-disabled":m.value?"":void 0,"aria-disabled":m.value??void 0,"aria-activedescendant":B.value,type:"text",onKeydown:[Ve(ve(t(i).onKeydownNavigation,["prevent"]),["down","up","home","end"]),Ve(t(i).onKeydownEnter,["enter"])],onInput:g[0]||(g[0]=b=>{s.value=b.target.value,t(i).highlightFirstItem()}),onCompositionstart:t(i).onCompositionStart,onCompositionend:t(i).onCompositionEnd},{default:u(()=>[ue(_.$slots,"default",{modelValue:t(s)})]),_:3},8,["as","as-child","value","disabled","data-disabled","aria-disabled","aria-activedescendant","onKeydown","onCompositionstart","onCompositionend"]))}}),un=rn;const[Au,dn]=Te("ListboxGroup");var cn=Q({__name:"ListboxGroup",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(l){const a=l,e=ze(void 0,"reka-listbox-group");return dn({id:e}),(n,s)=>(p(),N(t(_e),fe({role:"group"},a,{"aria-labelledby":t(e)}),{default:u(()=>[ue(n.$slots,"default")]),_:3},16,["aria-labelledby"]))}}),pn=cn;const fn="listbox.select",[Bu,mn]=Te("ListboxItem");var vn=Q({__name:"ListboxItem",props:{value:{type:null,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"div"}},emits:["select"],setup(l,{emit:a}){const e=l,n=a,s=ze(void 0,"reka-listbox-item"),{CollectionItem:i}=Ge(),{forwardRef:f,currentElement:d}=Ae(),m=lt(),B=ne(()=>d.value===m.highlightedElement.value),_=ne(()=>tn(m.modelValue.value,e.value,m.by)),g=ne(()=>m.disabled.value||e.disabled);async function b(y){n("select",y),!y?.defaultPrevented&&!g.value&&y&&(m.onValueChange(e.value),m.changeHighlight(d.value))}function h(y){const x={originalEvent:y,value:e.value};Ba(fn,b,x)}return mn({isSelected:_}),(y,x)=>(p(),N(t(i),{value:y.value},{default:u(()=>[Ja([B.value,_.value],()=>r(t(_e),fe({id:t(s)},y.$attrs,{ref:t(f),role:"option",tabindex:t(m).focusable.value?B.value?"0":"-1":-1,"aria-selected":_.value,as:y.as,"as-child":y.asChild,disabled:g.value?"":void 0,"data-disabled":g.value?"":void 0,"data-highlighted":B.value?"":void 0,"data-state":_.value?"checked":"unchecked",onClick:h,onKeydown:Ve(ve(h,["prevent"]),["space"]),onPointermove:x[0]||(x[0]=U=>{t(m).highlightedElement.value!==t(d)&&(t(m).highlightOnHover.value?t(m).changeHighlight(t(d),!1):t(m).focusable.value||t(m).changeHighlight(t(d),!1))})}),{default:u(()=>[ue(y.$slots,"default")]),_:3},16,["id","tabindex","aria-selected","as","as-child","disabled","data-disabled","data-highlighted","data-state","onKeydown"]),x,1)]),_:3},8,["value"]))}}),hn=vn;const[Re,gn]=Te("ComboboxRoot");var yn=Q({__name:"ComboboxRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1},resetSearchTermOnBlur:{type:Boolean,required:!1,default:!0},resetSearchTermOnSelect:{type:Boolean,required:!1,default:!0},openOnFocus:{type:Boolean,required:!1,default:!1},openOnClick:{type:Boolean,required:!1,default:!1},ignoreFilter:{type:Boolean,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},highlightOnHover:{type:Boolean,required:!1},by:{type:[String,Function],required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","highlight","update:open"],setup(l,{expose:a,emit:e}){const n=l,s=e,{primitiveElement:i,currentElement:f}=qe(),{multiple:d,disabled:m,ignoreFilter:B,resetSearchTermOnSelect:_,openOnFocus:g,openOnClick:b,dir:h}=We(n),y=_t(h),x=De(n,"modelValue",s,{defaultValue:n.defaultValue??(d.value?[]:void 0),passive:n.modelValue===void 0,deep:!0}),U=De(n,"open",s,{defaultValue:n.defaultOpen,passive:n.open===void 0});async function $(Y){U.value=Y,S.value="",Y?(await xe(),i.value?.highlightSelected(),ie.value=!0):ie.value=!1,j.value?.focus(),setTimeout(()=>{!Y&&n.resetSearchTermOnBlur&&T.trigger()},1)}const T=Je(),ie=E(!1),F=E(!1),j=E(),de=E(),oe=ne(()=>i.value?.highlightedElement??void 0),X=E(new Map),A=E(new Map),{contains:I}=Kt({sensitivity:"base"}),S=E(""),O=ne(Y=>{if(!S.value||n.ignoreFilter||F.value)return{count:X.value.size,items:Y?.items??new Map,groups:Y?.groups??new Set(A.value.keys())};let V=0;const o=new Map,R=new Set;for(const[q,ae]of X.value){const ce=I(ae,S.value);o.set(q,ce?1:0),ce&&V++}for(const[q,ae]of A.value)for(const ce of ae)if(o.get(ce)>0){R.add(q);break}return{count:V,items:o,groups:R}}),H=Za();return be(()=>{H?.exposed&&(H.exposed.highlightItem=i.value?.highlightItem,H.exposed.highlightFirstItem=i.value?.highlightFirstItem,H.exposed.highlightSelected=i.value?.highlightSelected)}),a({filtered:O,highlightedElement:oe,highlightItem:i.value?.highlightItem,highlightFirstItem:i.value?.highlightFirstItem,highlightSelected:i.value?.highlightSelected}),gn({modelValue:x,multiple:d,disabled:m,open:U,onOpenChange:$,contentId:"",isUserInputted:ie,isVirtual:F,inputElement:j,highlightedElement:oe,onInputElementChange:Y=>j.value=Y,triggerElement:de,onTriggerElementChange:Y=>de.value=Y,parentElement:f,resetSearchTermOnSelect:_,onResetSearchTerm:T.on,allItems:X,allGroups:A,filterSearch:S,filterState:O,ignoreFilter:B,openOnFocus:g,openOnClick:b}),(Y,V)=>(p(),N(t(Ea),null,{default:u(()=>[r(t(nn),fe({ref_key:"primitiveElement",ref:i},Y.$attrs,{modelValue:t(x),"onUpdate:modelValue":V[0]||(V[0]=o=>Me(x)?x.value=o:null),style:{pointerEvents:t(U)?"auto":void 0},as:Y.as,"as-child":Y.asChild,dir:t(y),multiple:t(d),name:Y.name,required:Y.required,disabled:t(m),"highlight-on-hover":!0,by:n.by,onHighlight:V[1]||(V[1]=o=>s("highlight",o))}),{default:u(()=>[ue(Y.$slots,"default",{open:t(U),modelValue:t(x)})]),_:3},16,["modelValue","style","as","as-child","dir","multiple","name","required","disabled","by"])]),_:3}))}}),bn=yn;const[Eu,_n]=Te("ComboboxContent");var xn=Q({__name:"ComboboxContentImpl",props:{position:{type:String,required:!1,default:"inline"},bodyLock:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(l,{emit:a}){const e=l,n=a,{position:s}=We(e),i=Re(),{forwardRef:f,currentElement:d}=Ae();Fl(e.bodyLock),zl(i.parentElement);const m=ne(()=>e.position==="popper"?e:{}),B=Ke(m.value),_={boxSizing:"border-box","--reka-combobox-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-combobox-content-available-width":"var(--reka-popper-available-width)","--reka-combobox-content-available-height":"var(--reka-popper-available-height)","--reka-combobox-trigger-width":"var(--reka-popper-anchor-width)","--reka-combobox-trigger-height":"var(--reka-popper-anchor-height)"};_n({position:s});const g=E(!1);return be(()=>{i.inputElement.value&&(g.value=d.value.contains(i.inputElement.value),g.value&&i.inputElement.value.focus())}),He(()=>{g.value&&i.triggerElement.value?.focus()}),(b,h)=>(p(),N(t(sn),{"as-child":""},{default:u(()=>[r(t(qa),{"as-child":"","disable-outside-pointer-events":b.disableOutsidePointerEvents,onDismiss:h[0]||(h[0]=y=>t(i).onOpenChange(!1)),onFocusOutside:h[1]||(h[1]=y=>{t(i).parentElement.value?.contains(y.target)&&y.preventDefault(),n("focusOutside",y)}),onInteractOutside:h[2]||(h[2]=y=>n("interactOutside",y)),onEscapeKeyDown:h[3]||(h[3]=y=>n("escapeKeyDown",y)),onPointerDownOutside:h[4]||(h[4]=y=>{t(i).parentElement.value?.contains(y.target)&&y.preventDefault(),n("pointerDownOutside",y)})},{default:u(()=>[(p(),N(el(t(s)==="popper"?t(Ua):t(_e)),fe({...b.$attrs,...t(B)},{id:t(i).contentId,ref:t(f),"data-state":t(i).open.value?"open":"closed",style:{display:"flex",flexDirection:"column",outline:"none",...t(s)==="popper"?_:{}}}),{default:u(()=>[ue(b.$slots,"default")]),_:3},16,["id","data-state","style"]))]),_:3},8,["disable-outside-pointer-events"])]),_:3}))}}),kn=xn,wn=Q({__name:"ComboboxContent",props:{forceMount:{type:Boolean,required:!1},position:{type:String,required:!1},bodyLock:{type:Boolean,required:!1},side:{type:null,required:!1},sideOffset:{type:Number,required:!1},sideFlip:{type:Boolean,required:!1},align:{type:null,required:!1},alignOffset:{type:Number,required:!1},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1},collisionBoundary:{type:null,required:!1},collisionPadding:{type:[Number,Object],required:!1},arrowPadding:{type:Number,required:!1},sticky:{type:String,required:!1},hideWhenDetached:{type:Boolean,required:!1},positionStrategy:{type:String,required:!1},updatePositionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(l,{emit:a}){const s=Pe(l,a),{forwardRef:i}=Ae(),f=Re();return f.contentId||=ze(void 0,"reka-combobox-content"),(d,m)=>(p(),N(t(Fa),{present:d.forceMount||t(f).open.value},{default:u(()=>[r(kn,fe({...t(s),...d.$attrs},{ref:t(i)}),{default:u(()=>[ue(d.$slots,"default")]),_:3},16)]),_:3},8,["present"]))}}),$n=wn,Cn=Q({__name:"ComboboxEmpty",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(l){const a=l,e=Re(),n=ne(()=>e.ignoreFilter.value?e.allItems.value.size===0:e.filterState.value.count===0);return(s,i)=>n.value?(p(),N(t(_e),dt(fe({key:0},a)),{default:u(()=>[ue(s.$slots,"default",{},()=>[i[0]||(i[0]=M("No options"))])]),_:3},16)):K("v-if",!0)}}),In=Cn;const[Xt,Vn]=Te("ComboboxGroup");var Sn=Q({__name:"ComboboxGroup",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(l){const a=l,e=ze(void 0,"reka-combobox-group"),n=Re(),s=ne(()=>n.ignoreFilter.value?!0:n.filterSearch.value?n.filterState.value.groups.has(e):!0),i=Vn({id:e,labelId:""});return be(()=>{n.allGroups.value.has(e)||n.allGroups.value.set(e,new Set)}),He(()=>{n.allGroups.value.delete(e)}),(f,d)=>(p(),N(t(pn),fe({id:t(e),"aria-labelledby":t(i).labelId},a,{hidden:s.value?void 0:!0}),{default:u(()=>[ue(f.$slots,"default")]),_:3},16,["id","aria-labelledby","hidden"]))}}),Tn=Sn,An=Q({__name:"ComboboxInput",props:{displayValue:{type:Function,required:!1},modelValue:{type:String,required:!1},autoFocus:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},emits:["update:modelValue"],setup(l,{emit:a}){const e=l,n=a,s=Re(),i=lt(),{primitiveElement:f,currentElement:d}=qe(),m=De(e,"modelValue",n,{passive:e.modelValue===void 0});be(()=>{d.value&&s.onInputElementChange(d.value)});function B(y){s.open.value||s.onOpenChange(!0)}function _(y){const x=y.target;s.open.value?s.filterSearch.value=x.value:(s.onOpenChange(!0),xe(()=>{x.value&&(s.filterSearch.value=x.value,i.highlightFirstItem())}))}function g(){s.openOnFocus.value&&!s.open.value&&s.onOpenChange(!0)}function b(){s.openOnClick.value&&!s.open.value&&s.onOpenChange(!0)}function h(){const y=s.modelValue.value;e.displayValue?m.value=e.displayValue(y):!s.multiple.value&&y&&!Array.isArray(y)&&typeof y!="object"?m.value=y.toString():m.value="",xe(()=>{m.value=m.value})}return s.onResetSearchTerm(()=>{h()}),he(s.modelValue,async()=>{!s.isUserInputted.value&&s.resetSearchTermOnSelect.value&&h()},{immediate:!0,deep:!0}),he(s.filterState,()=>{s.isVirtual.value||i.highlightFirstItem()}),(y,x)=>(p(),N(t(un),{ref_key:"primitiveElement",ref:f,modelValue:t(m),"onUpdate:modelValue":x[0]||(x[0]=U=>Me(m)?m.value=U:null),as:y.as,"as-child":y.asChild,"auto-focus":y.autoFocus,disabled:y.disabled,"aria-expanded":t(s).open.value,"aria-controls":t(s).contentId,"aria-autocomplete":"list",role:"combobox",autocomplete:"off",onClick:b,onInput:_,onKeydown:Ve(ve(B,["prevent"]),["down","up"]),onFocus:g},{default:u(()=>[ue(y.$slots,"default")]),_:3},8,["modelValue","as","as-child","auto-focus","disabled","aria-expanded","aria-controls","onKeydown"]))}}),Bn=An,En=Q({__name:"ComboboxItem",props:{textValue:{type:String,required:!1},value:{type:null,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(l,{emit:a}){const e=l,n=a,s=ze(void 0,"reka-combobox-item"),i=Re(),f=Xt(null),{primitiveElement:d,currentElement:m}=qe();if(e.value==="")throw new Error("A <ComboboxItem /> must have a value prop that is not an empty string. This is because the Combobox value can be set to an empty string to clear the selection and show the placeholder.");const B=ne(()=>{if(i.isVirtual.value||i.ignoreFilter.value||!i.filterSearch.value)return!0;{const _=i.filterState.value.items.get(s);return _===void 0?!0:_>0}});return be(()=>{i.allItems.value.set(s,e.textValue||m.value.textContent||m.value.innerText);const _=f?.id;_&&(i.allGroups.value.has(_)?i.allGroups.value.get(_)?.add(s):i.allGroups.value.set(_,new Set([s])))}),He(()=>{i.allItems.value.delete(s)}),(_,g)=>B.value?(p(),N(t(hn),fe({key:0},e,{id:t(s),ref_key:"primitiveElement",ref:d,disabled:t(i).disabled.value||_.disabled,onSelect:g[0]||(g[0]=b=>{n("select",b),!b.defaultPrevented&&!t(i).multiple.value&&!_.disabled&&!t(i).disabled.value&&(b.preventDefault(),t(i).onOpenChange(!1),t(i).modelValue.value=e.value)})}),{default:u(()=>[ue(_.$slots,"default",{},()=>[M(D(_.value),1)])]),_:3},16,["id","disabled"])):K("v-if",!0)}}),qn=En,Un=Q({__name:"ComboboxLabel",props:{for:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"div"}},setup(l){const a=l;Ae();const e=Xt({id:"",labelId:""});return e.labelId||=ze(void 0,"reka-combobox-group-label"),(n,s)=>(p(),N(t(_e),fe(a,{id:t(e).labelId}),{default:u(()=>[ue(n.$slots,"default")]),_:3},16,["id"]))}}),Fn=Un,Mn=Q({__name:"ComboboxPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(l){const a=l;return(e,n)=>(p(),N(t(Ma),dt(Mt(a)),{default:u(()=>[ue(e.$slots,"default")]),_:3},16))}}),Dn=Mn;const[xt,On]=Te("TagsInputRoot");var Ln=Q({__name:"TagsInputRoot",props:{modelValue:{type:[Array,null],required:!1},defaultValue:{type:Array,required:!1,default:()=>[]},addOnPaste:{type:Boolean,required:!1},addOnTab:{type:Boolean,required:!1},addOnBlur:{type:Boolean,required:!1},duplicate:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},delimiter:{type:null,required:!1,default:","},dir:{type:String,required:!1},max:{type:Number,required:!1,default:0},id:{type:String,required:!1},convertValue:{type:Function,required:!1},displayValue:{type:Function,required:!1,default:l=>l.toString()},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","invalid","addTag","removeTag"],setup(l,{emit:a}){const e=l,n=a,{addOnPaste:s,disabled:i,delimiter:f,max:d,id:m,dir:B,addOnBlur:_,addOnTab:g}=We(e),b=_t(B),h=De(e,"modelValue",n,{defaultValue:e.defaultValue,passive:!0,deep:!0}),{forwardRef:y,currentElement:x}=Ae(),{focused:U}=Da(x),$=Ht(x),{getItems:T,CollectionSlot:ie}=Ge({isProvider:!0}),F=E(),j=E(!1),de=ne(()=>Array.isArray(h.value)?[...h.value]:[]);function oe(X){if(X!==-1){const A=T().filter(I=>I.ref.dataset.disabled!=="");h.value=h.value.filter((I,S)=>S!==X),n("removeTag",A[X].value)}}return On({modelValue:h,onAddValue:X=>{const A=[...de.value],I=A.length>0&&typeof A[0]=="object",S=A.length>0&&typeof e.defaultValue[0]=="object";if((I||S)&&typeof e.convertValue!="function")throw new Error("You must provide a `convertValue` function when using objects as values.");const O=e.convertValue?e.convertValue(X):X;if(A.length>=d.value&&d.value)return n("invalid",O),!1;if(e.duplicate)return h.value=[...A,O],n("addTag",O),!0;if(A.includes(O))j.value=!0;else return h.value=[...A,O],n("addTag",O),!0;return n("invalid",O),!1},onRemoveValue:oe,onInputKeydown:X=>{const A=X.target,I=T().map(O=>O.ref).filter(O=>O.dataset.disabled!=="");if(!I.length)return;const S=I.at(-1);switch(X.key){case"Delete":case"Backspace":{if(A.selectionStart!==0||A.selectionEnd!==0)break;if(F.value){const O=I.findIndex(H=>H===F.value);oe(O),F.value=F.value===S?I.at(O-1):I.at(O+1),X.preventDefault()}else X.key==="Backspace"&&(F.value=S,X.preventDefault());break}case"Home":case"End":case"ArrowRight":case"ArrowLeft":{const O=X.key==="ArrowRight"&&b.value==="ltr"||X.key==="ArrowLeft"&&b.value==="rtl",H=!O;if(A.selectionStart!==0||A.selectionEnd!==0)break;if(H&&!F.value)F.value=S,X.preventDefault();else if(O&&S&&F.value===S)F.value=void 0,X.preventDefault();else if(F.value){const Y=ql(X,F.value,void 0,{itemsArray:I,loop:!1,dir:b.value});Y&&(F.value=Y),X.preventDefault()}break}case"ArrowUp":case"ArrowDown":{F.value&&X.preventDefault();break}default:F.value=void 0}},selectedElement:F,isInvalidInput:j,addOnPaste:s,addOnBlur:_,addOnTab:g,dir:b,disabled:i,delimiter:f,max:d,id:m,displayValue:e.displayValue}),(X,A)=>(p(),N(t(ie),null,{default:u(()=>[r(t(_e),{ref:t(y),dir:t(b),as:X.as,"as-child":X.asChild,"data-invalid":j.value?"":void 0,"data-disabled":t(i)?"":void 0,"data-focused":t(U)?"":void 0},{default:u(()=>[ue(X.$slots,"default",{modelValue:t(h)}),t($)&&X.name?(p(),N(t(Gt),{key:0,name:X.name,value:t(h),required:X.required,disabled:t(i)},null,8,["name","value","required","disabled"])):K("v-if",!0)]),_:3},8,["dir","as","as-child","data-invalid","data-disabled","data-focused"])]),_:3}))}}),Pn=Ln,zn=Q({__name:"TagsInputInput",props:{placeholder:{type:String,required:!1},autoFocus:{type:Boolean,required:!1},maxLength:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},setup(l){const a=l,e=xt(),{forwardRef:n,currentElement:s}=Ae();function i(h){if(e.selectedElement.value=void 0,!e.addOnBlur.value)return;const y=h.target;if(!y.value)return;e.onAddValue(y.value)&&(y.value="")}function f(h){e.addOnTab.value&&_(h)}const d=E(!1);function m(){d.value=!0}function B(){xe(()=>{d.value=!1})}async function _(h){if(d.value||(await xe(),h.defaultPrevented))return;const y=h.target;if(!y.value)return;e.onAddValue(y.value)&&(y.value=""),h.preventDefault()}function g(h){if(e.isInvalidInput.value=!1,h.data===null)return;const y=e.delimiter.value;if(y===h.data||y instanceof RegExp&&y.test(h.data)){const U=h.target;U.value=U.value.replace(y,""),e.onAddValue(U.value)&&(U.value="")}}function b(h){if(e.addOnPaste.value){h.preventDefault();const y=h.clipboardData;if(!y)return;const x=y.getData("text");e.delimiter.value?x.split(e.delimiter.value).forEach($=>{e.onAddValue($)}):e.onAddValue(x)}}return be(()=>{const h=s.value.nodeName==="INPUT"?s.value:s.value.querySelector("input");h&&setTimeout(()=>{a.autoFocus&&h?.focus()},1)}),(h,y)=>(p(),N(t(_e),{id:t(e).id?.value,ref:t(n),type:"text",autocomplete:"off",autocorrect:"off",autocapitalize:"off",as:h.as,"as-child":h.asChild,maxlength:h.maxLength,placeholder:h.placeholder,disabled:t(e).disabled.value,"data-invalid":t(e).isInvalidInput.value?"":void 0,onInput:g,onKeydown:[Ve(_,["enter"]),Ve(f,["tab"]),t(e).onInputKeydown],onBlur:i,onCompositionstart:m,onCompositionend:B,onPaste:b},{default:u(()=>[ue(h.$slots,"default")]),_:3},8,["id","as","as-child","maxlength","placeholder","disabled","data-invalid","onKeydown"]))}}),Rn=zn;const[Nn,jn]=Te("TagsInputItem");var Kn=Q({__name:"TagsInputItem",props:{value:{type:[String,Object],required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(l){const a=l,{value:e}=We(a),n=xt(),{forwardRef:s,currentElement:i}=Ae(),{CollectionItem:f}=Ge(),d=ne(()=>n.selectedElement.value===i.value),m=ne(()=>a.disabled||n.disabled.value),B=jn({value:e,isSelected:d,disabled:m,textId:"",displayValue:ne(()=>n.displayValue(e.value))});return(_,g)=>(p(),N(t(f),{value:t(e)},{default:u(()=>[r(t(_e),{ref:t(s),as:_.as,"as-child":_.asChild,"aria-labelledby":t(B).textId,"aria-current":d.value,"data-disabled":m.value?"":void 0,"data-state":d.value?"active":"inactive"},{default:u(()=>[ue(_.$slots,"default")]),_:3},8,["as","as-child","aria-labelledby","aria-current","data-disabled","data-state"])]),_:3},8,["value"]))}}),Hn=Kn,Wn=Q({__name:"TagsInputItemDelete",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(l){const a=l;Ae();const e=xt(),n=Nn(),s=ne(()=>n.disabled?.value||e.disabled.value);function i(){if(s.value)return;const f=e.modelValue.value.findIndex(d=>et(d,n.value.value));e.onRemoveValue(f)}return(f,d)=>(p(),N(t(_e),fe({tabindex:"-1"},a,{"aria-labelledby":t(n).textId,"aria-current":t(n).isSelected.value,"data-state":t(n).isSelected.value?"active":"inactive","data-disabled":s.value?"":void 0,type:f.as==="button"?"button":void 0,onClick:i}),{default:u(()=>[ue(f.$slots,"default")]),_:3},16,["aria-labelledby","aria-current","data-state","data-disabled","type"]))}}),Gn=Wn;const Xn=Q({__name:"DropdownMenuSub",props:{defaultOpen:{type:Boolean},open:{type:Boolean}},emits:["update:open"],setup(l,{emit:a}){const s=Et(l,a);return(i,f)=>(p(),N(t(xa),dt(Mt(t(s))),{default:u(()=>[ue(i.$slots,"default")]),_:3},16))}}),Yn=Q({__name:"DropdownMenuSubTrigger",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},setup(l){const a=l,e=ne(()=>{const{class:s,...i}=a;return i}),n=ka(e);return(s,i)=>(p(),N(t(wa),fe(t(n),{class:t(we)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-slate-100 data-[state=open]:bg-slate-100 dark:focus:bg-slate-800 dark:data-[state=open]:bg-slate-800",a.class)}),{default:u(()=>[ue(s.$slots,"default"),r(t(Sl),{class:"ml-auto h-4 w-4"})]),_:3},16,["class"]))}}),Qn=Q({__name:"DropdownMenuSubContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},sideOffset:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","entryFocus","openAutoFocus","closeAutoFocus"],setup(l,{emit:a}){const e=l,n=a,s=ne(()=>{const{class:f,...d}=e;return d}),i=Et(s,n);return(f,d)=>(p(),N(t($a),fe(t(i),{class:t(we)("z-50 min-w-32 overflow-hidden rounded-md border border-slate-200 bg-white p-1 text-slate-950 shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50",e.class)}),{default:u(()=>[ue(f.$slots,"default")]),_:3},16,["class"]))}}),Jn={class:"flex items-center w-full gap-1"},Zn={class:"w-full"},eo=["disabled"],to=Q({__name:"move",props:{taskId:{},columnId:{},label:{},columns:{}},emits:["update-task-column","task-moved"],setup(l,{emit:a}){const{$useApi:e}=Be(),n=l,s=E(n.columns?.length?n.columns.filter(_=>_.id!==n.columnId):[]),i=a;async function f(){if(!s.value.length)try{const{data:_}=await e.get(`tasks/${n.taskId}/avaliable-columns`);s.value=_}catch(_){console.log(_)}}async function d(_,g){i("update-task-column",{taskId:_,toColumnId:g})}const m=E(!1);async function B(){try{m.value=!0;const _=await e.patch(`/tasks/${n.taskId}/move-to-next-column`);i("task-moved",{taskId:n.taskId})}catch(_){console.error("Не удалось переместить задачу в следующую колонку",_)}finally{m.value=!1}}return be(f),(_,g)=>{const b=zt;return p(),w("div",Jn,[v("div",Zn,[r(b,{items:t(s).map(h=>({value:h.id,label:h.title})),class:"w-full grow overflow-hidden border-0","button-class":"bg-neutral-700 border-neutral-400/50 text-neutral-300 hover:bg-neutral-600 hover:text-neutral-300","list-class":"bg-neutral-400 text-neutral-600",label:_.label||"?",onSelectedItem:g[0]||(g[0]=h=>d(_.taskId,h))},null,8,["items","label"])]),_.label==="Переместить"?(p(),w("button",{key:0,class:"bg-neutral-700 w-10 p-1 cursor-pointer rounded-sm border-1 border-neutral-400/50 text-neutral-300 hover:bg-neutral-600 hover:text-neutral-300",disabled:t(m),title:"Переместить в следующую колонку",onClick:g[1]||(g[1]=h=>B())}," ➜ ",8,eo)):K("",!0)])}}});function Bt(l){const a=(l||"").toLowerCase();if(a.toLowerCase()==="улица")return{backgroundColor:"#FF6C00	",color:"#E3E3E3"};if(a.toLowerCase()==="очень срочно")return{backgroundColor:"hsl(0deg 70% 50%)",color:"#E3E3E3"};let e=5382;for(let f=0;f<a.length;f++)e=(e<<5)+e+a.charCodeAt(f),e|=0;const n=Math.abs(e)%360,s=40+Math.abs(e)%30,i=40+Math.abs(e)%10;return{backgroundColor:`hsl(${n}deg ${s}% ${i}%)`,color:"#FFFFFF"}}function Yt(l){const{$api:a,$useApi:e}=Be();function n(b){const h=b??(l?Ne(l):void 0);if(!h)throw new Error("Task ID is required");return Number(h)}async function s(b){const h=n(b),{data:y}=await e.get(`tasks/${h}`);return y}async function i(b,h){const y=n(h);return await a.$patch(`tasks/${y}`,b)}async function f(b){const h=n(b);return await a.$del(`tasks/${h}`)}async function d(b,h){const y=n(h);return await e.patch(`tasks/${y}/move`,b)}async function m(b,h){const y=n(h),{data:x}=await e.post(`/tasks/${y}/copy-to-board`,{boardId:b});return x}async function B(b,h){const y=n(h),{data:x}=await e.post(`/tasks/${y}/move-to-board`,{boardId:b});return x}async function _(b,h){const y=n(h);return await e.patch(`tasks/${y}/archived`,{archived:b})}async function g(b,h){const y=n(h);return await e.patch(`/tasks/${y}/cover`,{path:b})}return{getTask:s,updateTask:i,deleteTask:f,moveTask:d,copyToBoard:m,moveToBoard:B,setArchived:_,setCover:g}}function ao(l){const{$useApi:a}=Be(),e=E([]),n=E(!1),s=E(null),i=E({}),f=E({});let d=null;async function m(g){const b=Ne(l);if(!b)return;d?.abort(),d=new AbortController;const h=!!g?.silent;h||(n.value=!0,s.value=null);try{const{data:y}=await a.get(`tasks/${b}/members`,{signal:d.signal});e.value=Array.isArray(y)?y:[]}catch(y){y?.name!=="AbortError"&&(h||(s.value=y?.message||"Не удалось загрузить участников",e.value=[]))}finally{h||(n.value=!1)}}async function B(g){const b=Ne(l);if(!b||!g||i.value[g])return;if(i.value={...i.value,[g]:!0},e.value.some(y=>y.id===g)){i.value={...i.value,[g]:!1};return}const h=[...e.value];e.value=[...e.value,{id:g,fullName:`#${g}`,role:void 0}];try{await a.post(`tasks/${b}/members/${g}`),await m({silent:!0})}catch(y){throw e.value=h,y}finally{i.value={...i.value,[g]:!1}}}async function _(g){const b=Ne(l);if(!b||!g||f.value[g])return;f.value={...f.value,[g]:!0};const h=[...e.value];e.value=e.value.filter(y=>y.id!==g);try{await a.delete(`tasks/${b}/members/${g}`)}catch(y){throw e.value=h,y}finally{f.value={...f.value,[g]:!1}}}return he(()=>Ne(l),()=>{m()},{immediate:!0}),tl(()=>d?.abort()),{members:e,loading:n,error:s,refresh:m,addMember:B,removeMember:_,adding:i,removing:f}}const lo={class:"flex items-center bg-neutral-600/50 p-2 rounded-sm gap-2 flex-wrap"},no={key:0,class:"text-xs text-neutral-500"},oo={key:1,class:"text-xs text-red-500"},so={key:2,class:"flex gap-2 flex-wrap mt-2"},ro={class:""},io={key:0,class:"absolute -top-1 -right-1"},uo=Q({__name:"MembersPanel",props:{taskId:{},actions:{type:Boolean}},setup(l){const{$useApi:a}=Be(),e=l,n=E([]),s=ne(()=>Number(e.taskId)||null),{members:i,loading:f,error:d,removeMember:m,removing:B,addMember:_}=ao(s);function g(x){return!!B.value[x]}async function b(){try{const{data:x}=await a.get(`tasks/${e.taskId}/avaliable-members`);n.value=x}catch(x){console.log(x)}}const h=E(0);async function y(x){await _(x),h.value++}return(x,U)=>{const $=ut,T=Le,ie=zt;return p(),w("div",lo,[t(f)?(p(),w("div",no," Загрузка участников… ")):t(d)?(p(),w("div",oo,D(t(d)),1)):(p(),w("div",so,[(p(!0),w(pe,null,me(t(i),F=>(p(),w("div",{key:F.id,class:"relative"},[v("div",ro,[r($,{"full-name":F.fullName,"role-name":F.role?.fullName,"avatar-url":F.avatarUrl,dark:!0,hover:!0,size:"lg"},null,8,["full-name","role-name","avatar-url"])]),x.actions?(p(),w("div",io,[r(T,{size:"sm",variant:"outline",class:Ie("bg-neutral-300/50 p-0 rounded-full h-4 w-4 flex items-center justify-center"),disabled:g(F.id),onClick:j=>t(m)(F.id)},{default:u(()=>U[1]||(U[1]=[M(" X ",-1)])),_:2,__:[1]},1032,["disabled","onClick"])])):K("",!0)]))),128)),(p(),N(ie,{key:t(h),items:t(n).map(F=>({value:F.id,label:F.fullName})),"button-class":"bg-neutral-700 border-neutral-400/50 text-neutral-300 hover:bg-neutral-600 hover:text-neutral-300 rounded-full h-10 w-10 p-0 flex items-center justify-center","list-class":"bg-neutral-400 text-neutral-600",label:"+",onSelectedItem:U[0]||(U[0]=F=>y(F)),onClick:b},null,8,["items"]))]))])}}}),co=Q({__name:"Combobox",props:{open:{type:Boolean},defaultOpen:{type:Boolean},resetSearchTermOnBlur:{type:Boolean},resetSearchTermOnSelect:{type:Boolean},openOnFocus:{type:Boolean},openOnClick:{type:Boolean},ignoreFilter:{type:Boolean},modelValue:{},defaultValue:{},multiple:{type:Boolean},dir:{},disabled:{type:Boolean},highlightOnHover:{type:Boolean},by:{type:[String,Function]},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean}},emits:["update:modelValue","highlight","update:open"],setup(l,{emit:a}){const s=Pe(l,a);return(i,f)=>(p(),N(t(bn),fe({"data-slot":"combobox"},t(s)),{default:u(()=>[ue(i.$slots,"default")]),_:3},16))}}),po=Q({__name:"ComboboxAnchor",props:{reference:{},asChild:{type:Boolean},as:{},class:{}},setup(l){const a=l,e=Se(a,"class"),n=Ke(e);return(s,i)=>(p(),N(t(en),fe({"data-slot":"combobox-anchor"},t(n),{class:t(we)("w-[200px]",a.class)}),{default:u(()=>[ue(s.$slots,"default")]),_:3},16,["class"]))}}),fo=Q({__name:"ComboboxEmpty",props:{asChild:{type:Boolean},as:{},class:{}},setup(l){const a=l,e=Se(a,"class");return(n,s)=>(p(),N(t(In),fe({"data-slot":"combobox-empty"},t(e),{class:t(we)("py-6 text-center text-sm",a.class)}),{default:u(()=>[ue(n.$slots,"default")]),_:3},16,["class"]))}}),mo=Q({__name:"ComboboxGroup",props:{asChild:{type:Boolean},as:{},class:{},heading:{}},setup(l){const a=l,e=Se(a,"class");return(n,s)=>(p(),N(t(Tn),fe({"data-slot":"combobox-group"},t(e),{class:t(we)("overflow-hidden p-1 text-foreground",a.class)}),{default:u(()=>[n.heading?(p(),N(t(Fn),{key:0,class:"px-2 py-1.5 text-xs font-medium text-muted-foreground"},{default:u(()=>[M(D(n.heading),1)]),_:1})):K("",!0),ue(n.$slots,"default")]),_:3},16,["class"]))}}),vo={"data-slot":"command-input-wrapper",class:"flex h-9 items-center gap-2 border-b px-3 w-full"},ho=Q({inheritAttrs:!1,__name:"ComboboxInput",props:{displayValue:{type:Function},modelValue:{},autoFocus:{type:Boolean},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue"],setup(l,{emit:a}){const e=l,n=a,s=Se(e,"class"),i=Pe(s,n);return(f,d)=>(p(),w("div",vo,[r(t(fl),{class:"size-4 shrink-0 opacity-50"}),r(t(Bn),fe({"data-slot":"command-input",class:t(we)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-2 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e.class)},{...t(i),...f.$attrs}),{default:u(()=>[ue(f.$slots,"default")]),_:3},16,["class"])]))}}),go=Q({__name:"ComboboxItem",props:{textValue:{},value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["select"],setup(l,{emit:a}){const e=l,n=a,s=Se(e,"class"),i=Pe(s,n);return(f,d)=>(p(),N(t(qn),fe({"data-slot":"combobox-item"},t(i),{class:t(we)("data-[highlighted]:bg-accent data-[highlighted]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e.class)}),{default:u(()=>[ue(f.$slots,"default")]),_:3},16,["class"]))}}),yo=Q({__name:"ComboboxList",props:{forceMount:{type:Boolean},position:{default:"popper"},bodyLock:{type:Boolean},side:{},sideOffset:{default:4},sideFlip:{type:Boolean},align:{default:"center"},alignOffset:{},alignFlip:{type:Boolean},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside"],setup(l,{emit:a}){const e=l,n=a,s=Se(e,"class"),i=Pe(s,n);return(f,d)=>(p(),N(t(Dn),null,{default:u(()=>[r(t($n),fe({"data-slot":"combobox-list"},t(i),{class:t(we)("z-50 w-[200px] rounded-md border bg-popover text-popover-foreground origin-(--reka-combobox-content-transform-origin) overflow-hidden shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e.class)}),{default:u(()=>[ue(f.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),bo=Q({__name:"TagsInput",props:{modelValue:{},defaultValue:{},addOnPaste:{type:Boolean},addOnTab:{type:Boolean},addOnBlur:{type:Boolean},duplicate:{type:Boolean},disabled:{type:Boolean},delimiter:{},dir:{},max:{},id:{},convertValue:{type:Function},displayValue:{type:Function},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue","invalid","addTag","removeTag"],setup(l,{emit:a}){const e=l,n=a,s=Se(e,"class"),i=Pe(s,n);return(f,d)=>(p(),N(t(Pn),fe(t(i),{class:t(we)("flex flex-col gap-2 items-start rounded-md border border-input bg-background px-3 py-1.5 text-sm",e.class)}),{default:u(()=>[ue(f.$slots,"default")]),_:3},16,["class"]))}}),_o=Q({__name:"TagsInputInput",props:{placeholder:{},autoFocus:{type:Boolean},maxLength:{},asChild:{type:Boolean},as:{},class:{}},setup(l){const a=l,e=Se(a,"class"),n=Ke(e);return(s,i)=>(p(),N(t(Rn),fe(t(n),{class:t(we)("text-sm min-h-5 focus:outline-none flex-1 bg-transparent px-1",a.class)}),null,16,["class"]))}}),xo=Q({__name:"TagsInputItem",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(l){const a=l,e=Se(a,"class"),n=Ke(e);return(s,i)=>(p(),N(t(Hn),fe(t(n),{class:t(we)("flex h-5 items-center rounded-md bg-secondary data-[state=active]:ring-ring data-[state=active]:ring-2 data-[state=active]:ring-offset-2 ring-offset-background",a.class)}),{default:u(()=>[ue(s.$slots,"default")]),_:3},16,["class"]))}}),ko=Q({__name:"TagsInputItemDelete",props:{asChild:{type:Boolean},as:{},class:{}},setup(l){const a=l,e=Se(a,"class"),n=Ke(e);return(s,i)=>(p(),N(t(Gn),fe(t(n),{class:t(we)("flex rounded bg-transparent mr-1",a.class)}),{default:u(()=>[ue(s.$slots,"default",{},()=>[r(t(Ze),{class:"w-4 h-4"})])]),_:3},16,["class"]))}}),wo={class:"flex gap-2 flex-wrap items-center"},$o={class:"px-1 text-sm"},Co={key:0},Io={key:1},Vo={key:2},So={class:"flex items-center gap-2 p-2"},To=Q({__name:"TagsInput",props:st({boardId:{},taskId:{},initialSelected:{},warnings:{}},{modelValue:{default:[]},modelModifiers:{}}),emits:st(["update"],["update:modelValue"]),setup(l,{emit:a}){const{$api:e}=Be(),n=a,s=Dt(l,"modelValue"),i=l,f=E([]),d=E(!1),m=E(""),B=E(!1),_=E(null),g=E(""),b=E(!1),h=E(null),{contains:y}=Kt({sensitivity:"base"}),x=ne({get(){return s.value.map(I=>String(I.id))},set(I){const S=new Map(f.value.map(O=>[O.value,O.label]));s.value=I.map(O=>{const H=Number(O);return{id:H,name:S.get(H)??O}})}}),U=ne(()=>{const I=new Set(x.value),S=f.value.filter(O=>!I.has(String(O.value)));return m.value?S.filter(O=>y(O.label,m.value)):S});function $(){d.value=!0}const T=I=>{const S=Number(I);return f.value.find(O=>O.value===S)?.label??I};async function ie(){try{B.value=!0,_.value=null;const I=await e?.$get?.(`boards/${i.boardId}/tags`)??await e.$get(`boards/${i.boardId}/tags`),S=Array.isArray(I)?I:I?.data;f.value=(S??[]).map(O=>{const H=O?.name??O?.label??String(O?.id??""),Y=Number(O?.id);return Number.isFinite(Y)?{value:Y,label:H}:null}).filter(Boolean)}catch(I){_.value=I?.message||"Не удалось загрузить теги",f.value=[]}finally{B.value=!1}}async function F(){try{await e.$post(`tasks/${i.taskId}/tags`,{tags:s.value.map(I=>I.name)}),n("update",s.value)}catch(I){console.error("Failed to save task tags",I)}}function j(I){const S=I?.detail?.value;S&&(x.value.includes(S)||(x.value=[...x.value,S]),m.value="",U.value.length===0&&(d.value=!1))}async function de(I){x.value=x.value.filter(S=>S!==I)}async function oe(){const I=g.value.trim();if(I)try{b.value=!0,h.value=null;const S=await e?.$post?.(`boards/${i.boardId}/tags`,{name:I})??await e.$post(`boards/${i.boardId}/tags`,{name:I}),O=S?.data??S,H=Number(O?.id),Y=String(O?.name??I);Number.isFinite(H)&&!f.value.some(V=>V.value===H)&&f.value.push({value:H,label:Y}),Number.isFinite(H)&&!x.value.includes(String(H))&&(x.value=[...x.value,String(H)]),g.value="",d.value=!1}catch(S){h.value=S?.response?.data?.message||S?.message||"Не удалось создать метку"}finally{b.value=!1}}const X=E(!1),A=pl(()=>F(),200);return he(x,()=>{X.value&&A()}),be(async()=>{if(await ie(),i.initialSelected?.length&&s.value.length===0){const I=new Map(f.value.map(S=>[S.label,S.value]));s.value=i.initialSelected.map(S=>{const O=I.get(S);return Number.isFinite(O)?{id:O,name:S}:null}).filter(Boolean)}X.value=!0}),(I,S)=>{const O=tt,H=Le,Y=Ut;return p(),w("div",null,[r(t(co),{modelValue:x.value,"onUpdate:modelValue":S[5]||(S[5]=V=>x.value=V),open:d.value,"onUpdate:open":S[6]||(S[6]=V=>d.value=V),"ignore-filter":!0},{default:u(()=>[r(t(po),{"as-child":""},{default:u(()=>[r(t(bo),{modelValue:x.value,"onUpdate:modelValue":S[3]||(S[3]=V=>x.value=V),class:"px-2 pt-3 gap-2 w-full bg-neutral-700 text-neutral-300 border-neutral-500/50",onClick:$},{default:u(()=>[v("div",wo,[(p(!0),w(pe,null,me(I.warnings,(V,o)=>(p(),w("span",{key:o,class:"inline-flex items-center rounded-full px-2 py-0.5 text-xs",style:rt(("useStyleFromText"in I?I.useStyleFromText:t(Bt))(V))}," ! "+D(V)+" ! ",5))),128)),(p(!0),w(pe,null,me(x.value,V=>(p(),N(t(xo),{key:V,value:V,class:Ie("text-neutral-600 bg-neutral-300 "),style:rt(("useStyleFromText"in I?I.useStyleFromText:t(Bt))(T(V))),onKeydown:S[0]||(S[0]=ve(()=>{},["stop"]))},{default:u(()=>[v("span",$o,D(T(V)),1),r(t(ko),{onClick:ve(o=>de(V),["prevent","stop"])},null,8,["onClick"])]),_:2},1032,["value","style"]))),128))]),r(t(ho),{modelValue:m.value,"onUpdate:modelValue":S[2]||(S[2]=V=>m.value=V),"as-child":""},{default:u(()=>[r(t(_o),{placeholder:"Добавить...",class:"w-full flex p-0 border-none focus-visible:ring-0 h-auto placeholder:text-neutral-500 bg-neutral-700 text-neutral-300 border-neutral-500/50",onKeydown:S[1]||(S[1]=Ve(ve(()=>{},["prevent"]),["enter"])),onClick:$})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),r(t(yo),{class:"w-full border-neutral-500/50 bg-neutral-700 text-neutral-300"},{default:u(()=>[r(t(fo),null,{default:u(()=>[B.value?(p(),w("span",Co,"Загрузка…")):_.value?(p(),w("span",Io,D(_.value),1)):(p(),w("span",Vo,"Ничего не найдено"))]),_:1}),v("div",So,[r(O,{modelValue:g.value,"onUpdate:modelValue":S[4]||(S[4]=V=>g.value=V),placeholder:"Название метки",class:"bg-neutral-700 text-neutral-300 border-neutral-500/50 placeholder:text-neutral-500",onKeydown:Ve(ve(oe,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),r(H,{class:"text-neutral-300 bg-neutral-600 hover:bg-neutral-600/50",disabled:!g.value.trim()||b.value,onClick:oe},{default:u(()=>[M(D(b.value?"Создаём…":"Создать новый"),1)]),_:1},8,["disabled"])]),r(Y,{class:"h-[300px]"},{default:u(()=>[U.value.length?(p(),N(t(mo),{key:0},{default:u(()=>[(p(!0),w(pe,null,me(U.value,V=>(p(),N(t(go),{key:V.value,value:V.value,class:"text-neutral-300",onSelect:ve(j,["prevent"])},{default:u(()=>[M(D(V.label),1)]),_:2},1032,["value"]))),128))]),_:1})):K("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","open"])])}}}),Ao={class:"flex items-start gap-2 mb-4 w-full"},Bo={class:"flex items-center gap-2 flex-wrap"},Eo={class:"ml-auto flex gap-2"},qo={key:0,class:"mb-2 text-sm text-neutral-400"},Uo={key:1,class:"mb-2 text-sm text-red-400"},Fo={key:2,class:"mb-2 text-sm text-emerald-400"},Mo={key:3,class:"flex flex-col gap-4"},Do={class:"flex flex-col gap-2"},Oo={class:"flex gap-2 items-center"},Lo={class:"flex gap-2 items-center"},Po={class:"flex gap-2 items-center"},zo={class:"flex gap-2 items-center"},Ro={class:"flex gap-2 flex-col"},No=Q({__name:"Delivery",props:{taskId:{},initialDeliveries:{}},emits:["changed"],setup(l,{emit:a}){const{$useApi:e}=Be(),n=l,s=a,i=["СДЕК","ПОЧТА РОССИИ","Яндекс","Балтийский курьер","Самовывоз","ТК КИТ","ПЭТ","Боксбери","Деловые линии"],f=["Платно","Бесплатно","Досыл"],d=Oe([]),m=E(0),B=E(!1),_=E(!1),g=E(null),b=E(null);function h(){return{method:i[0],type:f[0],price:0,track:"",description:""}}function y(A){return{method:A.method??i[0],type:A.type??f[0],price:Number(A.price??0),track:A.track??"",description:A.description??""}}function x(A,I={}){const{source:S="props",resetMessages:O=!1}=I,H=ie(A);if(S==="props"&&H.length===0&&d.some(V=>V.id!=null)){O&&(g.value=null,b.value=null);return}const Y=H.map(V=>({id:V.id??null,form:y(V)}));d.splice(0,d.length,...Y),d.length||d.push({id:null,form:h()}),m.value=Math.min(m.value,d.length-1),m.value<0&&(m.value=0),O&&(g.value=null,b.value=null)}const U=ne(()=>d[m.value]??d[0]);function $(A){if(A==null)return;const I=d.findIndex(S=>S.id===A);I>=0&&(m.value=I)}he(()=>n.initialDeliveries,A=>{const I=d[m.value]?.id??null;x(A??[],{source:"props"}),I!=null&&$(I)},{immediate:!0,deep:!0});const T=E(!1);function ie(A){return Array.isArray(A)?A:Array.isArray(A?.data)?A.data:Array.isArray(A?.data?.data)?A.data.data:Array.isArray(A?.data?.deliveries)?A.data.deliveries:Array.isArray(A?.deliveries)?A.deliveries:Array.isArray(A?.data?.data?.deliveries)?A.data.data.deliveries:Array.isArray(A?.data?.deliveries?.data)?A.data.deliveries.data:Array.isArray(A?.deliveries?.data)?A.deliveries.data:Array.isArray(A?.data?.data?.data)?A.data.data.data:[]}async function F(A){if(!n.taskId){x([],{source:"api",resetMessages:!0});return}try{T.value=!0,g.value=null;const I=d[m.value]?.id??null,S=await e.get(`/tasks/${n.taskId}/deliveries`),O=S?.data??S;x(O,{source:"api"});const H=typeof A=="number"&&A!=null?A:I;H!=null?$(H):m.value=Math.min(m.value,Math.max(d.length-1,0))}catch(I){console.error("fetch deliveries failed",I),g.value="Не удалось загрузить доставки"}finally{T.value=!1}}be(()=>{F()}),he(()=>n.taskId,()=>{x([],{source:"api",resetMessages:!0}),F()});function j(A){return A.id?`${A.form.method}`:`${A.form.method}`}function de(){d.push({id:null,form:h()}),m.value=d.length-1,b.value=null,g.value=null}async function oe(A){const I=d[A];if(!(!I||_.value)){if(d.length===1){if(I.id)try{_.value=!0,await e.delete(`/deliveries/${I.id}`),await F(),s("changed"),b.value="Доставка удалена",setTimeout(()=>b.value=null,2500)}catch(S){console.error("delete delivery failed",S),g.value="Не удалось удалить доставку";return}finally{_.value=!1}I.id=null,Object.assign(I.form,h()),b.value=null,g.value=null;return}if(I.id)try{_.value=!0,await e.delete(`/deliveries/${I.id}`),await F(),s("changed"),b.value="Доставка удалена",setTimeout(()=>b.value=null,2500);return}catch(S){console.error("delete delivery failed",S),g.value="Не удалось удалить доставку";return}finally{_.value=!1}d.splice(A,1),d.length||d.push({id:null,form:h()}),m.value=Math.min(A,d.length-1),g.value=null,b.value=null}}async function X(){const A=U.value;if(!A||B.value)return;const I={taskId:n.taskId,method:A.form.method,type:A.form.type,price:Number.isFinite(A.form.price)?Number(A.form.price):0,track:A.form.track?.trim()??"",description:A.form.description?.trim()??""};try{B.value=!0,g.value=null,b.value=null;let S=A.id??null;if(A.id)await e.patch(`/deliveries/${A.id}`,{...I});else{const O=await e.post(`/tasks/${n.taskId}/deliveries`,{...I}),H=O?.data??O;H?.id&&(A.id=H.id,S=H.id)}await F(S),b.value="Доставка сохранена",s("changed"),setTimeout(()=>b.value=null,2500)}catch(S){console.error("save delivery failed",S),g.value="Не удалось сохранить доставку"}finally{B.value=!1}}return(A,I)=>{const S=Le,O=pt,H=vt,Y=mt,V=gt,o=yt,R=ht,q=ft,ae=tt,ce=bt;return p(),w("div",null,[v("div",Ao,[v("div",Bo,[(p(!0),w(pe,null,me(d,(se,ge)=>(p(),N(S,{key:se.id??`new-${ge}`,variant:ge===m.value?"default":"secondary",size:"sm",class:"bg-neutral-800 text-neutral-300 border border-neutral-600 data-[active=true]:bg-neutral-600 data-[active=true]:text-white","data-active":ge===m.value,onClick:ye=>m.value=ge},{default:u(()=>[M(D(j(se)),1)]),_:2},1032,["variant","data-active","onClick"]))),128)),r(S,{variant:"secondary",size:"sm",class:"text-neutral-300 bg-neutral-700/50 hover:bg-neutral-600/50",onClick:de},{default:u(()=>I[6]||(I[6]=[M(" + Доставка ",-1)])),_:1,__:[6]})]),v("div",Eo,[d.length&&(d[m.value]?.id||d.length>1)?(p(),N(S,{key:0,variant:"secondary",size:"sm",class:"text-red-300 bg-red-900/40 hover:bg-red-900/60",disabled:_.value||T.value,onClick:I[0]||(I[0]=se=>oe(m.value))},{default:u(()=>[M(D(_.value?"Удаляем…":"Удалить"),1)]),_:1},8,["disabled"])):K("",!0),r(S,{disabled:B.value||T.value,size:"sm",class:"text-neutral-300 bg-neutral-600 hover:bg-neutral-600/50",onClick:X},{default:u(()=>[M(D(B.value?"Сохраняем…":"Сохранить"),1)]),_:1},8,["disabled"])])]),T.value?(p(),w("div",qo," Загружаем доставки… ")):K("",!0),g.value?(p(),w("div",Uo,D(g.value),1)):K("",!0),b.value?(p(),w("div",Fo,D(b.value),1)):K("",!0),U.value?(p(),w("div",Mo,[v("div",Do,[v("div",Oo,[r(O,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>I[7]||(I[7]=[M(" Способ: ",-1)])),_:1,__:[7]}),r(q,{modelValue:U.value.form.method,"onUpdate:modelValue":I[1]||(I[1]=se=>U.value.form.method=se),class:"flex-1 min-w-[200px]"},{default:u(()=>[r(Y,{class:"h-8 bg-neutral-800 text-neutral-300 border-neutral-500/20"},{default:u(()=>[r(H)]),_:1}),r(R,{class:"bg-neutral-800 text-neutral-300"},{default:u(()=>[(p(),w(pe,null,me(i,se=>r(o,{key:se},{default:u(()=>[r(V,{value:se},{default:u(()=>[M(D(se),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),v("div",Lo,[r(O,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>I[8]||(I[8]=[M(" Тип: ",-1)])),_:1,__:[8]}),r(q,{modelValue:U.value.form.type,"onUpdate:modelValue":I[2]||(I[2]=se=>U.value.form.type=se),class:"flex-1 min-w-[180px]"},{default:u(()=>[r(Y,{class:"h-8 bg-neutral-800 text-neutral-300 border-neutral-500/20"},{default:u(()=>[r(H)]),_:1}),r(R,{class:"bg-neutral-800 text-neutral-300"},{default:u(()=>[(p(),w(pe,null,me(f,se=>r(o,{key:se},{default:u(()=>[r(V,{value:se},{default:u(()=>[M(D(se),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),v("div",Po,[r(O,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>I[9]||(I[9]=[M(" Стоимость: ",-1)])),_:1,__:[9]}),r(ae,{modelValue:U.value.form.price,"onUpdate:modelValue":I[3]||(I[3]=se=>U.value.form.price=se),modelModifiers:{number:!0},type:"number",min:"0",class:"h-8 flex-1 bg-neutral-800 text-neutral-300 border-neutral-500/20"},null,8,["modelValue"])]),v("div",zo,[r(O,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>I[10]||(I[10]=[M(" Трек: ",-1)])),_:1,__:[10]}),r(ae,{modelValue:U.value.form.track,"onUpdate:modelValue":I[4]||(I[4]=se=>U.value.form.track=se),class:"h-8 flex-1 bg-neutral-800 text-neutral-300 border-neutral-500/20",placeholder:"Номер отслеживания"},null,8,["modelValue"])])]),v("div",Ro,[r(O,{class:"font-medium flex text-neutral-400 pt-1"},{default:u(()=>I[11]||(I[11]=[M(" Доп. информация: ",-1)])),_:1,__:[11]}),r(ce,{modelValue:U.value.form.description,"onUpdate:modelValue":I[5]||(I[5]=se=>U.value.form.description=se),placeholder:"Комментарий к доставке",class:"flex-1 bg-neutral-800 text-neutral-300 border-neutral-500/20",rows:"4"},null,8,["modelValue"])])])):K("",!0)])}}}),jo={class:"flex items-start gap-2 mb-4 w-full"},Ko={class:"flex items-center gap-2 flex-wrap"},Ho={class:"ml-auto"},Wo={class:"flex flex-col gap-2"},Go={class:"flex gap-2"},Xo={key:0,class:"text-red-500"},Yo={class:"flex gap-2"},Qo={key:0,class:"text-red-500"},Jo={class:"flex flex-col gap-2"},Zo={class:"flex gap-2"},es={key:0,class:"text-red-500"},ts={class:"flex gap-2"},as={key:0,class:"text-red-500"},ls={class:"flex gap-2"},ns={key:0,class:"text-red-500"},os=["onClick"],ss={class:"flex flex-col gap-2"},rs={class:"flex gap-2"},is={class:"flex gap-2"},us={class:"flex gap-2"},ds={key:0,class:"text-red-500"},cs={class:"flex flex-col gap-2"},ps={class:"flex gap-2"},fs={key:0,class:"text-red-500"},ms={class:"flex gap-2"},vs={key:0,class:"text-red-500"},hs={key:0,class:"flex gap-2 text-neutral-400 items-center"},gs={class:"font-medium text-neutral-300"},ys={class:"flex gap-2"},bs={class:"col-span-2 text-sm text-neutral-300"},_s={key:0,class:"text-red-500"},xs={class:"col-span-2 flex flex-col gap-1"},ks={key:0,class:"text-red-500"},ws={class:"flex h-6 items-center text-neutral-300 bg-neutral-800 border-1 border-neutral-500/20 rounded-sm"},$s=["onClick"],Cs={class:"flex gap-2 items-center"},Is={class:"w-full"},Vs={key:0,class:"text-red-500"},Ss={key:0,class:"text-red-500"},Ts={class:"min-w-[80px]"},As={key:0,class:"text-red-500"},Bs={key:0,class:"text-red-500"},Es={class:"flex h-6 items-center text-neutral-300 bg-neutral-800 border-1 border-neutral-500/20 rounded-sm"},qs=["onClick"],Us={class:"flex gap-2 items-center"},Fs={class:"w-full"},Ms={key:0,class:"text-red-500"},Ds={key:0,class:"text-red-500"},Os={class:"min-w-[80px]"},Ls={key:0,class:"text-red-500"},Ps={class:"flex flex-col gap-2"},zs={class:"flex gap-2"},Rs={key:0,class:"text-red-500"},Ns={class:"flex gap-2"},js={key:0,class:"text-red-500"},Ks=["onClick"],Hs={class:"flex gap-2"},Ws={key:0,class:"text-red-500"},Gs={class:"flex gap-2"},Xs={key:0,class:"text-red-500"},Ys=["onClick"],Qs={class:"flex gap-2"},Js={class:"flex gap-2"},Zs={class:"flex gap-2"},er={class:"flex gap-2"},tr={class:"flex gap-2"},ar={class:"flex gap-2"},lr={class:"flex flex-col my-6 gap-2"},nr={key:0,class:"text-sm text-red-500 mt-3 mb-6"},or=Q({__name:"TaskOrder",props:{taskId:{}},setup(l,{expose:a}){const{$api:e}=Be(),n=l,s=["6мм","9мм","Нет"],i=["Помещение","Уличный","Нет"],f=["Помещение","Улица"],d=["Держатели стальные","Держатели золотые","Держатели черные","Крепления для окна","Шуруп + дюбель","Присоски","Нет"],m=["красный","синий","голубой","оранжевый","фиолетовый","розовый","бирюзовый","желтый","зеленый","холодный белый","теплый белый","смарт","rgb"],B=["6мм","8мм"];Oe({title:"",deadline:"",material:"",boardWidth:0,boardHeight:0,holeType:"",stand:!1,laminate:"",print:!1,printQuality:!1,acrylic:"Нет",type:"",wireLength:"",elements:0,gift:!1,adapter:"",plug:"",switch:!0,fitting:"",dimmer:!1,giftPack:!1,description:"",neons:[],lightings:[],docs:!1});const _=E(null),g=E([]),b=E(!1),h=E(null),y=E(null),x=Oe([]),U=E(0),$=ne(()=>x[U.value]??{id:null,form:F()}),T=ne(()=>{try{return($.value?.form?.neons??[]).reduce((R,q)=>{const ae=q?.length??0,ce=typeof ae=="number"?ae:parseFloat(String(ae).replace(",","."))||0;return R+ce},0)}catch{return 0}});function ie(V,o){const R=(V.form.title??"").trim();return R||`Вывеска ${o+1}`}function F(){return{title:"",deadline:"",material:"",boardWidth:0,boardHeight:0,holeType:"",stand:!1,laminate:"",print:!1,printQuality:!1,acrylic:"Нет",type:"",wireLength:"",elements:0,gift:!1,adapter:"",plug:"",switch:!0,fitting:"",dimmer:!1,giftPack:!1,description:"",neons:[],lightings:[],docs:!1}}function j(V){return{title:V?.title??"",deadline:V?.deadline??"",material:V?.material??"",boardWidth:Number(V?.boardWidth??0),boardHeight:Number(V?.boardHeight??0),holeType:V?.holeType??"",stand:!!V?.stand,laminate:V?.laminate??"",print:!!V?.print,printQuality:!!V?.printQuality,acrylic:V?.acrylic??"",type:V?.type??"",wireLength:V?.wireLength??"",elements:Number(V?.elements??0),gift:!!V?.gift,adapter:V?.adapter??"",plug:V?.plug??"",switch:!!V?.switch,fitting:V?.fitting??"",dimmer:!!V?.dimmer,giftPack:!!V?.giftPack,description:V?.description??"",docs:!!V?.docs,neons:Array.isArray(V?.neons)?V.neons.map(o=>({id:o.id,width:o.width??"6мм",length:Number(o.length??0),color:o.color??""})):[],lightings:Array.isArray(V?.lightings)?V.lightings.map(o=>({id:o.id,length:Number(o.length??0),color:o.color??"",elements:Number(o.elements??0)})):[]}}async function de(){try{h.value=null;const V=x[U.value]?.id??null,o=await e.$get?.(`tasks/${n.taskId}/orders`),R=Array.isArray(o)?o:o?.data,q=Array.isArray(R)?R:[];g.value=q.map(se=>({id:se.id,title:se.title??`Заказ #${se.id}`})),x.splice(0,x.length,...q.map(se=>({id:se.id??null,form:j(se)}))),x.length===0&&x.push({id:null,form:F()});const ae=V??x[0]?.id??null,ce=x.findIndex(se=>se.id===ae);U.value=ce>=0?ce:0,_.value=x[U.value]?.id??null,y.value=null}catch(V){h.value=V?.response?.data?.message||V?.message||"Не удалось загрузить заказы",x.splice(0,x.length,{id:null,form:F()}),U.value=0}}function oe(){$.value.form.neons.push({width:"6мм",length:0,color:""})}function X(V){$.value.form.neons.splice(V,1)}function A(){$.value.form.lightings.push({length:0,color:"",elements:0})}function I(V){$.value.form.lightings.splice(V,1)}function S(){x.push({id:null,form:F()}),U.value=x.length-1,y.value=null,h.value=null}async function O(){if(x?.length){b.value=!0,h.value=null,y.value=null;try{const V=x.map(q=>({id:q.id,form:q.form})),o=[];for(const q of V)try{if(q.id==null){const ae=await e.$post?.(`tasks/${n.taskId}/orders`,q.form);o.push({ok:!0,id:ae?.data?.id??ae?.id??null})}else await e.$patch?.(`tasks/orders/${q.id}`,q.form),o.push({ok:!0,id:q.id})}catch(ae){o.push({ok:!1,id:q.id??null,err:ae?.response?.data?.message||ae?.message||"Ошибка сохранения заказа"})}await de();const R=o.filter(q=>!q.ok);R.length?h.value=`Не удалось сохранить ${R.length} из ${o.length}: ${R.map(q=>q.err).join("; ")}`:y.value=`Сохранены все ${o.length} заказ(ов)`}finally{b.value=!1}}}async function H(V){const o=x[V];if(o){b.value=!0,h.value=null,y.value=null;try{const R=o.id;if(o.id==null){const ce=await e.$post?.(`tasks/${n.taskId}/orders`,o.form);o.id=ce?.data?.id??ce?.id??null,y.value="Заказ создан"}else await e.$patch?.(`tasks/orders/${o.id}`,o.form),y.value="Заказ обновлён";const q=o.id??R??null;await de();const ae=x.findIndex(ce=>ce.id===q);ae>=0&&(U.value=ae)}catch(R){h.value=R?.response?.data?.message||R?.message||"Не удалось сохранить заказ"}finally{b.value=!1}}}async function Y(V){const o=x[V];if(o)try{const R=U.value===V;o.id!=null&&await e.$del?.(`tasks/orders/${o.id}`),x.splice(V,1),x.length===0?(x.push({id:null,form:F()}),U.value=0):R&&(U.value=Math.min(V,x.length-1)),y.value="Заказ удалён"}catch(R){h.value=R?.response?.data?.message||R?.message||"Не удалось удалить заказ"}}return be(de),a({fetchOrders:de,addNewOrder:S,saveOrderAt:H,deleteOrderAt:Y,get orders(){return g.value},get currentOrderId(){return x[0]?.id??null},get forms(){return x}}),(V,o)=>{const R=Le,q=pt,ae=tt,ce=La,se=Pa,ge=Oa,ye=ml,$e=vt,ke=mt,L=gt,c=yt,z=ht,G=ft,k=hl,P=gl,J=vl,le=bt;return p(),w("div",null,[v("div",jo,[v("div",Ko,[(p(!0),w(pe,null,me(x,(C,re)=>(p(),N(R,{key:C.id??"new-"+re,variant:re===U.value?"default":"secondary",size:"sm",class:"bg-neutral-800 text-neutral-300 border border-neutral-600 data-[active=true]:bg-neutral-600 data-[active=true]:text-white","data-active":re===U.value,onClick:ee=>U.value=re},{default:u(()=>[M(D(ie(C,re)),1)]),_:2},1032,["variant","data-active","onClick"]))),128)),r(R,{variant:"secondary",size:"sm",class:"text-neutral-300 bg-neutral-700/50 hover:bg-neutral-600/50",onClick:S},{default:u(()=>o[24]||(o[24]=[M(" + Вывеска ",-1)])),_:1,__:[24]})]),v("div",Ho,[r(R,{disabled:b.value,size:"sm",class:"text-neutral-300 bg-neutral-600 hover:bg-neutral-600/50",onClick:O},{default:u(()=>[M(D(b.value?"Сохраняем…":"Сохранить"),1)]),_:1},8,["disabled"])])]),v("div",Wo,[v("div",Go,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.title?K("",!0):(p(),w("span",Xo,"*")),o[25]||(o[25]=M(" Название: ",-1))]),_:1,__:[25]}),r(ae,{modelValue:t($).form.title,"onUpdate:modelValue":o[0]||(o[0]=C=>t($).form.title=C),class:"h-8 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",placeholder:"Название заказа"},null,8,["modelValue"])]),v("div",Yo,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.deadline?K("",!0):(p(),w("span",Qo,"*")),o[26]||(o[26]=M(" Срок: ",-1))]),_:1,__:[26]}),r(ae,{modelValue:t($).form.deadline,"onUpdate:modelValue":o[1]||(o[1]=C=>t($).form.deadline=C),class:"h-8 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",type:"date",placeholder:"Срок"},null,8,["modelValue"])])]),o[49]||(o[49]=v("div",{class:"relative border-b-1 border-neutral-500 mb-5 mt-8"},[v("span",{class:"absolute top-[-9px] left-[50%] translate-x-[-50%] text-neutral-400 bg-neutral-800 text-xs font-medium px-1"},"Подложка")],-1)),v("div",Jo,[v("div",Zo,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.boardWidth?K("",!0):(p(),w("span",es,"*")),o[27]||(o[27]=v("span",null,"Ширина(см):",-1))]),_:1,__:[27]}),r(ae,{modelValue:t($).form.boardWidth,"onUpdate:modelValue":o[2]||(o[2]=C=>t($).form.boardWidth=C),modelModifiers:{number:!0},type:"number",class:"h-8 bg-neutral-800 text-neutral-300 border-neutral-500/20"},null,8,["modelValue"])]),v("div",ts,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.boardHeight?K("",!0):(p(),w("span",as,"*")),o[28]||(o[28]=M(" Высота(см): ",-1))]),_:1,__:[28]}),r(ae,{modelValue:t($).form.boardHeight,"onUpdate:modelValue":o[3]||(o[3]=C=>t($).form.boardHeight=C),modelModifiers:{number:!0},type:"number",class:"h-8 bg-neutral-800 text-neutral-300 border-neutral-500/20"},null,8,["modelValue"])]),v("div",ls,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.holeType?K("",!0):(p(),w("span",ns,"*")),o[29]||(o[29]=M(" Отверстия: ",-1))]),_:1,__:[29]}),r(ge,null,{default:u(()=>[r(ce,{class:"w-full"},{default:u(()=>[r(ae,{modelValue:t($).form.holeType,"onUpdate:modelValue":o[4]||(o[4]=C=>t($).form.holeType=C),class:"h-8 bg-neutral-800 text-neutral-300 border-neutral-500/20 placeholder:text-neutral-600",placeholder:"6мм/9мм/другое"},null,8,["modelValue"])]),_:1}),r(se,{class:"w-[100px] p-1"},{default:u(()=>[(p(),w(pe,null,me(s,C=>v("div",{key:C,class:"hover:bg-slate-100 text-gray-400 cursor-pointer",onClick:()=>t($).form.holeType=C},D(C),9,os)),64))]),_:1})]),_:1})])]),o[50]||(o[50]=v("div",{class:"relative border-b border-neutral-500 mb-5 mt-8"},[v("span",{class:"absolute -top-2 left-1/2 -translate-x-1/2 bg-neutral-800 text-neutral-400 text-xs px-1"},"Печать/Акрил")],-1)),v("div",ss,[v("div",rs,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[M(" Печать: "+D(t($).form.print?"Да":"Нет"),1)]),_:1}),r(ye,{checked:t($).form.print,"onUpdate:checked":o[5]||(o[5]=C=>t($).form.print=C),class:"scale-75 data-[state=checked]:bg-lime-900 data-[state=unchecked]:bg-neutral-500","thumb-class":"bg-neutral-400 data-[state=checked]:bg-neutral-300"},null,8,["checked"])]),v("div",is,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[M(" Качество согласовано: "+D(t($).form.printQuality?"Да":"Нет"),1)]),_:1}),r(ye,{checked:t($).form.printQuality,"onUpdate:checked":o[6]||(o[6]=C=>t($).form.printQuality=C),class:"scale-75 data-[state=checked]:bg-lime-900 data-[state=unchecked]:bg-neutral-500","thumb-class":"bg-neutral-400 data-[state=checked]:bg-neutral-300"},null,8,["checked"])]),v("div",us,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.acrylic?K("",!0):(p(),w("span",ds,"*")),o[30]||(o[30]=M(" Акрил: ",-1))]),_:1,__:[30]}),r(ae,{modelValue:t($).form.acrylic,"onUpdate:modelValue":o[7]||(o[7]=C=>t($).form.acrylic=C),class:"h-8 bg-neutral-800 text-neutral-300 border-neutral-500/20 placeholder:text-neutral-600",placeholder:"Цвет и тп"},null,8,["modelValue"])])]),o[51]||(o[51]=v("div",{class:"relative border-b-1 border-neutral-500 mb-5 mt-8"},[v("span",{class:"absolute top-[-9px] left-[50%] translate-x-[-50%] text-neutral-400 bg-neutral-800 text-xs font-medium px-1"},"Неон")],-1)),v("div",cs,[v("div",ps,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.type?K("",!0):(p(),w("span",fs,"*")),o[31]||(o[31]=M(" Тип: ",-1))]),_:1,__:[31]}),r(G,{modelValue:t($).form.type,"onUpdate:modelValue":o[8]||(o[8]=C=>t($).form.type=C)},{default:u(()=>[r(ke,{class:"h-8 bg-neutral-800 text-neutral-300 border-neutral-500/20"},{default:u(()=>[r($e,{class:"placeholder:text-neutral-600",placeholder:"Помещение/Улица"})]),_:1}),r(z,{class:"bg-neutral-800 text-neutral-300"},{default:u(()=>[(p(),w(pe,null,me(f,(C,re)=>r(c,{key:re},{default:u(()=>[r(L,{value:C},{default:u(()=>[M(D(C),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),v("div",ms,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.elements?K("",!0):(p(),w("span",vs,"*")),o[32]||(o[32]=M(" Элементы: ",-1))]),_:1,__:[32]}),r(ae,{modelValue:t($).form.elements,"onUpdate:modelValue":o[9]||(o[9]=C=>t($).form.elements=C),modelModifiers:{number:!0},class:"h-8 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",type:"number"},null,8,["modelValue"])]),t($).form.neons.length?(p(),w("div",hs,[r(q,{class:"font-medium"},{default:u(()=>o[33]||(o[33]=[M(" Общая длина неона: ",-1)])),_:1,__:[33]}),v("span",gs,D(t(T).toFixed(2))+"м ",1)])):K("",!0),v("div",ys,[o[36]||(o[36]=v("span",{class:"font-medium flex text-neutral-400 mr-auto"},"Неоны: ",-1)),r(R,{variant:"secondary",size:"sm",class:"text-neutral-300 bg-neutral-600 hover:bg-neutral-600/50",onClick:o[10]||(o[10]=C=>oe())},{default:u(()=>o[34]||(o[34]=[M(" + Неон ",-1)])),_:1,__:[34]}),r(R,{variant:"secondary",size:"sm",class:"text-neutral-300 bg-neutral-600 hover:bg-neutral-600/50",onClick:o[11]||(o[11]=C=>A())},{default:u(()=>o[35]||(o[35]=[M(" + Подсветка ",-1)])),_:1,__:[35]})]),v("div",bs,[t($).form.neons.length===0?(p(),w("div",_s," Неон не добавлен ")):K("",!0)]),v("div",xs,[(p(!0),w(pe,null,me(t($).form.neons,(C,re)=>(p(),w("div",{key:re,class:"flex items-center"},[r(J,null,{default:u(()=>[!C.color||!C.length?(p(),w("span",ks,"*")):K("",!0),v("div",ws,[r(k,{class:"text-sm p-2 bg-transparent hover:underline cursor-pointer"},{default:u(()=>[v("span",null,D(C.color)+"("+D(C.width)+") - "+D(C.length)+"м",1)]),_:2},1024),v("button",{class:"flex bg-transparent mx-1 cursor-pointer",onClick:ee=>X(re)},[r(t(Ze),{class:"w-4 x-4"})],8,$s)]),r(P,{class:"w-[400px] bg-neutral-700"},{default:u(()=>[v("div",Cs,[v("div",Is,[r(q,{class:"font-light text-neutral-400"},{default:u(()=>[o[37]||(o[37]=M(" Цвет ",-1)),C.color?K("",!0):(p(),w("span",Vs,"*"))]),_:2,__:[37]},1024),r(G,{modelValue:C.color,"onUpdate:modelValue":ee=>C.color=ee},{default:u(()=>[r(ke,{class:"h-8 bg-neutral-700 text-neutral-300 border-neutral-500/20"},{default:u(()=>[r($e,{placeholder:""})]),_:1}),r(z,{class:"bg-neutral-800 text-neutral-300"},{default:u(()=>[(p(),w(pe,null,me(m,(ee,te)=>r(c,{key:te,class:"p-0.5"},{default:u(()=>[r(L,{value:ee,class:"py-0 pr-0"},{default:u(()=>[M(D(ee),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),v("div",null,[r(q,{class:"font-light text-neutral-400"},{default:u(()=>[o[38]||(o[38]=M(" Толщина ",-1)),C.width?K("",!0):(p(),w("span",Ss,"*"))]),_:2,__:[38]},1024),r(G,{modelValue:C.width,"onUpdate:modelValue":ee=>C.width=ee},{default:u(()=>[r(ke,{class:"h-8 bg-neutral-700 text-neutral-300 border-neutral-500/20"},{default:u(()=>[r($e,{placeholder:""})]),_:1}),r(z,{class:"bg-neutral-800 text-neutral-300"},{default:u(()=>[(p(),w(pe,null,me(B,(ee,te)=>r(c,{key:te},{default:u(()=>[r(L,{value:ee},{default:u(()=>[M(D(ee),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),v("div",Ts,[r(q,{class:"font-light text-neutral-400"},{default:u(()=>[o[39]||(o[39]=M(" Длина (м) ",-1)),C.length?K("",!0):(p(),w("span",As,"*"))]),_:2,__:[39]},1024),r(ae,{modelValue:C.length,"onUpdate:modelValue":ee=>C.length=ee,modelModifiers:{number:!0},class:"h-8 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",type:"number",placeholder:"м"},null,8,["modelValue","onUpdate:modelValue"])])])]),_:2},1024)]),_:2},1024)]))),128)),(p(!0),w(pe,null,me(t($).form.lightings,(C,re)=>(p(),w("div",{key:re,class:"flex items-center"},[!C.color||!C.length||!C.elements?(p(),w("span",Bs,"*")):K("",!0),r(J,null,{default:u(()=>[v("div",Es,[r(k,{class:"text-sm p-1 bg-transparent hover:underline cursor-pointer"},{default:u(()=>[v("span",null," Подсветка - "+D(C.color)+" - "+D(C.elements)+"эл./"+D(C.length)+"м ",1)]),_:2},1024),v("button",{class:"flex rounded bg-transparent mr-1 cursor-pointer",onClick:ee=>I(re)},[r(t(Ze),{class:"w-4 x-4"})],8,qs)]),r(P,{class:"w-[400px] bg-neutral-700"},{default:u(()=>[v("div",Us,[v("div",Fs,[r(q,{class:"font-light text-neutral-400"},{default:u(()=>[o[40]||(o[40]=M(" Цвет ",-1)),C.color?K("",!0):(p(),w("span",Ms,"*"))]),_:2,__:[40]},1024),r(G,{modelValue:C.color,"onUpdate:modelValue":ee=>C.color=ee},{default:u(()=>[r(ke,{class:"h-8 bg-neutral-700 text-neutral-300 border-neutral-500/20"},{default:u(()=>[r($e,{placeholder:""})]),_:1}),r(z,{class:"bg-neutral-800 text-neutral-300"},{default:u(()=>[(p(),w(pe,null,me(m,(ee,te)=>r(c,{key:te,class:"p-0.5"},{default:u(()=>[r(L,{value:ee,class:"py-0 pr-0"},{default:u(()=>[M(D(ee),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),v("div",null,[r(q,{class:"font-light text-neutral-400"},{default:u(()=>[o[41]||(o[41]=M(" Элементы ",-1)),C.elements?K("",!0):(p(),w("span",Ds,"*"))]),_:2,__:[41]},1024),r(ae,{modelValue:C.elements,"onUpdate:modelValue":ee=>C.elements=ee,modelModifiers:{number:!0},class:"h-8 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),v("div",Os,[r(q,{class:"font-light text-neutral-400"},{default:u(()=>[o[42]||(o[42]=M(" Длина (м) ",-1)),C.length?K("",!0):(p(),w("span",Ls,"*"))]),_:2,__:[42]},1024),r(ae,{modelValue:C.length,"onUpdate:modelValue":ee=>C.length=ee,modelModifiers:{number:!0},class:"h-8 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",type:"number",placeholder:"м"},null,8,["modelValue","onUpdate:modelValue"])])])]),_:2},1024)]),_:2},1024)]))),128))])]),o[52]||(o[52]=v("div",{class:"relative border-b-1 border-neutral-500 mb-5 mt-8"},[v("span",{class:"absolute top-[-9px] left-[50%] translate-x-[-50%] text-neutral-400 bg-neutral-800 text-xs font-medium px-1"},"Упаковка/Комплектация")],-1)),v("div",Ps,[v("div",zs,[r(q,{class:"font-medium flex text-neutral-400 self-center whitespace-nowrap"},{default:u(()=>[t($).form.wireLength?K("",!0):(p(),w("span",Rs,"*")),o[43]||(o[43]=M(" Провод от вывески: ",-1))]),_:1,__:[43]}),r(ae,{modelValue:t($).form.wireLength,"onUpdate:modelValue":o[12]||(o[12]=C=>t($).form.wireLength=C),class:"h-8 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",placeholder:"Длина"},null,8,["modelValue"])]),v("div",Ns,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.adapter?K("",!0):(p(),w("span",js,"*")),o[44]||(o[44]=M(" Блок: ",-1))]),_:1,__:[44]}),r(ge,null,{default:u(()=>[r(ce,{class:"w-full"},{default:u(()=>[r(ae,{modelValue:t($).form.adapter,"onUpdate:modelValue":o[13]||(o[13]=C=>t($).form.adapter=C),class:"h-8 w-full bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",placeholder:""},null,8,["modelValue"])]),_:1}),r(se,{class:"p-1 w-[150px]"},{default:u(()=>[(p(),w(pe,null,me(i,C=>v("div",{key:C,class:"hover:bg-slate-100 text-gray-400",onClick:()=>t($).form.adapter=C},D(C),9,Ks)),64))]),_:1})]),_:1})]),v("div",Hs,[r(q,{class:"font-medium flex text-neutral-400 self-center whitespace-nowrap"},{default:u(()=>[t($).form.plug?K("",!0):(p(),w("span",Ws,"*")),o[45]||(o[45]=M(" Провод от блока: ",-1))]),_:1,__:[45]}),r(ae,{modelValue:t($).form.plug,"onUpdate:modelValue":o[14]||(o[14]=C=>t($).form.plug=C),class:"h-8 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",placeholder:"Длина/Цвет"},null,8,["modelValue"])]),v("div",Gs,[r(q,{class:"font-medium flex text-neutral-400 self-center"},{default:u(()=>[t($).form.fitting?K("",!0):(p(),w("span",Xs,"*")),o[46]||(o[46]=M(" Фурнитура: ",-1))]),_:1,__:[46]}),r(ge,null,{default:u(()=>[r(ce,{class:"w-full"},{default:u(()=>[r(ae,{modelValue:t($).form.fitting,"onUpdate:modelValue":o[15]||(o[15]=C=>t($).form.fitting=C),class:"h-8 w-full bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",placeholder:"Фурнитура"},null,8,["modelValue"])]),_:1}),r(se,{class:"p-1"},{default:u(()=>[(p(),w(pe,null,me(d,C=>v("div",{key:C,class:"hover:bg-slate-100 text-gray-400",onClick:()=>t($).form.fitting+=C},D(C),9,Ys)),64))]),_:1})]),_:1})]),v("div",Qs,[r(q,{class:"font-medium text-neutral-400 self-center"},{default:u(()=>[M(" Диммер: "+D(t($).form.dimmer?"Да":"Нет"),1)]),_:1}),r(ye,{checked:t($).form.dimmer,"onUpdate:checked":o[16]||(o[16]=C=>t($).form.dimmer=C),class:"scale-75 data-[state=checked]:bg-lime-900 data-[state=unchecked]:bg-neutral-500 justify-self-start","thumb-class":"bg-neutral-400 data-[state=checked]:bg-neutral-300"},null,8,["checked"])]),v("div",Js,[r(q,{class:"font-medium text-neutral-400 self-center"},{default:u(()=>[M(" Выключатель: "+D(t($).form.switch?"Да":"Нет"),1)]),_:1}),r(ye,{checked:t($).form.switch,"onUpdate:checked":o[17]||(o[17]=C=>t($).form.switch=C),class:"scale-75 data-[state=checked]:bg-lime-900 data-[state=unchecked]:bg-neutral-500 justify-self-start","thumb-class":"bg-neutral-400 data-[state=checked]:bg-neutral-300"},null,8,["checked"])]),v("div",Zs,[r(q,{class:"font-medium text-neutral-400 self-center"},{default:u(()=>[M(" Подарок: "+D(t($).form.gift?"Да":"Нет"),1)]),_:1}),r(ye,{checked:t($).form.gift,"onUpdate:checked":o[18]||(o[18]=C=>t($).form.gift=C),class:"scale-75 data-[state=checked]:bg-lime-900 data-[state=unchecked]:bg-neutral-500 justify-self-start","thumb-class":"bg-neutral-400 data-[state=checked]:bg-neutral-300"},null,8,["checked"])]),v("div",er,[r(q,{class:"font-medium text-neutral-400 self-center"},{default:u(()=>[M(" Подставка: "+D(t($).form.stand?"Да":"Нет"),1)]),_:1}),r(ye,{checked:t($).form.stand,"onUpdate:checked":o[19]||(o[19]=C=>t($).form.stand=C),class:"scale-75 data-[state=checked]:bg-lime-900 data-[state=unchecked]:bg-neutral-500 justify-self-start","thumb-class":"bg-neutral-400 data-[state=checked]:bg-neutral-300"},null,8,["checked"])]),v("div",tr,[r(q,{class:"font-medium text-neutral-400 self-center"},{default:u(()=>[M(" Подарочная упаковка: "+D(t($).form.giftPack?"Да":"Нет"),1)]),_:1}),r(ye,{checked:t($).form.giftPack,"onUpdate:checked":o[20]||(o[20]=C=>t($).form.giftPack=C),class:"scale-75 data-[state=checked]:bg-lime-900 data-[state=unchecked]:bg-neutral-500 justify-self-start","thumb-class":"bg-neutral-400 data-[state=checked]:bg-neutral-300"},null,8,["checked"])]),v("div",ar,[r(q,{class:"font-medium text-neutral-400 self-center"},{default:u(()=>[M(" Документы: "+D(t($).form.docs?"Да":"Нет"),1)]),_:1}),r(ye,{checked:t($).form.docs,"onUpdate:checked":o[21]||(o[21]=C=>t($).form.docs=C),class:"scale-75 data-[state=checked]:bg-lime-900 data-[state=unchecked]:bg-neutral-500 justify-self-start","thumb-class":"bg-neutral-400 data-[state=checked]:bg-neutral-300"},null,8,["checked"])])]),v("div",lr,[r(q,{class:"font-medium text-neutral-400 self-start"},{default:u(()=>o[47]||(o[47]=[M(" Дополнительная информация: ",-1)])),_:1,__:[47]}),r(le,{modelValue:t($).form.description,"onUpdate:modelValue":o[22]||(o[22]=C=>t($).form.description=C),class:"min-h-34 bg-neutral-800 text-neutral-300 placeholder:text-neutral-600 border-neutral-500/20",placeholder:"Описание"},null,8,["modelValue"])]),r(R,{size:"sm",class:"text-red-200 bg-red-700 hover:bg-red-700/80 mb-6",disabled:b.value,onClick:o[23]||(o[23]=()=>Y(U.value))},{default:u(()=>o[48]||(o[48]=[M(" Удалить вывеску ",-1)])),_:1,__:[48]},8,["disabled"]),h.value?(p(),w("div",nr,D(h.value),1)):K("",!0)])}}}),sr={},rr={id:"Layer_1",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512","xml:space":"preserve",fill:"currentColor",stroke:"currentColor"};function ir(l,a){return p(),w("svg",rr,a[0]||(a[0]=[ct('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path style="fill:#f15642;" d="M128,0c-17.6,0-32,14.4-32,32v448c0,17.6,14.4,32,32,32h320c17.6,0,32-14.4,32-32V128L352,0H128z"></path><path style="fill:#f15642;" d="M384,128h96L352,0v96C352,113.6,366.4,128,384,128z"></path><polygon style="fill:#f15642;" points="480,224 384,128 480,128 "></polygon><path style="fill:#f15642;" d="M416,416c0,8.8-7.2,16-16,16H48c-8.8,0-16-7.2-16-16V256c0-8.8,7.2-16,16-16h352c8.8,0,16,7.2,16,16 V416z"></path><g><path style="fill:#ffffff;" d="M101.744,303.152c0-4.224,3.328-8.832,8.688-8.832h29.552c16.64,0,31.616,11.136,31.616,32.48 c0,20.224-14.976,31.488-31.616,31.488h-21.36v16.896c0,5.632-3.584,8.816-8.192,8.816c-4.224,0-8.688-3.184-8.688-8.816V303.152z M118.624,310.432v31.872h21.36c8.576,0,15.36-7.568,15.36-15.504c0-8.944-6.784-16.368-15.36-16.368H118.624z"></path><path style="fill:#ffffff;" d="M196.656,384c-4.224,0-8.832-2.304-8.832-7.92v-72.672c0-4.592,4.608-7.936,8.832-7.936h29.296 c58.464,0,57.184,88.528,1.152,88.528H196.656z M204.72,311.088V368.4h21.232c34.544,0,36.08-57.312,0-57.312H204.72z"></path><path style="fill:#ffffff;" d="M303.872,312.112v20.336h32.624c4.608,0,9.216,4.608,9.216,9.072c0,4.224-4.608,7.68-9.216,7.68 h-32.624v26.864c0,4.48-3.184,7.92-7.664,7.92c-5.632,0-9.072-3.44-9.072-7.92v-72.672c0-4.592,3.456-7.936,9.072-7.936h44.912 c5.632,0,8.96,3.344,8.96,7.936c0,4.096-3.328,8.704-8.96,8.704h-37.248V312.112z"></path></g><path style="fill:#f15642;" d="M400,432H96v16h304c8.8,0,16-7.2,16-16v-16C416,424.8,408.8,432,400,432z"></path></g>',3)]))}const ur=at(sr,[["render",ir]]),dr={},cr={id:"Layer_1",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512","xml:space":"preserve",fill:"currentColor",stroke:"currentColor"};function pr(l,a){return p(),w("svg",cr,a[0]||(a[0]=[ct('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path style="fill:#50bee8;" d="M128,0c-17.6,0-32,14.4-32,32v448c0,17.6,14.4,32,32,32h320c17.6,0,32-14.4,32-32V128L352,0H128z"></path><path style="fill:#50bee8;" d="M384,128h96L352,0v96C352,113.6,366.4,128,384,128z"></path><polygon style="fill:#50bee8;" points="480,224 384,128 480,128 "></polygon><path style="fill:#50bee8;" d="M416,416c0,8.8-7.2,16-16,16H48c-8.8,0-16-7.2-16-16V256c0-8.8,7.2-16,16-16h352c8.8,0,16,7.2,16,16 V416z"></path><g><path style="fill:#ffffff;" d="M92.576,384c-4.224,0-8.832-2.32-8.832-7.936v-72.656c0-4.608,4.608-7.936,8.832-7.936h29.296 c58.464,0,57.168,88.528,1.136,88.528H92.576z M100.64,311.072v57.312h21.232c34.544,0,36.064-57.312,0-57.312H100.64z"></path><path style="fill:#ffffff;" d="M228,385.28c-23.664,1.024-48.24-14.72-48.24-46.064c0-31.472,24.56-46.944,48.24-46.944 c22.384,1.136,45.792,16.624,45.792,46.944C273.792,369.552,250.384,385.28,228,385.28z M226.592,308.912 c-14.336,0-29.936,10.112-29.936,30.32c0,20.096,15.616,30.336,29.936,30.336c14.72,0,30.448-10.24,30.448-30.336 C257.04,319.008,241.312,308.912,226.592,308.912z"></path><path style="fill:#ffffff;" d="M288.848,339.088c0-24.688,15.488-45.92,44.912-45.92c11.136,0,19.968,3.328,29.296,11.392 c3.456,3.184,3.84,8.816,0.384,12.4c-3.456,3.056-8.704,2.688-11.776-0.384c-5.232-5.504-10.608-7.024-17.904-7.024 c-19.696,0-29.152,13.952-29.152,29.552c0,15.872,9.328,30.448,29.152,30.448c7.296,0,14.08-2.96,19.968-8.192 c3.952-3.072,9.456-1.552,11.76,1.536c2.048,2.816,3.056,7.552-1.408,12.016c-8.96,8.336-19.696,10-30.336,10 C302.8,384.912,288.848,363.776,288.848,339.088z"></path></g><path style="fill:#50bee8;" d="M400,432H96v16h304c8.8,0,16-7.2,16-16v-16C416,424.8,408.8,432,400,432z"></path></g>',3)]))}const fr=at(dr,[["render",pr]]),mr={},vr={id:"Layer_1",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512","xml:space":"preserve",fill:"currentColor",stroke:"currentColor"};function hr(l,a){return p(),w("svg",vr,a[0]||(a[0]=[ct('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path style="fill:#84bd5a;" d="M128,0c-17.6,0-32,14.4-32,32v448c0,17.6,14.4,32,32,32h320c17.6,0,32-14.4,32-32V128L352,0H128z"></path><path style="fill:#84bd5a;" d="M384,128h96L352,0v96C352,113.6,366.4,128,384,128z"></path><polygon style="fill:#84bd5a;" points="480,224 384,128 480,128 "></polygon><path style="fill:#84bd5a;" d="M416,416c0,8.8-7.2,16-16,16H48c-8.8,0-16-7.2-16-16V256c0-8.8,7.2-16,16-16h352c8.8,0,16,7.2,16,16 V416z"></path><g><path style="fill:#ffffff;" d="M90.592,339.088c0-24.688,15.472-45.904,44.912-45.904c11.12,0,19.952,3.312,29.296,11.376 c3.456,3.184,3.824,8.832,0.368,12.4c-3.456,3.056-8.704,2.688-11.76-0.368c-5.248-5.504-10.624-7.024-17.904-7.024 c-19.696,0-29.168,13.936-29.168,29.536c0,15.872,9.328,30.464,29.168,30.464c7.28,0,14.064-2.96,19.952-8.192 c3.968-3.072,9.472-1.552,11.76,1.536c2.048,2.816,3.072,7.536-1.408,12.016c-8.96,8.336-19.696,9.984-30.32,9.984 C104.544,384.912,90.592,363.792,90.592,339.088z"></path><path style="fill:#ffffff;" d="M195.056,384c-4.224,0-8.832-2.304-8.832-7.92v-72.672c0-4.592,4.608-7.936,8.832-7.936h29.296 c58.464,0,57.184,88.528,1.152,88.528H195.056z M203.12,311.088V368.4h21.232c34.544,0,36.08-57.312,0-57.312H203.12z"></path><path style="fill:#ffffff;" d="M302.592,375.68c0,11.12-17.008,11.52-17.008,0.256V303.28c0-4.464,3.456-7.808,7.664-7.808h34.032 c32.496,0,39.152,43.504,12.032,54.368l17.008,20.736c6.656,9.856-6.656,19.312-14.336,9.6l-19.312-27.648h-20.096v23.152H302.592z M302.592,337.824h24.688c16.64,0,17.664-26.864,0-26.864h-24.688V337.824z"></path></g><path style="fill:#84bd5a;" d="M400,432H96v16h304c8.8,0,16-7.2,16-16v-16C416,424.8,408.8,432,400,432z"></path></g>',3)]))}const gr=at(mr,[["render",hr]]),yr={class:"absolute inset-0 flex flex-col"},br={class:"flex items-center gap-2 p-2 text-white z-10"},_r={class:"ml-auto flex items-center gap-2"},xr={class:"absolute inset-0 grid place-items-center"},kr=["src","alt"],wr={key:1,class:"text-white/80 text-sm"},$r={class:"p-2 text-center text-white/80 text-xs truncate"},Cr={key:0,class:"mr-2"},Ir=Q({__name:"ImageViewer",props:st({path:{},items:{},index:{},name:{},size:{}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:["update:open"],setup(l){const a=Dt(l,"open"),e=l,{getPreviewSrc:n,refreshPreview:s,onImgError:i,downloadAttachment:f}=Ft(),d=E(""),m=E(e.index??0),B=E(!1),_=E(null),g=E(1),b=E(0),h=E(0);let y=!1,x=0,U=0;function $(){g.value=1,b.value=0,h.value=0}function T(o){if(o.ctrlKey)return;o.preventDefault();const R=o.deltaY>0?-.1:.1,q=Math.min(5,Math.max(.3,g.value+R));g.value=q}function ie(o){o.target.setPointerCapture?.(o.pointerId),y=!0,x=o.clientX,U=o.clientY}function F(o){if(!y)return;const R=o.clientX-x,q=o.clientY-U;b.value+=R,h.value+=q,x=o.clientX,U=o.clientY}function j(o){y=!1}function de(o){a.value&&(o.key==="Escape"?(o.preventDefault(),oe()):o.key==="ArrowRight"?(o.preventDefault(),I()):o.key==="ArrowLeft"?(o.preventDefault(),S()):(o.key==="+"||o.key==="=")&&!o.metaKey&&!o.ctrlKey?(o.preventDefault(),g.value=Math.min(5,g.value+.1)):(o.key==="-"||o.key==="_")&&!o.metaKey&&!o.ctrlKey?(o.preventDefault(),g.value=Math.max(.3,g.value-.1)):o.key==="0"&&(o.ctrlKey||o.metaKey)&&(o.preventDefault(),$()))}function oe(){a.value=!1}function X(o){const R=(e.items?.length||1)-1;return o<0?R:o>R?0:o}async function A(o){const R=X(o);R!==m.value&&(m.value=R,$(),await Y())}function I(){!e.items||e.items.length<=1||A(m.value+1)}function S(){!e.items||e.items.length<=1||A(m.value-1)}function O(o){return/^blob:|^data:|^https?:\/\//.test(o||"")}function H(){if(Array.isArray(e.items)&&e.items.length>0){const o=Math.max(0,Math.min(m.value,e.items.length-1));return e.items[o]}return{path:e.path||"",name:e.name}}async function Y(){const o=H();if(!o?.path){d.value="";return}B.value=!0;try{const R=o.path||"";if(O(R))d.value=R;else{let q=n(R,1920);q||(await s(R,1920),q=n(R,1920)),d.value=q||""}}finally{B.value=!1}}he(()=>a.value,async o=>{o&&(m.value=e.index??0,$(),await Y(),setTimeout(()=>_.value?.focus?.(),0))}),he(()=>e.index,o=>{o===void 0||!a.value||(m.value=Math.max(0,Math.min(o,(e.items?.length||1)-1)))}),he(()=>e.items,async()=>{a.value&&(m.value=Math.max(0,Math.min(m.value,(e.items?.length||1)-1)),await Y())},{deep:!0}),be(()=>{window.addEventListener("keydown",de)}),Ot(()=>{window.removeEventListener("keydown",de)});async function V(){const o=H();if(!o?.path)return;const R=o.path;if(O(R)){const q=document.createElement("a");q.href=R,q.download=o.name||e.name||"image",q.target="_blank",q.rel="noopener noreferrer",document.body.appendChild(q),q.click(),q.remove();return}await f(R,o.name||e.name||"image")}return(o,R)=>(p(),N(al,{"enter-active-class":"transition duration-150 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:u(()=>[a.value?(p(),w("div",{key:0,class:"fixed inset-0 z-[100] bg-black/70",onClick:oe},[v("div",yr,[v("div",br,[v("div",_r,[v("button",{class:"rounded bg-slate-200 px-2 py-1 hover:bg-slate-100 text-slate-900",onClick:ve(V,["stop"])}," Скачать ")]),v("button",{class:"rounded bg-slate-200 px-2 py-1 hover:bg-slate-100 text-slate-900",onClick:oe}," Закрыть ")]),v("div",{ref_key:"viewportRef",ref:_,class:"relative flex-1 outline-none",tabindex:"0",onWheelPassive:ve(T,["prevent"]),onPointerdown:ie,onPointermove:F,onPointerup:j,onPointercancel:j,onLostpointercapture:j},[(e.items?.length||0)>1?(p(),w("button",{key:0,class:"text-5xl z-20 absolute cursor-pointer left-2 top-1/2 -translate-y-1/2 text-white h-9 w-9 grid place-items-center",title:"Предыдущее",onClick:ve(S,["stop"])}," ‹ ")):K("",!0),(e.items?.length||0)>1?(p(),w("button",{key:1,class:"text-5xl z-20 absolute cursor-pointer right-2 top-1/2 -translate-y-1/2 text-white h-9 w-9 grid place-items-center",title:"Следующее",onClick:ve(I,["stop"])}," › ")):K("",!0),v("div",xr,[v("div",{class:"max-w-full max-h-full",style:rt({transform:`translate(${b.value}px, ${h.value}px) scale(${g.value})`,transformOrigin:"center center",transition:t(y)?"none":"transform 60ms linear"})},[d.value?(p(),w("img",{key:0,src:d.value,alt:e.items&&e.items[m.value]?.name||e.name||"",class:"block max-w-[85vw] max-h-[75vh] md:max-w-[92vw] md:max-h-[85vh] object-contain rounded shadow",loading:"eager",referrerpolicy:"no-referrer",onClick:ve(I,["stop"]),onError:R[0]||(R[0]=()=>{const q=e.items&&e.items[m.value]?.path||e.path||"";O(q)||t(i)(q,1920)})},null,40,kr)):(p(),w("div",wr,"Загрузка…"))],4)])],544),v("div",$r,[(e.items?.length||0)>1?(p(),w("span",Cr,D(m.value+1+"/"+e.items.length),1)):K("",!0),M(" "+D(e.items&&e.items[m.value]?.name||e.name||"Изображение"),1)])])])):K("",!0)]),_:1}))}});function kt(l,a="Europe/Moscow"){const e=l instanceof Date?l:new Date(l);return Number.isNaN(e.getTime())?"":new Intl.DateTimeFormat("ru-RU",{timeZone:a,day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}).format(e)}function Qt(l){return l instanceof HTMLTextAreaElement?l:l.querySelector?.("textarea")||null}function Qe(l){const a=Qt(l);a&&(a.style.height="auto",a.style.overflow="hidden",a.style.height=`${a.scrollHeight}px`)}const Jt={mounted(l){const a=Qt(l);if(!a)return;const e=()=>Qe(l);a.addEventListener("input",e);const n=()=>Qe(l);l.addEventListener("autoresize:resize",n),requestAnimationFrame(()=>Qe(l)),l._autoResizeCleanup=()=>{a.removeEventListener("input",e),l.removeEventListener("autoresize:resize",n)}},updated(l){Qe(l)},unmounted(l){l._autoResizeCleanup?.()}},Vr={class:"h-full bg-neutral-700"},Sr={key:0,class:"flex flex-wrap gap-2 px-2"},Tr=["src","onClick"],Ar=["src"],Br={key:2,class:"h-20 w-20 rounded-md bg-neutral-200 text-neutral-600 text-xs flex items-center justify-center px-1 text-center"},Er=["onClick"],qr={class:"flex items-center justify-between gap-3 px-2"},Ur={class:"flex items-center gap-2"},Fr={class:"text-xs text-neutral-500"},Mr=["disabled"],Dr={key:0,class:"text-sm text-neutral-500"},Or={key:1,class:"text-sm text-red-500"},Lr={class:"space-y-3 p-2 bg-neutral-800 h-full pb-5"},Pr=["title","disabled","onClick"],zr={class:"mb-1 flex items-center gap-2 text-xs text-neutral-500 justify-between"},Rr={class:"text-neutral-400"},Nr={class:"whitespace-pre-wrap text-[15px] text-neutral-300"},jr={key:0,class:"mt-3 flex flex-col gap-2"},Kr={key:0,class:"flex gap-2 items-start relative overflow-hidden rounded-md border border-neutral-500 bg-neutral-700/40 p-1"},Hr=["src","srcset","onClick","onError"],Wr={class:"min-w-0 flex flex-col grow h-full"},Gr={class:"flex gap-1"},Xr=["title"],Yr={class:"text-[11px] text-neutral-400 whitespace-nowrap"},Qr={class:"flex flex-col mt-5 gap-1"},Jr={key:0,class:"text-xs text-emerald-400"},Zr=["onClick"],ei=["onClick"],ti=["title"],ai=["src"],li=["title","onClick"],ni={class:"flex-1 min-w-0"},oi=["title"],si={class:"text-[11px] text-neutral-400 whitespace-nowrap"},ri=["title","onClick"],ii={class:"flex-1 min-w-0 flex items-center gap-2"},ui={class:"text-xs text-neutral-300 truncate"},di={class:"text-[11px] text-neutral-400 ml-auto whitespace-nowrap"},ci=["title","onClick"],pi={class:"flex-1 min-w-0 flex items-center gap-2"},fi={class:"text-xs text-neutral-300 truncate"},mi={class:"text-[11px] text-neutral-400 ml-auto whitespace-nowrap"},vi=["title","onClick"],hi={class:"flex-1 min-w-0 flex items-center gap-2"},gi={class:"text-xs text-neutral-300 truncate"},yi={class:"text-[11px] text-neutral-400 ml-auto whitespace-nowrap"},bi=["title","onClick"],_i={class:"h-6 w-10 flex items-center justify-center bg-neutral-600 text-neutral-200 text-[11px] rounded"},xi={class:"flex-1 min-w-0 flex items-center gap-2"},ki={class:"text-xs text-neutral-300 truncate"},wi={class:"text-[11px] text-neutral-400 ml-auto whitespace-nowrap"},$i={key:0,class:"text-sm text-neutral-500"},Ee=10,Ci=Q({__name:"TaskComments",props:{taskId:{},cover:{}},emits:["cover-set"],setup(l,{emit:a}){const{getPreviewSrc:e,getPreviewSrcset:n,onImgError:s,downloadAttachment:i,getDownloadSrc:f}=Ft(),d=Oe({open:!1,path:"",name:"",items:[],index:0}),m=E(new Set);async function B(k,P){const{path:J,mimeType:le,name:C}=k;if(J){if(["image/jpeg","image/png","image/webp","image/gif"].includes(le)){if(P){const re=(P.files||[]).filter(ee=>(ee.mimeType||"").startsWith("image/"));d.items=re.map(ee=>({path:ee.path,name:ee.name})),d.index=Math.max(0,re.findIndex(ee=>ee.path===J))}else d.items=[{path:J,name:C}],d.index=0;d.path=J,d.name=C,d.open=!0;return}if((le||"").startsWith("video/")){const re=f(J);re&&window.open(re,"_blank","noopener,noreferrer");return}if((le||"")==="application/pdf"){await ae(J,C);return}if((le||"")==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"||(C||"").toLowerCase().endsWith(".docx")){await ce(J,C);return}await i(J,C)}}const{$api:_}=Be(),g=l,b=a,h=Yt(()=>g.taskId),y=E([]),x=E(!1),U=E(null),$=E(""),T=E(!1),ie=Oe({}),F=E([]),j=E([]);E(null);const de=E(null),oe=E(!1);function X(k){const P=(k.mimeType||"").toLowerCase(),J=(k.name||"").toLowerCase();return P.includes("pdf")||J.endsWith(".pdf")}function A(k){const P=(k.mimeType||"").toLowerCase();return(k.name||"").toLowerCase().endsWith(".cdr")||P.includes("corel")||P.includes("cdr")||P.includes("vnd.corel")}function I(k){const P=(k.mimeType||"").toLowerCase();return(k.name||"").toLowerCase().endsWith(".docx")||P.includes("application/vnd.openxmlformats-officedocument.wordprocessingml.document")}function S(k){if(!k&&k!==0)return"";if(k===0)return"0 B";const P=1024,J=["B","KB","MB","GB","TB"],le=Math.floor(Math.log(k)/Math.log(P));return parseFloat((k/Math.pow(P,le)).toFixed(2))+" "+J[le]}const O=E(g.cover??null);he(()=>g.cover,k=>{O.value=k??null});const H=E({});function Y(k){return!!H.value[k]}function V(k){return O.value===k}async function o(k){if(!(!k?.path||Y(k.path)||V(k.path))){H.value[k.path]=!0;try{await h.setCover(k.path),O.value=k.path,b("cover-set",k.path)}catch(P){console.error("set cover from comment failed",P)}finally{H.value[k.path]=!1}}}async function R(){try{x.value=!0,U.value=null;const k=await _?.$get?.(`tasks/${g.taskId}/comments`)??await _.$get(`tasks/${g.taskId}/comments`);y.value=Array.isArray(k)?k:k?.data??[]}catch(k){U.value=k?.message||"Не удалось загрузить комментарии",y.value=[]}finally{x.value=!1}}function q(k){if(de.value=null,!k?.length)return;const P=Ee-F.value.length;if(P<=0){de.value=`Можно прикрепить не более ${Ee} файлов`;return}const J=k.slice(0,P);J.length<k.length&&(de.value=`Добавлены только ${J.length} из ${k.length}. Лимит ${Ee}.`);for(const le of J)F.value.push(le),j.value.push(URL.createObjectURL(le))}async function ae(k,P){try{const J=f(k),le=await _.client.get(J,{responseType:"blob"}),C=new Blob([le.data],{type:"application/pdf"}),re=URL.createObjectURL(C),ee=window.open("","_blank");if(!ee){window.open(re,"_blank");return}ee.document.title=P||"PDF",ee.document.body.style.margin="0";const te=ee.document.createElement("iframe");te.style.border="0",te.style.width="100%",te.style.height="100vh",te.src=`${re}#toolbar=1&navpanes=1&view=FitH`,ee.document.body.appendChild(te)}catch(J){console.error("openPdfInline failed",J);const le=f(k);le&&window.open(le,"_blank","noopener,noreferrer")}}async function ce(k,P){try{const J=f(k),le=await _.client.get(J,{responseType:"blob"}),C=new Blob([le.data],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),re=URL.createObjectURL(C);if(!window.open(re,"_blank","noopener,noreferrer")){const te=document.createElement("a");te.href=re,te.download=P||"document.docx",document.body.appendChild(te),te.click(),te.remove()}setTimeout(()=>URL.revokeObjectURL(re),1e4)}catch(J){console.error("openDocxInline failed",J);const le=f(k);le&&window.open(le,"_blank","noopener,noreferrer")}}function se(k){const P=k.target,J=Array.from(P.files||[]);q(J),P.value=""}function ge(k){k.preventDefault(),oe.value=!1;const P=Array.from(k.dataTransfer?.files||[]);q(P)}function ye(k){URL.revokeObjectURL(j.value[k]),j.value.splice(k,1),F.value.splice(k,1)}function $e(k){const P=F.value[k],J=j.value[k];!P||!J||P.type?.startsWith("image/")&&(d.path=J,d.name=P.name||"image",d.open=!0)}function ke(){j.value.forEach(k=>URL.revokeObjectURL(k)),j.value=[],F.value=[],$.value=""}async function L(){if(!(!$.value.trim()&&F.value.length===0)){T.value=!0;try{const k=await _.$post(`tasks/${g.taskId}/comments`,{text:$.value.trim()}),P=k?.data?.id??k?.id;if(!P)throw new Error("Не удалось создать комментарий");F.value.length&&await Promise.all(F.value.map(J=>{const le=new FormData;return le.append("file",J),_.$post(`tasks/comments/${P}/files`,le)})),ke(),await R()}catch(k){console.error(k)}finally{T.value=!1}}}function c(k){de.value=null;const P=k.clipboardData?.items;if(!P)return;const J=Ee-F.value.length;if(J<=0){de.value=`Можно прикрепить не более ${Ee} файлов`;return}const le=[];for(const re of P)if(re.kind==="file"&&re.type.startsWith("image/")){const ee=re.getAsFile();ee&&le.push(ee)}if(!le.length)return;const C=le.slice(0,J);C.length<le.length&&(de.value=`Добавлены только ${C.length} из ${le.length}. Лимит ${Ee}.`);for(const re of C)F.value.push(re),j.value.push(URL.createObjectURL(re));k.preventDefault()}function z(k){k.key==="Enter"&&!k.shiftKey&&!k.altKey&&!k.ctrlKey&&!k.metaKey&&!k.isComposing&&(k.preventDefault(),T.value||L())}async function G(k){if(k)try{m.value.add(k),await(await _?.$del?.(`comments/${k}`)??await _.$del(`comments/${k}`)),y.value=y.value.filter(P=>P.id!==k)}catch(P){console.error(P)}finally{m.value.delete(k)}}return be(R),Ot(()=>{j.value.forEach(k=>URL.revokeObjectURL(k))}),(k,P)=>{const J=ut,le=ur,C=fr,re=gr,ee=Ir;return p(),w("section",Vr,[v("form",{class:Ie(["space-y-1 border-b-1 border-b-neutral-500 pb-2",t(oe)?"ring-2 ring-indigo-500 ring-offset-0":""]),onDragenter:P[1]||(P[1]=ve(te=>oe.value=!0,["prevent"])),onDragover:P[2]||(P[2]=ve(()=>{},["prevent"])),onDragleave:P[3]||(P[3]=ve(te=>oe.value=!1,["prevent"])),onDrop:ge,onSubmit:ve(L,["prevent"])},[Lt(v("textarea",{"onUpdate:modelValue":P[0]||(P[0]=te=>Me($)?$.value=te:null),rows:"3",class:"w-full bg-neutral-600/50 text-neutral-300 border-neutral-300 h-[100px] px-3 py-2 focus:outline-none focus:ring-2 focus:ring-neutral-500",placeholder:"Напишите комментарий… Перетащите файлы сюда, или Ctrl+V для изображения",onPaste:c,onKeydown:z},null,544),[[ll,t($)],[t(Jt)]]),t(F).length?(p(),w("div",Sr,[(p(!0),w(pe,null,me(t(j),(te,W)=>(p(),w("div",{key:te,class:"relative"},[t(F)[W]&&t(F)[W].type.startsWith("image/")?(p(),w("img",{key:0,src:te,class:"h-20 w-20 rounded-md object-cover cursor-zoom-in",alt:"",title:"Открыть предпросмотр",onClick:Ce=>$e(W)},null,8,Tr)):t(F)[W]&&t(F)[W].type.startsWith("video/")?(p(),w("video",{key:1,src:te,class:"h-20 w-28 rounded-md object-cover",muted:"",controls:"",playsinline:""},null,8,Ar)):(p(),w("div",Br,D(t(F)[W]?.name.split(".").pop()),1)),v("button",{type:"button",class:"absolute -top-2 -right-2 h-6 w-6 rounded-full bg-white border shadow text-xs","aria-label":"Удалить файл",title:"Удалить файл",onClick:Ce=>ye(W)}," ✕ ",8,Er)]))),128))])):K("",!0),v("div",qr,[v("div",Ur,[v("input",{id:"comment-file-input",type:"file",class:"hidden",multiple:"",accept:"image/*,video/*,application/pdf,.cdr,application/x-coreldraw,application/vnd.corel-draw,image/x-cdr,application/vnd.openxmlformats-officedocument.wordprocessingml.document,.docx",onChange:se},null,32),v("label",{for:"comment-file-input",class:Ie(["cursor-pointer rounded-lg px-3 py-1.5 text-sm text-neutral-300 bg-green-900 hover:bg-neutral-600/50",t(F).length>=Ee?"pointer-events-none opacity-50":""]),title:"Прикрепить файлы"}," Прикрепить ",2),v("span",Fr,D(t(F).length)+"/"+D(Ee),1)]),v("button",{type:"submit",class:"rounded-lg bg-neutral-600 px-4 py-2 text-neutral-300 cursor-pointer text-sm disabled:opacity-50",disabled:t(T)||!t($).trim()&&t(F).length===0},D(t(T)?"Отправляем…":"Отправить"),9,Mr)])],34),t(x)?(p(),w("div",Dr,"Загрузка…")):t(U)?(p(),w("div",Or,D(t(U)),1)):K("",!0),v("div",Lr,[(p(!0),w(pe,null,me(t(y),te=>(p(),w("div",{key:te.id,class:"rounded-md border-1 border-neutral-500/20 p-2 bg-neutral-600 relative"},[v("button",{type:"button",class:"absolute cursor-pointer text-xs top-[-8px] right-[-8px] h-5 w-5 rounded-full border border-neutral-400/40 bg-neutral-700/70 text-neutral-200 hover:bg-neutral-700 focus:outline-none disabled:opacity-50",title:t(m).has(te.id)?"Удаляем…":"Удалить комментарий",disabled:t(m).has(te.id),"aria-label":"Удалить комментарий",onClick:ve(W=>G(te.id),["stop"])}," ✕ ",8,Pr),v("div",zr,[(p(),N(J,{key:te.author.id,"full-name":te.author.fullName,"avatar-url":te.author.avatarUrl,dark:!0,size:"sm"},null,8,["full-name","avatar-url"])),v("span",Rr,D(("formatRuDateTime"in k?k.formatRuDateTime:t(kt))(te.createdAt)),1)]),v("div",Nr,D(te.text),1),te.files?.length?(p(),w("div",jr,[(p(!0),w(pe,null,me(te.files,W=>(p(),w(pe,{key:W.id},[(W.mimeType||"").startsWith("image/")?(p(),w("div",Kr,[v("img",{src:t(e)(W.path,160),srcset:t(n)(W.path,160),alt:"",class:"h-24 w-40 object-cover rounded bg-neutral-800 cursor-zoom-in",loading:"lazy",referrerpolicy:"no-referrer",onClick:Ce=>B(W,te),onError:()=>t(s)(W.path,160)},null,40,Hr),v("div",Wr,[v("div",Gr,[v("div",{class:"text-xs text-neutral-300 truncate",title:W.name},D(W.name),9,Xr),v("div",Yr," ("+D(S(W.size))+") ",1)]),v("div",Qr,[V(W.path)?(p(),w("span",Jr," Обложка ")):(p(),w("span",{key:1,class:Ie(["text-xs text-neutral-400 underline cursor-pointer",Y(W.path)?"opacity-60 pointer-events-none":""]),title:"Поставить на обложку",onClick:ve(Ce=>o(W),["stop"])},D(Y(W.path)?"Устанавливаем…":"Поставить на обложку"),11,Zr)),v("span",{class:"text-xs text-neutral-400 underline cursor-pointer",title:"Скачать изображение",onClick:ve(Ce=>t(i)(W.path,W.name),["stop"])}," Скачать изображение ",8,ei)])])])):(W.mimeType||"").startsWith("video/")?(p(),w("div",{key:1,class:"flex gap-2 items-center relative overflow-hidden rounded-md border border-neutral-500 bg-neutral-700/40 p-1",title:W.name},[t(ie)[W.id]?(p(),w("video",{key:0,src:t(f)(W.path),class:"h-24 w-40 object-cover rounded",controls:"",autoplay:"",playsinline:""},null,8,ai)):(p(),w("button",{key:1,type:"button",class:"h-24 w-40 rounded bg-neutral-800/70 hover:bg-neutral-700/70 flex items-center justify-center text-neutral-200",title:`Воспроизвести: ${W.name}`,onClick:Ce=>t(ie)[W.id]=!0}," ▶ ",8,li)),v("div",ni,[v("div",{class:"text-xs text-neutral-300 truncate",title:W.name},D(W.name),9,oi),v("div",si,D(S(W.size)),1)])],8,ti)):X(W)?(p(),w("button",{key:2,type:"button",class:"flex gap-2 items-center relative overflow-hidden rounded-md border border-neutral-500 hover:bg-neutral-500/30 cursor-pointer px-2 py-1",title:W.name,onClick:Ce=>B(W)},[r(le,{class:"w-10 h-10"}),v("div",ii,[v("span",ui,D(W.name),1),v("span",di,D(S(W.size)),1)])],8,ri)):I(W)?(p(),w("button",{key:3,type:"button",class:"flex gap-2 items-center relative overflow-hidden rounded-md border border-neutral-500 hover:bg-neutral-500/30 cursor-pointer px-2 py-1",title:W.name,onClick:Ce=>B(W)},[r(C,{class:"w-10 h-10"}),v("div",pi,[v("span",fi,D(W.name),1),v("span",mi,D(S(W.size)),1)])],8,ci)):A(W)?(p(),w("button",{key:4,type:"button",class:"flex gap-2 items-center relative overflow-hidden rounded-md border border-neutral-500 hover:bg-neutral-500/30 cursor-pointer px-2 py-1",title:W.name,onClick:Ce=>B(W)},[r(re,{class:"w-10 h-10"}),v("div",hi,[v("span",gi,D(W.name),1),v("span",yi,D(S(W.size)),1)])],8,vi)):(p(),w("button",{key:5,type:"button",class:"flex gap-2 items-center relative overflow-hidden rounded-md border border-neutral-500 hover:bg-neutral-500/30 cursor-pointer px-2 py-1",title:W.name,onClick:Ce=>B(W)},[v("div",_i,D(W.name.split(".").pop()),1),v("div",xi,[v("span",ki,D(W.name),1),v("span",wi,D(S(W.size)),1)])],8,bi))],64))),128))])):K("",!0)]))),128)),t(y).length?K("",!0):(p(),w("div",$i," Пока нет комментариев "))]),r(ee,{open:t(d).open,"onUpdate:open":P[4]||(P[4]=te=>t(d).open=te),path:t(d).path,name:t(d).name,items:t(d).items,index:t(d).index},null,8,["open","path","name","items","index"])])}}}),Ii=at(Ci,[["__scopeId","data-v-e1c3ec9c"]]),Vi={class:"space-y-2"},Si={key:0,class:"text-xs text-neutral-500"},Ti={key:1,class:"text-xs text-red-500"},Ai={key:2,class:"text-xs text-neutral-500"},Bi={key:3,class:"divide-y"},Ei={class:"flex items-center justify-between"},qi={class:"mr-3"},Ui={class:"shrink-0 text-[11px] text-neutral-400"},Fi={key:0,class:"mt-1 ml-10 list-disc text-[12px] text-neutral-700"},Mi={class:"font-medium"},Di={key:0,class:"text-neutral-500 line-through mr-1"},Oi={class:"text-neutral-400"},Li=Q({__name:"AuditPanel",props:{taskId:{},refreshable:{type:Boolean}},setup(l){const a=l,{$useApi:e}=Be(),n=E([]),s=E(!1),i=E(null);async function f(){if(a.taskId){s.value=!0,i.value=null;try{const{data:B}=await e.get(`tasks/${a.taskId}/audit`);n.value=Array.isArray(B)?B:[]}catch(B){i.value=B?.message||"Не удалось загрузить историю",n.value=[]}finally{s.value=!1}}}function d(B){switch(B){case"title":return"Название";case"description":return"Описание";case"chatLink":return"Ссылка";case"columnId":return"Колонка";default:return B}}function m(B){return B==null?"":String(B)}return be(f),(B,_)=>{const g=Le,b=ut;return p(),w("div",Vi,[t(s)?(p(),w("div",Si,"Загрузка…")):t(i)?(p(),w("div",Ti,D(t(i)),1)):t(n).length?(p(),w("div",Bi,[(p(!0),w(pe,null,me(t(n),h=>(p(),w("div",{key:h.id,class:"py-2"},[v("div",Ei,[v("div",qi,[r(b,{"full-name":h.user.fullName,"avatar-url":h.user.avatarUrl,size:"md",dark:!0},null,8,["full-name","avatar-url"])]),v("div",Ui,D(("formatRuDateTime"in B?B.formatRuDateTime:t(kt))(h.createdAt)),1)]),h.payload?(p(),w("div",Fi,[v("span",Mi,D(d(h.payload.field))+" - ",1),m(h.payload.from)!==""?(p(),w("span",Di,D(m(h.payload.from)),1)):K("",!0),v("span",Oi,D(h.description),1)])):K("",!0)]))),128))])):(p(),w("div",Ai,[_[1]||(_[1]=M(" История пуста ",-1)),B.refreshable?(p(),N(g,{key:0,size:"sm",variant:"ghost",class:"ml-2",onClick:f},{default:u(()=>_[0]||(_[0]=[M(" Обновить ",-1)])),_:1,__:[0]})):K("",!0)]))])}}}),Pi={key:0,class:"fixed inset-0 z-[10]"},zi={class:"relative z-10 flex min-h-full items-center justify-center p-0 sm:p-2"},Ri={key:0,class:"relative w-full max-w-6xl h-[100vh] sm:mt-1 bg-neutral-800 border border-neutral-700 flex flex-col gap-0 overflow-hidden p-0 sm:rounded-lg"},Ni={class:"sticky top-0 z-10 flex gap-1 sm:flex-nowrap items-center justify-between border-b bg-neutral-700 px-4 sm:px-5 py-3 sm:py-4 border-b-neutral-500"},ji={class:"flex items-center gap-2 w-full"},Ki={key:0,class:"whitespace-nowrap text-neutral-300 text-xl border-1 border-neutral-600 p-1 rounded-md bg-red-700/50"},Hi=["title","onClick"],Wi={class:"relative flex-1 min-h-0 overflow-hidden"},Gi={class:"min-h-full grid grid-cols-1 md:grid-cols-7 pr-2 bg-neutral-800"},Xi={class:"sm:col-span-4 bg-neutral-800 mb-3"},Yi={class:"mb-4 space-y-1"},Qi={class:"text-sm text-neutral-300"},Ji={class:"text-xs text-neutral-400"},Zi={class:"my-4 relative"},eu={class:"relative flex gap-2 items-center mt-4"},tu={class:"relative flex items-center gap-2"},au=["href"],lu={class:"relative flex items-center gap-2 text-neutral-300 mt-4"},nu={class:"relative mt-5"},ou={class:"sm:col-span-3 min-h-full h-fit border-l-1 border-neutral-500"},su={class:"px-1"},qu=Q({__name:"TaskModal",props:{open:{type:Boolean},taskId:{}},emits:["update:open","delete","move"],setup(l,{emit:a}){const e=Cl(),{toast:n}=nl(),s=ol(),i=sl(),f=ne(()=>Number(i.params.id)),d=E(null),m=Yt(()=>d.value??U.taskId),B=ne(()=>e.user),_=ne(()=>B.value?.boards??[]),g=E(!1),b=E(!1),h=E(!1),y=E(!1),x=E(!1),U=l,$=a,T=E(null),ie=E("main"),F=E(!1);async function j(){if(d.value??U.taskId){g.value=!0;try{const c=await m.getTask();T.value=c,T.value.avaliableDeals=T.value.avaliableDeals??[],T.value.deliveries=T.value.deliveries??[],de.title=void 0,de.description=void 0,de.chatLink=void 0,xe(()=>ke.value?.dispatchEvent(new Event("autoresize:resize")))}catch(c){console.error("fetchFullTask failed",c),s.push({path:`/boards/${f.value}`})}finally{g.value=!1}}}const de=Oe({});function oe(L){if(!T.value)return;const c=T.value[L]??"";de[L]=String(c)}async function X(L){if(!T.value)return;const c=String(T.value[L]??""),z=String(de[L]??"");if(c===z)return;const G={};L==="description"||L==="chatLink"?G[L]=c||null:G[L]=c;try{b.value=!0,await m.updateTask(G),de[L]=c}catch(k){console.error("save field failed",L,k)}finally{b.value=!1,await j()}}be(()=>{he(()=>U.taskId,L=>{L&&(d.value=Number(L),j().catch(console.error))},{immediate:!0}),he(()=>U.open,L=>{if(L){const c=U.taskId;c&&(d.value=Number(c),j().catch(console.error))}else d.value=null})});function A(){$("update:open",!1),d.value=null}async function I(){if(T.value){h.value=!0;try{await m.deleteTask(),$("update:open",!1),$("delete",T.value.id)}catch(L){console.error("deleteTask failed",L)}finally{h.value=!1}}}const S=ne({get(){return(T.value?.tags??[]).map(c=>({id:Number(c.id??0),name:c.name}))},set(L){if(!T.value)return;const c=new Map((T.value.tags??[]).map(z=>[z.name,z]));T.value.tags=L.map(z=>({...c.get(z.name),id:typeof z.id=="number"?z.id:void 0,name:z.name}))}});async function O(L){try{const c={toColumnId:Number(L.toColumnId)};await m.moveTask(c)}catch(c){return console.log(c)}}const H=E(!1),Y=ne(()=>{const L=(T.value?.chatLink||"").trim();return L?/^https?:\/\//i.test(L)?L:`https://${L}`:""});async function V(L){if(!H.value){H.value=!0;try{const c=await m.copyToBoard(L),z=Number(c?.id);if(Number.isFinite(z)){d.value=z;const G=Number(c?.boardId??L);G&&window.history.pushState({},"",`/boards/${G}/task/${z}`),await j()}else await j()}catch(c){console.error("copyToBoard error",c)}finally{H.value=!1}}}async function o(L){if(!H.value){H.value=!0;try{const c=await m.moveToBoard(L),z=Number(c?.id);if(Number.isFinite(z)){d.value=z;const G=Number(c?.boardId??L);G&&window.history.pushState({},"",`/boards/${G}/task/${z}`),await j()}else await j()}catch(c){console.error("moveToBoard error",c)}finally{H.value=!1}}}async function R(L){if(!(!T.value||y.value)){y.value=!0;try{await m.setArchived(!!L),T.value.archived=!!L,n({title:L?"Перемещено в архив":"Возвращено из архива"})}catch(c){console.error("setArchived failed",c),n({title:"Ошибка",description:"Не удалось изменить архивный статус"})}finally{y.value=!1}}}const q=Vl(),ae=ne(()=>`${q.protocol}//${q.host}`),ce=ne(()=>{if(!T.value)return"";const L=T.value.board?.id||f.value;return`${ae.value}/boards/${L}/task/${T.value.id}`});async function se(){try{if(!ce.value)return;await navigator.clipboard.writeText(ce.value),n({title:"Ссылка скопирована",description:ce.value})}catch(L){console.error("copyTaskLink failed",L),n({title:"Не удалось скопировать",description:"Попробуйте ещё раз"})}}async function ge(L){const c=String(L??"").trim();if(c)try{await navigator.clipboard.writeText(c),n({title:"Трек скопирован",description:c})}catch(z){console.error("copyTrack failed",z),n({title:"Не удалось скопировать трек",description:"Попробуйте ещё раз",variant:"destructive"})}}function ye(L){T.value&&(T.value.cover=L)}async function $e(L){if(!L||!T.value||x.value)return;const c=Number(L);if(Number.isFinite(c))try{x.value=!0,await m.updateTask({dealId:c}),await j(),n({title:"Сделка привязана",description:"Карточка обновлена"})}catch(z){console.error("linkDealToTask failed",z),n({title:"Не удалось привязать сделку",description:"Попробуйте ещё раз",variant:"destructive"})}finally{x.value=!1}}const ke=E(null);return he(ie,L=>{L==="main"&&xe(()=>ke.value?.dispatchEvent(new Event("autoresize:resize")))}),(L,c)=>{const z=tt,G=Le,k=Ra,P=ja,J=Yn,le=Qn,C=Xn,re=Na,ee=za,te=ul,W=il,Ce=cl,Ue=pt,Zt=uo,ea=to,ta=vt,aa=mt,la=gt,na=yt,oa=ht,sa=ft,ra=To,ia=bt,nt=dl,ua=No,da=or,ca=rl,pa=Ii,wt=Ut,fa=bl,ma=kl,va=wl,ha=xl,ga=Li,ya=$l,ba=_l,_a=yl;return p(),w("div",null,[L.open?(p(),w("div",Pi,[v("div",{class:"absolute inset-0 bg-black/80",onClick:c[0]||(c[0]=Z=>A())}),v("div",zi,[t(T)?(p(),w("div",Ri,[v("div",Ni,[v("div",ji,[t(T).archived?(p(),w("div",Ki," В архиве ")):K("",!0),r(z,{modelValue:t(T).title,"onUpdate:modelValue":c[1]||(c[1]=Z=>t(T).title=Z),class:"w-full rounded-lg border border-neutral-500/50 px-3 py-2 text-base font-semibold outline-none focus:ring-2 focus:ring-neutral-500 bg-neutral-700 text-neutral-300",placeholder:"Название карточки",onFocus:c[2]||(c[2]=Z=>oe("title")),onBlur:c[3]||(c[3]=Z=>X("title"))},null,8,["modelValue"]),(p(!0),w(pe,null,me(t(T).tracks,Z=>(p(),w("span",{key:Z,class:"text-neutral-300/70 border-1 rounded-sm px-2 border-neutral-500 h-10 flex items-center cursor-pointer",title:`Скопировать трек ${Z}`,onClick:$t=>ge(Z)},D(Z),9,Hi))),128))]),r(ee,null,{default:u(()=>[r(k,null,{default:u(()=>[r(G,{class:"size-9 p-0 border-1 border-neutral-500/50 bg-neutral-700 text-neutral-300 hover:text-neutral-100 hover:bg-neutral-700 cursor-pointer",title:"Действия"},{default:u(()=>[r(t(Tl))]),_:1})]),_:1}),r(re,{class:"bg-neutral-700 text-neutral-300 z-[1111]"},{default:u(()=>[r(P,{class:Ie(["cursor-pointer"]),onClick:c[4]||(c[4]=Z=>se())},{default:u(()=>c[19]||(c[19]=[M("Скопировать ссылку на карточку",-1)])),_:1,__:[19]}),r(C,null,{default:u(()=>[r(J,{class:"cursor-pointer"},{default:u(()=>c[20]||(c[20]=[M(" Скопировать в ... ",-1)])),_:1,__:[20]}),r(le,{class:"bg-neutral-700 text-neutral-300"},{default:u(()=>[(p(!0),w(pe,null,me(t(_),Z=>(p(),N(P,{key:Z.id,class:"cursor-pointer",onClick:$t=>V(Z.id)},{default:u(()=>[M(D(Z.title),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),r(C,null,{default:u(()=>[r(J,{class:"cursor-pointer"},{default:u(()=>c[21]||(c[21]=[M(" Переместить в ... ",-1)])),_:1,__:[21]}),r(le,{class:"bg-neutral-700 text-neutral-300"},{default:u(()=>[(p(!0),w(pe,null,me(t(_),Z=>(p(),N(P,{key:Z.id,class:"cursor-pointer",onClick:$t=>o(Z.id)},{default:u(()=>[M(D(Z.title),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),r(P,{class:"cursor-pointer",onClick:c[5]||(c[5]=Z=>F.value=!0)},{default:u(()=>c[22]||(c[22]=[M("История изменений",-1)])),_:1,__:[22]}),r(P,{class:Ie(["cursor-pointer"]),disabled:t(y),onClick:c[6]||(c[6]=Z=>R(!t(T).archived))},{default:u(()=>[M(D(t(T).archived?"Вернуть из архива":"Переместить в архив"),1)]),_:1},8,["disabled"]),r(P,{class:"cursor-pointer"},{default:u(()=>c[23]||(c[23]=[M("Дублировать карточку",-1)])),_:1,__:[23]}),r(P,{class:"cursor-pointer",onClick:c[7]||(c[7]=Z=>I())},{default:u(()=>c[24]||(c[24]=[M("Удалить карточку",-1)])),_:1,__:[24]})]),_:1})]),_:1}),r(G,{class:"p-0 size-9 border-1 border-neutral-500/50 bg-neutral-700 text-neutral-300 hover:text-neutral-100 hover:bg-neutral-700 cursor-pointer",title:"Закрыть",onClick:c[8]||(c[8]=Z=>A())},{default:u(()=>[r(t(Ze))]),_:1})]),v("div",Wi,[r(wt,{class:"h-full"},{default:u(()=>[v("div",Gi,[v("div",Xi,[r(ca,{modelValue:t(ie),"onUpdate:modelValue":c[16]||(c[16]=Z=>Me(ie)?ie.value=Z:null),"default-value":"main",class:""},{default:u(()=>[r(W,{class:"ml-2 mt-2 bg-neutral-600 text-neutral-300"},{default:u(()=>[r(te,{value:"main",class:"",onClick:j},{default:u(()=>c[25]||(c[25]=[M(" Основное ",-1)])),_:1,__:[25]}),r(te,{value:"prod"},{default:u(()=>c[26]||(c[26]=[M(" ТЗ ",-1)])),_:1,__:[26]}),r(te,{value:"delivery"},{default:u(()=>c[27]||(c[27]=[M(" Доставка ",-1)])),_:1,__:[27]})]),_:1}),r(Ce,{class:"my-2 bg-neutral-500"}),r(nt,{value:"main",class:"p-3"},{default:u(()=>[v("div",Yi,[v("div",Qi,[c[28]||(c[28]=v("span",{class:"font-medium"},"Создатель:",-1)),M(" "+D(t(T).creator?.fullName||t(T).creator?.email||"—"),1)]),v("div",Ji,[c[29]||(c[29]=v("span",{class:"font-medium"},"Создана:",-1)),M(" "+D(("formatRuDateTime"in L?L.formatRuDateTime:t(kt))(t(T).createdAt)||"—"),1)]),v("div",Zi,[r(Ue,{class:"font-light text-neutral-400 absolute left-2 top-[-8px] bg-neutral-700 rounded-sm px-1"},{default:u(()=>c[30]||(c[30]=[M("Участники",-1)])),_:1,__:[30]}),r(Zt,{"task-id":t(T).id,actions:!0},null,8,["task-id"])]),v("div",eu,[r(Ue,{class:"font-light text-neutral-400 absolute left-2 top-[-8px] bg-neutral-700 rounded-sm px-1"},{default:u(()=>[M("Расположение("+D(t(T).board.title)+")",1)]),_:1}),r(ea,{"task-id":L.taskId,"column-id":t(T).columnId,label:t(T).column.title,onUpdateTaskColumn:O},null,8,["task-id","column-id","label"])])]),v("div",tu,[t(T).chatLink?(p(),N(Ue,{key:0,class:"font-light text-neutral-400 absolute left-2 top-[-8px] bg-neutral-700 rounded-sm px-1"},{default:u(()=>c[31]||(c[31]=[M("Ссылка на сделку",-1)])),_:1,__:[31]})):K("",!0),r(z,{modelValue:t(T).chatLink,"onUpdate:modelValue":c[9]||(c[9]=Z=>t(T).chatLink=Z),placeholder:"Ссылка на сделку",class:Ie(["bg-neutral-700 text-neutral-300 placeholder:text-neutral-500 border-neutral-500/50"]),onFocus:c[10]||(c[10]=Z=>oe("chatLink")),onBlur:c[11]||(c[11]=Z=>X("chatLink"))},null,8,["modelValue"]),t(T).chatLink?(p(),w("a",{key:1,href:t(Y),target:"_blank",rel:"noopener",class:"text-xs text-indigo-400 hover:underline whitespace-nowrap",title:"Открыть ссылку в новой вкладке"}," Перейти ",8,au)):K("",!0)]),v("div",lu,[r(Ue,{class:"font-light text-neutral-400 absolute left-2 top-[-8px] bg-neutral-700 rounded-sm px-1 z-1"},{default:u(()=>c[32]||(c[32]=[M("Сделка в системе",-1)])),_:1,__:[32]}),t(T).deal?(p(),N(z,{key:t(T).avaliableDeals.length,placeholder:`'${t(T).deal.title.trim()}' от ${t(T).deal.saleDate.split("-").reverse().join(".")}`,disabled:"",class:Ie(["bg-neutral-700 text-neutral-300 placeholder:text-neutral-300 border-neutral-500/50"])},null,8,["placeholder"])):K("",!0),t(T).deal?K("",!0):(p(),N(sa,{key:1,disabled:t(x),"onUpdate:modelValue":$e},{default:u(()=>[r(aa,{class:Ie(["cursor-pointer bg-neutral-700 text-red-500 placeholder:text-neutral-500 border-neutral-500/50",t(x)?"opacity-60 cursor-progress":""])},{default:u(()=>[r(ta,{class:"placeholder:text-neutral-600",placeholder:"Связать со сделкой"})]),_:1},8,["class"]),r(oa,{class:"bg-neutral-700 text-neutral-300 placeholder:text-neutral-500 border-neutral-500/50"},{default:u(()=>[r(na,null,{default:u(()=>[(p(!0),w(pe,null,me(t(T).avaliableDeals,Z=>(p(),N(la,{key:Z.id,value:Z.id.toString()},{default:u(()=>[M(' Связать с "'+D(Z.title)+'" от '+D(Z.saleDate.split("-").reverse().join(".")),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["disabled"]))]),v("div",nu,[r(Ue,{class:"font-light text-neutral-400 absolute left-2 top-[-8px] bg-neutral-700 rounded-sm px-1"},{default:u(()=>c[33]||(c[33]=[M("Метки",-1)])),_:1,__:[33]}),r(ra,{modelValue:t(S),"onUpdate:modelValue":c[12]||(c[12]=Z=>Me(S)?S.value=Z:null),"board-id":t(T).board.id,"task-id":L.taskId,"initial-selected":t(T).tags.map(Z=>Z.name),warnings:t(T).warnings},null,8,["modelValue","board-id","task-id","initial-selected","warnings"])]),v("div",{ref_key:"descWrap",ref:ke,class:"relative mt-5"},[t(T).description?(p(),N(Ue,{key:0,class:"font-light text-neutral-400 absolute left-2 top-[-8px] bg-neutral-700 rounded-sm px-1"},{default:u(()=>c[34]||(c[34]=[M("Описание",-1)])),_:1,__:[34]})):K("",!0),Lt(r(ia,{modelValue:t(T).description,"onUpdate:modelValue":c[13]||(c[13]=Z=>t(T).description=Z),rows:"1",class:"resize-none overflow-hidden mt-1 min-h-[200px] w-full rounded-sm border bg-neutral-700 text-neutral-300 placeholder:text-neutral-500 border-neutral-500/50 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Опишите задачу",onFocus:c[14]||(c[14]=Z=>oe("description")),onBlur:c[15]||(c[15]=Z=>X("description"))},null,8,["modelValue"]),[[t(Jt)]])],512)]),_:1}),r(nt,{value:"delivery",class:"h-full px-3 pt-3"},{default:u(()=>[r(ua,{"task-id":L.taskId,"initial-deliveries":t(T).deliveries,onChanged:j},null,8,["task-id","initial-deliveries"])]),_:1}),r(nt,{value:"prod",class:"h-full px-3 pt-3"},{default:u(()=>[r(da,{"task-id":L.taskId},null,8,["task-id"])]),_:1})]),_:1},8,["modelValue"])]),v("aside",ou,[(p(),N(pa,{key:t(T).id,"task-id":t(T).id,cover:t(T).cover,onCoverSet:ye},null,8,["task-id","cover"]))])])]),_:1})])])):K("",!0),r(_a,{open:t(F),"onUpdate:open":c[18]||(c[18]=Z=>Me(F)?F.value=Z:null)},{default:u(()=>[r(fa,{class:"hidden"}),r(ba,{"z-index":70,class:"max-w-3xl bg-neutral-800 border-neutral-700",onOpenAutoFocus:c[17]||(c[17]=Z=>Z.preventDefault())},{default:u(()=>[r(ha,null,{default:u(()=>[r(ma,{class:"text-neutral-300"},{default:u(()=>c[35]||(c[35]=[M("История изменений",-1)])),_:1,__:[35]}),r(va)]),_:1}),r(wt,{class:"h-[calc(100vh-300px)]"},{default:u(()=>[v("div",su,[r(ga,{"task-id":t(T)?.id||0,refreshable:""},null,8,["task-id"])])]),_:1}),r(ya)]),_:1})]),_:1},8,["open"])])])):K("",!0)])}}});export{to as _,Yt as a,Vl as b,qu as c,Bt as u};
