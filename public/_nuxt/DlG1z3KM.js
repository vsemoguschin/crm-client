import we from"./ROxBBV8N.js";import{u as ke}from"./CssJESp-.js";import{e as Ce,r as M,v as d,B as se,c as y,a as n,b as g,F as E,z as O,A as w,t as $,D as G,w as le,N as F,o as v,m as C}from"./BbheI0mw.js";import{_ as Se}from"./DlAUqK2U.js";import"./s39mgViW.js";const Me={class:"editor-page h-screen overflow-hidden bg-[#1b1b1b] text-white flex flex-col"},Ee={class:"flex flex-wrap items-center gap-3 justify-between px-6 py-3 bg-[#1f1f1f] border-b border-[#2a2a2a] shadow-lg"},Oe={class:"flex items-center gap-2"},Re={class:"toolbar-button","aria-label":"Назад"},Ne={class:"flex items-center gap-1 overflow-x-auto pr-2 max-w-full"},ze=["onClick"],Fe={class:"flex items-center gap-2"},We=["disabled"],Le=["disabled"],Ie={class:"flex flex-1 min-h-0 overflow-hidden"},Pe={class:"side-rail border-r border-[#2a2a2a]"},Ae={class:"flex flex-col items-center gap-4"},Be={class:"rail-round","aria-label":"Добавить элемент"},Ye={class:"rail-round muted","aria-label":"Заблокировано"},Te={class:"flex flex-col items-center gap-3"},Ze=["disabled"],He={class:"zoom-track"},Xe=["value"],De={class:"zoom-label"},$e=["disabled"],Ge={class:"canvas-region"},Ve=["disabled"],je={key:0,class:"workspace"},Ke={class:"workspace-inner"},Ue={class:"canvas"},qe={class:"spread-template"},Je={class:"spread-label"},Qe=["disabled"],et={class:"side-rail border-l border-[#2a2a2a]"},tt={class:"flex flex-col items-center gap-4"},at=["disabled"],nt={class:"flex flex-col items-center gap-4"},st={class:"rail-round muted","aria-label":"Настройки"},l=2740,s=1e3,A="rgba(0, 255, 255, 0.7)",lt="rgba(255, 64, 128, 0.75)",oe="rgba(255, 255, 255, 0.45)",B=100,Y=300,ot=Ce({__name:"index",setup(ct){const T=e=>{const a=["cyan","blue","magenta"],t=e===0?"cyan":a[e%a.length];return{id:e,type:e===0?"cover":"spread",label:e===0?"Обратная сторона - Лицевая сторона":`Разворот ${e}`,accent:t}},m=M(Array.from({length:12},(e,a)=>T(a))),h=M(Math.min(2,m.value.length-1)),_=M(125),R=M(null),{width:W,height:L}=ke(R),Z={cyan:"rgba(0, 192, 255, 0.9)",blue:"rgba(64, 112, 255, 0.9)",magenta:"rgba(255, 82, 150, 0.9)"},V=l*.01,x=d(()=>m.value[h.value]),H=d(()=>h.value>0),X=d(()=>h.value<m.value.length-1),N=d(()=>h.value>0&&m.value.length>1),D=d(()=>m.value.length<24),ce=d(()=>Number(_.value)/100),k=d(()=>x.value?.type==="cover"),p=M({x:0,y:0}),j=M(null),K=d(()=>{const e=W.value||l,a=L.value||s;return e===0||a===0?1:Math.min(e/l,a/s)}),z=d(()=>K.value*ce.value);se([W,L],([e,a])=>{if(!e||!a)return;const t=j.value;t?p.value=S({x:p.value.x+(e-t.width)/2,y:p.value.y+(a-t.height)/2},z.value):p.value=S({x:e/2,y:a/2},z.value),j.value={width:e,height:a}},{immediate:!0});const ie=d(()=>({width:l,height:s,scaleX:z.value,scaleY:z.value,x:p.value.x,y:p.value.y,offsetX:l/2,offsetY:s/2})),re=d(()=>({x:0,y:0,width:l,height:s,fill:"#ffffff",cornerRadius:18,listening:!1})),U=d(()=>k.value?{x:16,y:16,width:l-32,height:s-32,stroke:A,strokeWidth:3,cornerRadius:12,listening:!1}:null),ue=d(()=>{if(!k.value)return[];const e=16,a=V,t=l/2;return[{points:[t-a,e,t-a,s-e],stroke:A,strokeWidth:2,lineCap:"round",listening:!1},{points:[t+a,e,t+a,s-e],stroke:A,strokeWidth:2,lineCap:"round",listening:!1}]}),de=d(()=>{if(!x.value||k.value)return[];const e=24,a=Math.max(8,s*.015);return[{x:e,y:e,width:l-e*2,height:s-e*2,stroke:lt,strokeWidth:a,cornerRadius:18,listening:!1}]}),ve=d(()=>{if(!x.value||k.value)return[];const e=Z[x.value.accent],a=l*.07,t=s*.11,o=l*.018,i=(l-a*2-o)/2,r=s-t*2,u=Math.max(4,s*.006);return[{x:a,y:t,width:i,height:r,stroke:e,strokeWidth:u,cornerRadius:16,listening:!1},{x:a+i+o,y:t,width:i,height:r,stroke:e,strokeWidth:u,cornerRadius:16,listening:!1}]}),he=d(()=>{if(!x.value||k.value)return[];const e=Z[x.value.accent],a=l*.11,t=s*.16,o=l*.02,i=(l-a*2-o)/2,r=s-t*2,u=Math.max(2,s*.0045);return[{x:a,y:t,width:i,height:r,stroke:e,strokeWidth:u,dash:[16,12],cornerRadius:14,fill:oe,listening:!1},{x:a+i+o,y:t,width:i,height:r,stroke:e,strokeWidth:u,dash:[16,12],cornerRadius:14,fill:oe,listening:!1}]}),q=d(()=>{if(!x.value||k.value)return null;const e=s*.08;return{points:[l/2,e,l/2,s-e],stroke:Z[x.value.accent],strokeWidth:4,lineCap:"round",listening:!1}}),fe=d(()=>{if(!k.value)return[];const e={fontFamily:"Inter, sans-serif",fontSize:14,fill:A,letterSpacing:2},a=l*.02,t=s*.035,o=s*.06;return[{...e,text:"Линия обрезки",x:a,y:t},{...e,text:"Линия обрезки",width:l-a*2,x:a,y:t,align:"right"},{...e,text:"Корешок",x:l/2+V+10,y:s/2-s*.08,rotation:90},{...e,text:"Обратная сторона - Лицевая сторона",x:0,width:l,y:s-o,align:"center"}]}),J=()=>{m.value=m.value.map((e,a)=>T(a))},ge=e=>{h.value=e},_e=()=>{H.value&&(h.value-=1)},me=()=>{X.value&&(h.value+=1)},Q=()=>{D.value&&(m.value.splice(h.value+1,0,T(h.value+1)),J(),h.value+=1)},ee=()=>{N.value&&(m.value.splice(h.value,1),h.value>=m.value.length&&(h.value=m.value.length-1),J())},pe=e=>Math.min(Y,Math.max(B,Math.round(e))),te=e=>{if(e)return e;const a=W.value||l,t=L.value||s;return{x:a/2,y:t/2}},S=(e,a)=>{const t=W.value||l,o=L.value||s,i=l*a/2,r=s*a/2;let u=e.x,b=e.y;return Number.isFinite(u)||(u=t/2),Number.isFinite(b)||(b=o/2),t<=i*2||i===0?u=t/2:u=Math.min(Math.max(u,i),t-i),o<=r*2||r===0?b=o/2:b=Math.min(Math.max(b,r),o-r),{x:u,y:b}},I=(e,a)=>{const t=pe(e),o=_.value;if(t===o)return;const i=t>o?"in":"out",r=K.value,u=z.value,b=te(),f=r*(t/100);if(i==="out"){p.value=S(b,f),_.value=t;return}if(r===0||u===0){p.value=S(b,f),_.value=t;return}const c=te(a);if(Number.isFinite(c.x)&&Number.isFinite(c.y)){const P=r*(t/100),ne={x:(c.x-p.value.x)/u,y:(c.y-p.value.y)/u};p.value=S({x:c.x-ne.x*P,y:c.y-ne.y*P},P)}else p.value=S(b,f);_.value=t},be=()=>{I(_.value+5)},xe=()=>{I(_.value-5)},ye=e=>{const a=Number(e.target.value);I(a)},ae=e=>{if(!R.value)return;e.preventDefault(),e.stopPropagation();const a=R.value.getBoundingClientRect(),t={x:e.clientX-a.left,y:e.clientY-a.top},o=e.deltaY>0?-1:1,i=Math.max(1,Math.round(Math.abs(e.deltaY)/20)),r=e.altKey?1:Math.min(10,i*2);I(_.value+o*r,t)};return se(()=>R.value,(e,a)=>{a&&a.removeEventListener("wheel",ae),e&&e.addEventListener("wheel",ae,{passive:!1})}),(e,a)=>{const t=we,o=F("v-rect"),i=F("v-line"),r=F("v-text"),u=F("v-layer"),b=F("v-stage");return v(),y("div",Me,[n("header",Ee,[n("div",Oe,[n("button",Re,[g(t,{name:"lucide:chevron-left",class:"w-5 h-5"})])]),n("nav",Ne,[(v(!0),y(E,null,O(m.value,(f,c)=>(v(),y("button",{key:f.id,class:w(["page-tab",{"bg-[#f4f4f4] text-black font-semibold shadow-[0_0_0_1px_rgba(0,0,0,0.4)]":c===h.value,"bg-[#2b2b2b] text-[#9b9b9b] hover:text-white hover:bg-[#353535]":c!==h.value}]),onClick:P=>ge(c)},$(c),11,ze))),128))]),n("div",Fe,[n("button",{class:w(["circle-action",{"opacity-60 cursor-not-allowed":!D.value}]),disabled:!D.value,onClick:Q,"aria-label":"Добавить разворот"},[g(t,{name:"lucide:plus",class:"w-5 h-5"})],10,We),n("button",{class:w(["circle-action",{"opacity-40 cursor-not-allowed":!N.value}]),disabled:!N.value,onClick:ee,"aria-label":"Удалить разворот"},[g(t,{name:"lucide:minus",class:"w-5 h-5"})],10,Le)])]),n("div",Ie,[n("aside",Pe,[n("div",Ae,[n("button",Be,[g(t,{name:"lucide:plus",class:"w-5 h-5"})]),n("button",Ye,[g(t,{name:"lucide:circle",class:"w-4 h-4"})])]),n("div",Te,[n("button",{class:w(["rail-zoom",{muted:_.value>=Y}]),disabled:_.value>=Y,"aria-label":"Увеличить",onClick:be},[g(t,{name:"lucide:zoom-in",class:"w-4 h-4"})],10,Ze),n("div",He,[n("input",{value:_.value,class:"zoom-slider",type:"range",min:B,max:Y,step:"1","aria-label":"Масштаб",onInput:ye},null,40,Xe),n("span",De,$(_.value)+"%",1)]),n("button",{class:w(["rail-zoom",{muted:_.value<=B}]),disabled:_.value<=B,"aria-label":"Уменьшить",onClick:xe},[g(t,{name:"lucide:zoom-out",class:"w-4 h-4"})],10,$e)])]),n("div",Ge,[n("button",{class:w(["nav-arrow left",{"opacity-40 cursor-not-allowed":!H.value}]),disabled:!H.value,"aria-label":"Предыдущий разворот",onClick:_e},[g(t,{name:"lucide:chevron-left",class:"w-5 h-5"})],10,Ve),n("main",{ref_key:"canvasMainRef",ref:R,class:"canvas-main"},[x.value?(v(),y("div",je,[n("div",Ke,[n("div",Ue,[n("div",qe,[g(b,{config:ie.value,style:{width:"100%",height:"100%"}},{default:le(()=>[g(u,null,{default:le(()=>[g(o,{config:re.value},null,8,["config"]),U.value?(v(),C(o,{key:0,config:U.value},null,8,["config"])):G("",!0),(v(!0),y(E,null,O(de.value,(f,c)=>(v(),C(o,{key:`bleed-${c}`,config:f},null,8,["config"]))),128)),(v(!0),y(E,null,O(ve.value,(f,c)=>(v(),C(o,{key:`frame-${c}`,config:f},null,8,["config"]))),128)),(v(!0),y(E,null,O(he.value,(f,c)=>(v(),C(o,{key:`placeholder-${c}`,config:f},null,8,["config"]))),128)),(v(!0),y(E,null,O(ue.value,(f,c)=>(v(),C(i,{key:`cover-spine-${c}`,config:f},null,8,["config"]))),128)),q.value?(v(),C(i,{key:1,config:q.value},null,8,["config"])):G("",!0),(v(!0),y(E,null,O(fe.value,(f,c)=>(v(),C(r,{key:`cover-text-${c}`,config:f},null,8,["config"]))),128))]),_:1})]),_:1},8,["config"])])]),n("div",Je,$(x.value.label),1)])])):G("",!0)],512),n("button",{class:w(["nav-arrow right",{"opacity-40 cursor-not-allowed":!X.value}]),disabled:!X.value,"aria-label":"Следующий разворот",onClick:me},[g(t,{name:"lucide:chevron-right",class:"w-5 h-5"})],10,Qe)]),n("aside",et,[n("div",tt,[n("button",{class:"rail-round","aria-label":"Добавить разворот",onClick:Q},[g(t,{name:"lucide:plus",class:"w-5 h-5"})]),n("button",{class:w(["rail-round",{muted:!N.value}]),disabled:!N.value,"aria-label":"Удалить текущий разворот",onClick:ee},[g(t,{name:"lucide:minus",class:"w-5 h-5"})],10,at)]),n("div",nt,[n("button",st,[g(t,{name:"lucide:ellipsis",class:"w-5 h-5"})])])])])])}}}),ht=Se(ot,[["__scopeId","data-v-158e0847"]]);export{ht as default};
