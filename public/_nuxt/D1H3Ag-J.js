import{_ as J}from"./Bmr5wyhr.js";import{_ as K}from"./mqOaxR0N.js";import{_ as Q,b as X,a as Y}from"./CNLsaPwj.js";import{_ as Z}from"./BCRlC5xu.js";import{_ as ee}from"./fRExJa2e.js";import{_ as te}from"./CP8umD4q.js";import{b as A,c as B,a as I,d as P,e as V,_ as O}from"./Df1Q6CGn.js";import{u as E}from"./Dt19OLxm.js";import{e as S,g as W,r as x,B as ne,m as F,w as t,o as _,b as e,d as o,t as c,c as m,l as u,F as L,z as R,a as v,i as z,u as oe,H as j}from"./LcRD3ia0.js";import{_ as se,a as le,b as ae}from"./DkMjgWCi.js";import{_ as re}from"./CY7rJOej.js";import{_ as q}from"./DnQg8zF_.js";import{_ as G}from"./Da2JRHOT.js";import{_ as _e}from"./DlAUqK2U.js";import"./D8Osd5Ax.js";import"./DfRdkKc3.js";import"./D5ydJhlK.js";import"./D9TSNOAg.js";import"./DkkQ8vn7.js";import"./D8EW8v7U.js";import"./BdQOAs7V.js";import"./BOGtf0gU.js";import"./QkXyQO2w.js";import"./D6LOIvye.js";const ie={key:0,class:"text-gray-500"},ue={key:1},ce={key:2,class:"text-gray-500"},de=S({__name:"StatsCard",props:{period:{}},setup(M){const{$useApi:k}=W(),w=M,p=x([]),y=x(!1),s=x(null),T=async d=>{y.value=!0,s.value=null;try{const{data:a}=await k.get("wb/orders-stat",{params:{period:d}});p.value=a}catch(a){s.value=a.data||{message:a.message||"Failed to fetch orders"},console.error("Error fetching orders:",a)}finally{y.value=!1}};return ne(()=>w.period,d=>{T(d)},{immediate:!0}),(d,a)=>{const n=X,l=Z,f=Y,i=P,$=I,b=B,g=O,C=V,h=A,D=ee,r=te,H=Q;return _(),F(H,null,{default:t(()=>[e(f,null,{default:t(()=>[e(n,null,{default:t(()=>a[0]||(a[0]=[o("Статистика",-1)])),_:1,__:[0]}),e(l,null,{default:t(()=>[o("За период "+c(d.period),1)]),_:1})]),_:1}),e(D,null,{default:t(()=>[u(y)?(_(),m("div",ie,"Загрузка статистики...")):u(p).length?(_(),m("div",ue,[e(h,null,{default:t(()=>[e(b,null,{default:t(()=>[e($,null,{default:t(()=>[e(i,null,{default:t(()=>a[1]||(a[1]=[o("Статус",-1)])),_:1,__:[1]}),e(i,{class:"text-right"},{default:t(()=>a[2]||(a[2]=[o("Кол-во",-1)])),_:1,__:[2]}),e(i,{class:"text-right"},{default:t(()=>a[3]||(a[3]=[o("Сумма, ₽",-1)])),_:1,__:[3]})]),_:1})]),_:1}),e(C,null,{default:t(()=>[(_(!0),m(L,null,R(u(p),U=>(_(),F($,{key:U.status},{default:t(()=>[e(g,null,{default:t(()=>[o(c(U.status),1)]),_:2},1024),e(g,{class:"text-right"},{default:t(()=>[o(c(U.count),1)]),_:2},1024),e(g,{class:"text-right"},{default:t(()=>[o(c(("useMyFormatPrice"in d?d.useMyFormatPrice:u(E))(+U.totalPrice.toFixed(2))),1)]),_:2},1024)]),_:2},1024))),128)),e($,null,{default:t(()=>[e(g,{class:"font-bold"},{default:t(()=>a[4]||(a[4]=[o("Итого",-1)])),_:1,__:[4]}),e(g,{class:"text-right font-bold"},{default:t(()=>[o(c(u(p).reduce((U,N)=>U+N.count,0)),1)]),_:1}),e(g,{class:"text-right font-bold"},{default:t(()=>[o(c(("useMyFormatPrice"in d?d.useMyFormatPrice:u(E))(+u(p).reduce((U,N)=>U+N.totalPrice,0).toFixed(2))),1)]),_:1})]),_:1})]),_:1})]),_:1})])):(_(),m("div",ce,"Статистика не найдена."))]),_:1}),e(r,null,{default:t(()=>a[5]||(a[5]=[v("span",{class:"text-sm text-gray-500"},"Данные за выбранный месяц",-1)])),_:1,__:[5]})]),_:1})}}}),fe={key:0,class:"text-gray-500"},me={key:1,class:"w-full overflow-auto bg-slate-100 rounded-md"},pe={class:"flex flex-col"},ge={class:"font-bold"},ve={key:2,class:"text-gray-500"},we=S({__name:"WaitingOrders",setup(M){const{$useApi:k}=W(),w=x([]),p=x(0),y=x(!1),s=x(null),T=n=>{const l=new Date(n),i=new Date().getTime()-l.getTime();return Math.floor(i/(1e3*60*60))},d=async()=>{y.value=!0,s.value=null;try{const{data:n}=await k.get("wb/waiting-orders");w.value=n.orders,p.value=n.next||0}catch(n){s.value=n.data||{message:n.message||"Failed to fetch orders"},console.error("Error fetching orders:",n)}finally{y.value=!1}},a=n=>{n?window.open(n,"_blank"):console.error("URL отсутствует")};return z(()=>{d()}),(n,l)=>{const f=P,i=I,$=B,b=O,g=q,C=G,h=V,D=A;return _(),m("div",null,[u(y)?(_(),m("div",fe,"Загрузка заказов...")):u(w).length?(_(),m("div",me,[e(D,null,{default:t(()=>[e($,{class:"bg-white"},{default:t(()=>[e(i,null,{default:t(()=>[e(f,null,{default:t(()=>l[0]||(l[0]=[o("Номер",-1)])),_:1,__:[0]}),e(f,{class:"text-center"},{default:t(()=>l[1]||(l[1]=[o("Изображение",-1)])),_:1,__:[1]}),e(f,null,{default:t(()=>l[2]||(l[2]=[o("Название",-1)])),_:1,__:[2]}),e(f,{class:"text-center"},{default:t(()=>l[3]||(l[3]=[o("Стоимость",-1)])),_:1,__:[3]})]),_:1})]),_:1}),e(h,null,{default:t(()=>[(_(!0),m(L,null,R(u(w),r=>(_(),F(i,{key:r.id},{default:t(()=>[e(b,null,{default:t(()=>[v("div",pe,[v("span",null,c(r.id),1),v("span",ge,c(T(r.createdAt))+" ч. назад ",1),v("span",null," от "+c(new Date(r.createdAt).toLocaleString().slice(0,10)),1)])]),_:2},1024),e(b,null,{default:t(()=>[e(g,{src:r.preview,alt:"Preview",width:"50",height:"50",class:"object-cover rounded cursor-pointer m-auto",onClick:H=>a(r.preview)},null,8,["src","onClick"])]),_:2},1024),e(b,null,{default:t(()=>[o(c(r.article),1)]),_:2},1024),e(b,{class:"text-center"},{default:t(()=>[o(c(r.price)+"р.",1)]),_:2},1024)]),_:2},1024))),128)),e(C)]),_:1})]),_:1})])):(_(),m("div",ve,"Заказы не найдены."))])}}}),be={key:0,class:"text-gray-500"},xe={key:1,class:"w-full overflow-auto bg-slate-100 rounded-md"},ye={class:"flex flex-col"},$e={class:"font-bold"},Ue={key:2,class:"text-gray-500"},Te=S({__name:"newOrders",setup(M){const{$useApi:k}=W(),w=x([]),p=x(0),y=x(!1),s=x(null),T=n=>{const l=new Date(n),i=new Date().getTime()-l.getTime();return Math.floor(i/(1e3*60*60))},d=async()=>{y.value=!0,s.value=null;try{const{data:n}=await k.get("wb/new-orders");w.value=n.orders,p.value=n.next||0}catch(n){s.value=n.data||{message:n.message||"Failed to fetch orders"},console.error("Error fetching orders:",n)}finally{y.value=!1}},a=n=>{n?window.open(n,"_blank"):console.error("URL отсутствует")};return z(()=>{d()}),(n,l)=>{const f=P,i=I,$=B,b=O,g=q,C=G,h=V,D=A;return _(),m("div",null,[u(y)?(_(),m("div",be,"Загрузка заказов...")):u(w).length?(_(),m("div",xe,[e(D,null,{default:t(()=>[e($,{class:"bg-white"},{default:t(()=>[e(i,null,{default:t(()=>[e(f,null,{default:t(()=>l[0]||(l[0]=[o("Номер",-1)])),_:1,__:[0]}),e(f,{class:"text-center"},{default:t(()=>l[1]||(l[1]=[o("Изображение",-1)])),_:1,__:[1]}),e(f,null,{default:t(()=>l[2]||(l[2]=[o("Название",-1)])),_:1,__:[2]}),e(f,{class:"text-center"},{default:t(()=>l[3]||(l[3]=[o("Стоимость",-1)])),_:1,__:[3]})]),_:1})]),_:1}),e(h,null,{default:t(()=>[(_(!0),m(L,null,R(u(w),r=>(_(),F(i,{key:r.id},{default:t(()=>[e(b,null,{default:t(()=>[v("div",ye,[v("span",null,c(r.id),1),v("span",$e,c(T(r.createdAt))+" ч. назад ",1),v("span",null," от "+c(new Date(r.createdAt).toLocaleString().slice(0,10)),1)])]),_:2},1024),e(b,null,{default:t(()=>[e(g,{src:r.preview,alt:"Preview",width:"50",height:"50",class:"object-cover rounded cursor-pointer m-auto",onClick:H=>a(r.preview)},null,8,["src","onClick"])]),_:2},1024),e(b,null,{default:t(()=>[o(c(r.article),1)]),_:2},1024),e(b,{class:"text-center"},{default:t(()=>[o(c(r.price)+"р.",1)]),_:2},1024)]),_:2},1024))),128)),e(C)]),_:1})]),_:1})])):(_(),m("div",Ue,"Заказы не найдены."))])}}}),ke={class:"relative h-screen hidden-scrollbar"},Ce={class:"w-full fixed z-10"},he={class:"h-full flex flex-col p-4 gap-2 mx-[auto] max-w-[2048px] pt-16 min-w-[1024px]"},De={class:"flex gap-4"},Me={class:"flex flex-col gap-2"},Fe={class:"w-full"},Se=S({__name:"index",setup(M){const{$useApi:k}=W();oe({title:"WB | Easy CRM"});const w=x("new"),p=x(new Date().toISOString().slice(0,7));return(y,s)=>{const T=J,d=K,a=de,n=ae,l=le,f=we,i=re,$=Te,b=se;return _(),m("div",ke,[v("div",Ce,[e(T)]),v("div",he,[v("div",De,[v("div",Me,[e(d,{modelValue:u(p),"onUpdate:modelValue":s[0]||(s[0]=g=>j(p)?p.value=g:null),type:"month",class:"w-[180px] z-10"},null,8,["modelValue"]),e(a,{period:u(p)},null,8,["period"])]),v("div",Fe,[e(b,{modelValue:u(w),"onUpdate:modelValue":s[1]||(s[1]=g=>j(w)?w.value=g:null)},{default:t(()=>[e(l,null,{default:t(()=>[e(n,{value:"waiting"},{default:t(()=>s[2]||(s[2]=[o(" В работе ",-1)])),_:1,__:[2]}),e(n,{value:"new"},{default:t(()=>s[3]||(s[3]=[o(" Новые ",-1)])),_:1,__:[3]}),e(n,{value:"supplies"},{default:t(()=>s[4]||(s[4]=[o(" На сборке ",-1)])),_:1,__:[4]}),e(n,{value:"delivery"},{default:t(()=>s[5]||(s[5]=[o(" В доставке ",-1)])),_:1,__:[5]}),e(n,{value:"archive"},{default:t(()=>s[6]||(s[6]=[o(" Архив ",-1)])),_:1,__:[6]}),e(n,{value:"canceled"},{default:t(()=>s[7]||(s[7]=[o(" Отменнённые ",-1)])),_:1,__:[7]})]),_:1}),e(i,{value:"waiting"},{default:t(()=>[e(f)]),_:1}),e(i,{value:"new"},{default:t(()=>[e($)]),_:1})]),_:1},8,["modelValue"])])])])])}}}),nt=_e(Se,[["__scopeId","data-v-15ae57a3"]]);export{nt as default};
