import{_ as B}from"./CDst0A0O.js";import{_ as ke,a as $e,b as Ce,c as Fe,d as De}from"./cStEOrWd.js";import{_ as Ie}from"./BHuR11Jx.js";import{_ as Me}from"./DiZ4QL0M.js";import{_ as re}from"./C30fSUvl.js";import{_ as de}from"./CprHmdOe.js";import{_ as pe}from"./C-JUEUN9.js";import{_ as ce,a as me,b as _e,c as fe,d as ve}from"./JYeLPbKT.js";import{_ as ge}from"./DLLw9AXE.js";import{_ as we}from"./CHKwxJtM.js";import{_ as ne,a as Te}from"./DVdymwQ5.js";import{e as te,g as ye,r as z,B as ee,c as g,b as e,w as t,o as n,d as o,a as r,m as b,D as M,A as N,F as V,z as F,t as I,v as oe,l as K,E as qe,G as f}from"./BbheI0mw.js";import{_ as Pe}from"./BWn7SjA7.js";import{_ as be,a as he,b as xe}from"./DAmwS8V7.js";import{_ as Be,a as Ne,b as Ae,c as Le,d as Ke,e as Re}from"./DAy9nm00.js";import{C as je,_ as ze}from"./DFFUo3JN.js";import{c as ue,v as se}from"./B9M8ggfK.js";import{C as He}from"./_14b2CUj.js";import{X as Ee}from"./oLxPQbNe.js";import{_ as Ge}from"./DImM_Wqr.js";import{b as Oe,c as Xe,d as Je,e as Qe,_ as We,a as Ye}from"./C6vK2VYI.js";import{u as Ze,F as ie,g as et,a as tt,b as lt}from"./lvbecDJM.js";import{C as at}from"./CJOOd8Dx.js";import{u as st}from"./Dt19OLxm.js";import{A as G}from"./Boz4PYjF.js";const ot={class:"flex gap-5"},nt={class:"flex flex-col gap-5 min-w-[350px]"},ut={class:"flex gap-2"},it={class:"relative w-full"},rt={class:"relative w-full"},dt={class:"relative"},pt={class:"relative w-full"},ct={class:"relative w-full"},mt={class:"relative w-full"},_t={class:"relative w-full"},ft={class:"relative"},vt={class:"relative"},gt={class:"flex flex-col grow"},wt={class:"w-full grow"},yt={class:"flex flex-col p-2 gap-5"},bt={class:"relative w-full"},ht={class:"relative"},xt={class:"relative"},Vt={class:"relative w-full"},St={class:"flex justify-between w-full"},Ul=te({__name:"Create",props:{suppliers:{},positionsList:{}},emits:["supplie-created"],setup(l,{emit:v}){const{$useApi:_}=ye(),m=z(["Поликарбонат","Неон","Блоки питания","Пленки","Акрил","Упаковка","Комплектующие для станков","Комплектующие для мастеров","Комплектующие для упаковки","Другое"]),w=["Счет","Перевод","Наличка"],S=["Оформлен заказ","В пути","Отгружен нам"],D=["Оплачен","Не оплачен"],y=["Доставка от поставщика","Сдек","Самовывоз","Курьерская доставка","ПЭК","Деловые Линии"],T=()=>({date:new Date().toISOString().slice(0,10),shipmentDate:"",supplier:"",paymentMethod:w[0],orderStatus:S[0],paymentStatus:D[0],deliveryMethod:y[0],invoice:"",track:"",positions:[{name:"",quantity:1,priceForItem:0,category:""}]}),U=z(!0);z(!1);const u=z(!1),d=z(T()),X=()=>{d.value.positions.push({name:"",quantity:1,priceForItem:1,category:""})},J=$=>{d.value.positions.length>1&&d.value.positions.splice($,1)},Q=async()=>{try{U.value=!0,await _.post("supplies/",d.value),d.value=T(),W("supplie-created"),u.value=!1}catch($){console.log($)}},W=v;return ee(d,()=>{const{date:$,supplier:a,positions:s}=d.value;U.value=!($&&a&&s.length>0&&s.every(c=>c.name&&c.category&&c.quantity>0&&c.priceForItem>0)&&/^\d{4}-\d{2}-\d{2}$/.test($))},{deep:!0}),ee(u,$=>{$||(d.value=T())}),($,a)=>{const s=B,c=$e,C=De,O=Ie,R=Fe,k=re,A=de,h=pe,x=_e,j=me,H=ve,Y=ge,i=fe,q=ce,P=we,Z=ne,ae=Me,Ve=Ce,Se=ke;return n(),g("div",null,[e(Se,{open:u.value,"onUpdate:open":a[9]||(a[9]=p=>u.value=p)},{default:t(()=>[e(c,{"as-child":""},{default:t(()=>[e(s,null,{default:t(()=>a[10]||(a[10]=[o("Создать",-1)])),_:1,__:[10]})]),_:1}),e(Ve,{class:"max-w-[1200px] flex flex-col"},{default:t(()=>[e(R,null,{default:t(()=>[e(C,null,{default:t(()=>a[11]||(a[11]=[o("Статья",-1)])),_:1,__:[11]}),e(O)]),_:1}),r("div",ot,[r("div",nt,[r("div",ut,[r("div",it,[d.value.date?(n(),b(k,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[12]||(a[12]=[o("Дата заказа",-1)])),_:1,__:[12]})):M("",!0),e(A,{modelValue:d.value.date,"onUpdate:modelValue":a[0]||(a[0]=p=>d.value.date=p),type:"date",placeholder:"Дата",class:N(d.value.date?"":"outline outline-1 outline-rose-300")},null,8,["modelValue","class"])]),r("div",rt,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[13]||(a[13]=[o("Дата отгрузки",-1)])),_:1,__:[13]}),e(A,{modelValue:d.value.shipmentDate,"onUpdate:modelValue":a[1]||(a[1]=p=>d.value.shipmentDate=p),type:"date",placeholder:"Дата"},null,8,["modelValue"])])]),r("div",dt,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>a[14]||(a[14]=[o("Поставщик (организация)",-1)])),_:1,__:[14]}),e(h,{items:$.suppliers,label:d.value.supplier,class:N(d.value.supplier?"":"outline-1 outline-rose-300 rounded-md"),onSelectedItem:a[2]||(a[2]=p=>d.value.supplier=p)},null,8,["items","label","class"])]),r("div",pt,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[15]||(a[15]=[o("Как оплатили",-1)])),_:1,__:[15]}),e(q,{modelValue:d.value.paymentMethod,"onUpdate:modelValue":a[3]||(a[3]=p=>d.value.paymentMethod=p)},{default:t(()=>[e(j,null,{default:t(()=>[e(x,{placeholder:d.value.paymentMethod},null,8,["placeholder"])]),_:1}),e(i,null,{default:t(()=>[(n(),g(V,null,F(w,(p,E)=>e(Y,{key:E},{default:t(()=>[e(H,{value:p},{default:t(()=>[o(I(p),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),r("div",ct,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[16]||(a[16]=[o("Статус заказа",-1)])),_:1,__:[16]}),e(q,{modelValue:d.value.orderStatus,"onUpdate:modelValue":a[4]||(a[4]=p=>d.value.orderStatus=p)},{default:t(()=>[e(j,null,{default:t(()=>[e(x,{placeholder:d.value.orderStatus},null,8,["placeholder"])]),_:1}),e(i,null,{default:t(()=>[(n(),g(V,null,F(S,(p,E)=>e(Y,{key:E},{default:t(()=>[e(H,{value:p},{default:t(()=>[o(I(p),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),r("div",mt,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[17]||(a[17]=[o("Статус оплаты",-1)])),_:1,__:[17]}),e(q,{modelValue:d.value.paymentStatus,"onUpdate:modelValue":a[5]||(a[5]=p=>d.value.paymentStatus=p)},{default:t(()=>[e(j,null,{default:t(()=>[e(x,{placeholder:d.value.paymentStatus},null,8,["placeholder"])]),_:1}),e(i,null,{default:t(()=>[(n(),g(V,null,F(D,(p,E)=>e(Y,{key:E},{default:t(()=>[e(H,{value:p},{default:t(()=>[o(I(p),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),r("div",_t,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[18]||(a[18]=[o("Способ доставки",-1)])),_:1,__:[18]}),e(q,{modelValue:d.value.deliveryMethod,"onUpdate:modelValue":a[6]||(a[6]=p=>d.value.deliveryMethod=p)},{default:t(()=>[e(j,null,{default:t(()=>[e(x,{placeholder:d.value.deliveryMethod},null,8,["placeholder"])]),_:1}),e(i,null,{default:t(()=>[(n(),g(V,null,F(y,(p,E)=>e(Y,{key:E},{default:t(()=>[e(H,{value:p},{default:t(()=>[o(I(p),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),r("div",ft,[d.value.invoice?(n(),b(k,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[19]||(a[19]=[o("Номер счета",-1)])),_:1,__:[19]})):M("",!0),e(A,{modelValue:d.value.invoice,"onUpdate:modelValue":a[7]||(a[7]=p=>d.value.invoice=p),placeholder:"Номер счета"},null,8,["modelValue"])]),r("div",vt,[d.value.track?(n(),b(k,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[20]||(a[20]=[o("Трек",-1)])),_:1,__:[20]})):M("",!0),e(A,{modelValue:d.value.track,"onUpdate:modelValue":a[8]||(a[8]=p=>d.value.track=p),placeholder:"Трек"},null,8,["modelValue"])])]),e(P,{orientation:"vertical",class:"h-[520px]"}),r("div",gt,[r("div",wt,[e(Z,{class:"h-[460px]"},{default:t(()=>[r("div",yt,[(n(!0),g(V,null,F(d.value.positions,(p,E)=>(n(),g("div",{key:E,class:"flex gap-2 items-center"},[r("div",bt,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[21]||(a[21]=[o("Позиция",-1)])),_:1,__:[21]}),e(h,{items:$.positionsList.map(L=>L.name),label:p.name,class:N([p.name?"":"outline-1 outline-rose-300 rounded-md "]),onSelectedItem:L=>{p.name=L;const le=$.positionsList.find(Ue=>Ue.name===L);p.category=le?le.category:""}},null,8,["items","label","class","onSelectedItem"])]),r("div",ht,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[22]||(a[22]=[o("Кол-во",-1)])),_:1,__:[22]}),e(A,{modelValue:p.quantity,"onUpdate:modelValue":L=>p.quantity=L,modelModifiers:{number:!0},type:"number",placeholder:"Кол-во",class:N([p.quantity>0?"":"outline-1 outline-rose-300","w-[100px]"])},null,8,["modelValue","onUpdate:modelValue","class"])]),r("div",xt,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[23]||(a[23]=[o("Цена за ед.",-1)])),_:1,__:[23]}),e(A,{modelValue:p.priceForItem,"onUpdate:modelValue":L=>p.priceForItem=L,modelModifiers:{number:!0},type:"number",placeholder:"Цена за ед.",class:N([p.priceForItem>0?"":"outline-1 outline-rose-300","w-[100px]"])},null,8,["modelValue","onUpdate:modelValue","class"])]),r("div",Vt,[e(k,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>a[24]||(a[24]=[o("Категория",-1)])),_:1,__:[24]}),e(q,{modelValue:p.category,"onUpdate:modelValue":L=>p.category=L},{default:t(()=>[e(j,{class:N(p.category?"":"outline-1 outline-rose-300")},{default:t(()=>[e(x,{placeholder:p.category},null,8,["placeholder"])]),_:2},1032,["class"]),e(i,null,{default:t(()=>[(n(!0),g(V,null,F(m.value,(L,le)=>(n(),b(Y,{key:le},{default:t(()=>[e(H,{value:L},{default:t(()=>[o(I(L),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),d.value.positions.length>1?(n(),b(s,{key:0,variant:"destructive",onClick:L=>J(E)},{default:t(()=>a[25]||(a[25]=[o(" Х ",-1)])),_:2,__:[25]},1032,["onClick"])):M("",!0)]))),128))])]),_:1})]),e(s,{variant:"outline",onClick:X},{default:t(()=>a[26]||(a[26]=[o("Добавить позицию",-1)])),_:1,__:[26]})])]),e(ae,{class:"w-full"},{default:t(()=>[r("div",St,[e(s,{disabled:U.value,class:"w-full",onClick:Q},{default:t(()=>a[27]||(a[27]=[o(" Создать ",-1)])),_:1,__:[27]},8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["open"])])}}}),Ut={class:"hidden space-x-1 lg:flex"},kt={key:1,class:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs"},$t=te({__name:"DataTableFacetedFilter",props:{column:{},title:{},options:{}},setup(l){const v=l,_=oe(()=>v.column?.getFacetedUniqueValues()),m=oe(()=>new Set(v.column?.getFilterValue()));return(w,S)=>{const D=we,y=Pe,T=B,U=be,u=Ne,d=Le,X=Re,J=Ke,Q=ze,W=Ae,$=Be,a=he,s=xe;return n(),b(s,null,{default:t(()=>[e(U,{"as-child":""},{default:t(()=>[e(T,{variant:"outline",size:"sm",class:"h-8 border-dashed"},{default:t(()=>[e(K(je),{class:"mr-2 h-4 w-4"}),o(" "+I(w.title)+" ",1),m.value.size>0?(n(),g(V,{key:0},[e(D,{orientation:"vertical",class:"mx-2 h-4"}),e(y,{variant:"secondary",class:"rounded-sm px-1 font-normal lg:hidden"},{default:t(()=>[o(I(m.value.size),1)]),_:1}),r("div",Ut,[m.value.size>0?(n(),b(y,{key:0,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:t(()=>[o(I(m.value.size),1)]),_:1})):(n(!0),g(V,{key:1},F(w.options.filter(c=>m.value.has(c.value)),c=>(n(),b(y,{key:c.value,variant:"secondary",class:"rounded-sm px-1 font-normal"},{default:t(()=>[o(I(c.label),1)]),_:2},1024))),128))])],64)):M("",!0)]),_:1})]),_:1}),e(a,{class:"w-[250px] p-0",align:"start"},{default:t(()=>[e($,{"filter-function":(c,C)=>c.filter(O=>O.label.toLowerCase()?.includes(C))},{default:t(()=>[e(u,{placeholder:w.title},null,8,["placeholder"]),e(W,null,{default:t(()=>[e(d,null,{default:t(()=>S[1]||(S[1]=[o("Нет совпадений.",-1)])),_:1,__:[1]}),e(J,null,{default:t(()=>[(n(!0),g(V,null,F(w.options,c=>(n(),b(X,{key:c.value,value:c,onSelect:C=>{m.value.has(c.value)?m.value.delete(c.value):m.value.add(c.value);const R=Array.from(m.value);w.column?.setFilterValue(R.length?R:void 0)}},{default:t(()=>[r("div",{class:N(K(ue)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",m.value.has(c.value)?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"))},[e(K(He),{class:N(K(ue)("h-4 w-4"))},null,8,["class"])],2),c.icon?(n(),b(qe(c.icon),{key:0,class:"mr-2 h-4 w-4 text-muted-foreground"})):M("",!0),r("span",null,I(c.label),1),_.value?.get(c.value)?(n(),g("span",kt,I(_.value.get(c.value)),1)):M("",!0)]),_:2},1032,["value","onSelect"]))),128))]),_:1}),m.value.size>0?(n(),g(V,{key:0},[e(Q),e(J,null,{default:t(()=>[e(X,{value:{label:"Очистить"},class:"justify-center text-center",onSelect:S[0]||(S[0]=c=>w.column?.setFilterValue(void 0))},{default:t(()=>S[2]||(S[2]=[o(" Очистить ",-1)])),_:1,__:[2]})]),_:1})],64)):M("",!0)]),_:1})]),_:1},8,["filter-function"])]),_:1})]),_:1})}}}),Ct={class:"flex items-center justify-between"},Ft={class:"flex flex-1 items-center space-x-2"},Dt=te({__name:"DataTableToolbar",props:{table:{},filters:{}},setup(l){const v=l,_=oe(()=>v.table.getState().columnFilters.length>0);return(m,w)=>{const S=$t,D=B;return n(),g("div",Ct,[r("div",Ft,[m.table.getColumn("positions")?(n(),b(S,{key:0,column:m.table.getColumn("positions"),title:"Позиции",options:m.filters.uniquePositions.map(y=>({label:y,value:y}))},null,8,["column","options"])):M("",!0),m.table.getColumn("positionsCat")?(n(),b(S,{key:1,column:m.table.getColumn("positionsCat"),title:"Категории",options:m.filters.uniqueCategories.map(y=>({label:y,value:y}))},null,8,["column","options"])):M("",!0),m.table.getColumn("supplier")?(n(),b(S,{key:2,column:m.table.getColumn("supplier"),title:"Поставщик",options:m.filters.uniqueSuppliers.map(y=>({label:y,value:y}))},null,8,["column","options"])):M("",!0),_.value?(n(),b(D,{key:3,variant:"secondary",class:"h-8 px-2 lg:px-3",onClick:w[0]||(w[0]=y=>m.table.resetColumnFilters())},{default:t(()=>[w[1]||(w[1]=o(" Сброс ",-1)),e(K(Ee),{class:"ml-2 h-4 w-4"})]),_:1,__:[1]})):M("",!0)])])}}}),It={class:"flex mb-2 justify-between"},Mt={class:"ml-[105px]"},Tt={class:"bg-slate-100 rounded-sm overflow-hidden"},kl=te({__name:"DataTable",props:{columns:{},data:{},filters:{}},emits:["table-sorted","item-clicked"],setup(l,{emit:v}){const _=l,m=z([]),w=z([]),S=z({}),D=Ze({get data(){return _.data},get columns(){return _.columns},getCoreRowModel:lt(),getSortedRowModel:tt(),getFilteredRowModel:et(),onSortingChange:U=>se(U,m),onColumnFiltersChange:U=>se(U,w),onColumnVisibilityChange:U=>se(U,S),state:{get sorting(){return m.value},get columnFilters(){return w.value},get columnVisibility(){return S.value}}}),y=v,T=U=>{y("item-clicked",U)};return ee(()=>D.getSortedRowModel().rows,U=>{const u=U.map(d=>d.original.id);y("table-sorted",u)},{deep:!0}),(U,u)=>{const d=Dt,X=B,J=be,Q=Ge,W=he,$=xe,a=Je,s=Ye,c=Xe,C=We,O=Qe,R=Oe,k=Te,A=ne;return n(),g(V,null,[r("div",It,[r("div",Mt,[e(d,{table:K(D),filters:U.filters},null,8,["table","filters"])]),r("div",null,[e($,null,{default:t(()=>[e(J,null,{default:t(()=>[e(X,{variant:"outline",class:"ml-auto"},{default:t(()=>[u[0]||(u[0]=o(" Колонки ",-1)),e(K(at),{class:"w-4 h-4 ml-2"})]),_:1,__:[0]})]),_:1}),e(W,{class:"w-[180px]"},{default:t(()=>[(n(!0),g(V,null,F(K(D).getAllColumns().filter(h=>h.getCanHide()),h=>(n(),g("div",{key:h.id},[e(Q,{checked:h.getIsVisible(),"onUpdate:checked":x=>{h.toggleVisibility(!!x)}},null,8,["checked","onUpdate:checked"]),o(" "+I(h.columnDef.ruName),1)]))),128))]),_:1})]),_:1})])]),r("div",Tt,[e(A,{class:"h-[calc(100vh-180px)]"},{default:t(()=>[e(R,null,{default:t(()=>[e(c,{class:"bg-white"},{default:t(()=>[(n(!0),g(V,null,F(K(D).getHeaderGroups(),h=>(n(),b(s,{key:h.id,class:""},{default:t(()=>[(n(!0),g(V,null,F(h.headers,x=>(n(),b(a,{key:x.id},{default:t(()=>[x.isPlaceholder?M("",!0):(n(),b(K(ie),{key:0,render:x.column.columnDef.header,props:x.getContext()},null,8,["render","props"]))]),_:2},1024))),128))]),_:2},1024))),128))]),_:1}),e(O,null,{default:t(()=>[K(D).getRowModel().rows?.length?(n(!0),g(V,{key:0},F(K(D).getRowModel().rows,h=>(n(),b(s,{key:h.id,"data-state":h.getIsSelected()?"selected":void 0,class:N(["cursor-pointer",h.original.orderStatus==="Отгружен нам"?"bg-green-500/40":""]),onClick:x=>T(h.original.id)},{default:t(()=>[(n(!0),g(V,null,F(h.getVisibleCells(),x=>(n(),b(C,{key:x.id},{default:t(()=>[e(K(ie),{render:x.column.columnDef.cell,props:x.getContext()},null,8,["render","props"])]),_:2},1024))),128))]),_:2},1032,["data-state","class","onClick"]))),128)):(n(),b(s,{key:1},{default:t(()=>[e(C,{colspan:U.columns.length,class:"text-left"},{default:t(()=>u[1]||(u[1]=[o(" Нет результатов. ",-1)])),_:1,__:[1]},8,["colspan"])]),_:1}))]),_:1})]),_:1}),e(k,{orientation:"horizontal"})]),_:1})])],64)}}}),qt={class:"flex gap-5"},Pt={class:"flex flex-col gap-5 min-w-[350px]"},Bt={class:"flex gap-2"},Nt={class:"relative w-full"},At={class:"relative w-full"},Lt={class:"relative"},Kt={class:"relative w-full"},Rt={class:"relative w-full"},jt={class:"relative w-full"},zt={class:"relative w-full"},Ht={class:"relative"},Et={class:"relative"},Gt={class:"flex flex-col grow"},Ot={class:"w-[full] grow"},Xt={class:"flex flex-col gap-5 p-2"},Jt={class:"relative w-full"},Qt={class:"relative min-w-[100px] w-[100px]"},Wt={class:"relative min-w-[100px] w-[100px]"},Yt={class:"relative min-w-[150px] w-[150px]"},Zt={class:"flex justify-between w-full gap-2"},$l=te({__name:"Edit",props:{supplie:{},suppliers:{},positionsList:{}},emits:["supplie-updated"],setup(l,{emit:v}){const{$useApi:_}=ye(),m=l,w=z(["Поликарбонат","Неон","Блоки питания","Пленки","Акрил","Упаковка","Комплектующие для станков","Комплектующие для мастеров","Комплектующие для упаковки","Другое"]),S=["Счет","Перевод","Наличка"],D=["Оформлен заказ","В пути","Отгружен нам"],y=["Оплачен","Не оплачен"],T=["Доставка от поставщика","Сдек","Самовывоз","Курьерская доставка","ПЭК","Деловые Линии"],U=()=>({date:new Date().toISOString().slice(0,10),shipmentDate:"",supplier:"",paymentMethod:S[0],orderStatus:D[0],paymentStatus:y[0],deliveryMethod:T[0],invoice:"",track:"",positions:[{name:"",quantity:1,priceForItem:0,category:""}]}),u=z(m.supplie?{...m.supplie}:U()),d=z(!0),X=()=>{u.value.positions.push({name:"",quantity:1,priceForItem:1,category:""})},J=a=>{u.value.positions.length>1&&u.value.positions.splice(a,1)},Q=async()=>{console.log(m.supplie?.id),m.supplie?.id&&(await _.patch(`supplies/${m.supplie.id}`,u.value),u.value=U(),$("supplie-updated"))},W=async()=>{await _.delete(`supplies/${m.supplie.id}`),$("supplie-updated")},$=v;return ee(u,()=>{const{date:a,supplier:s,positions:c}=u.value;d.value=!(a&&s&&c.length>0&&c.every(C=>C.name&&C.category&&C.quantity>0&&C.priceForItem>=0)&&/^\d{4}-\d{2}-\d{2}$/.test(a))},{deep:!0}),ee(()=>m.supplie,a=>{},{deep:!0}),(a,s)=>{const c=re,C=de,O=pe,R=_e,k=me,A=ve,h=ge,x=fe,j=ce,H=B,Y=ne;return n(),g(V,null,[r("div",qt,[r("div",Pt,[r("div",Bt,[r("div",Nt,[u.value.date?(n(),b(c,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[9]||(s[9]=[o("Дата заказа",-1)])),_:1,__:[9]})):M("",!0),e(C,{modelValue:u.value.date,"onUpdate:modelValue":s[0]||(s[0]=i=>u.value.date=i),type:"date",placeholder:"Дата",class:N(u.value.date?"":"outline outline-1 outline-rose-300")},null,8,["modelValue","class"])]),r("div",At,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[10]||(s[10]=[o("Дата отгрузки",-1)])),_:1,__:[10]}),e(C,{modelValue:u.value.shipmentDate,"onUpdate:modelValue":s[1]||(s[1]=i=>u.value.shipmentDate=i),type:"date",placeholder:"Дата"},null,8,["modelValue"])])]),r("div",Lt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1"},{default:t(()=>s[11]||(s[11]=[o("Поставщик (организация)",-1)])),_:1,__:[11]}),e(O,{items:a.suppliers,label:u.value.supplier,class:N(u.value.supplier?"":"outline-1 outline-rose-300 rounded-md"),onSelectedItem:s[2]||(s[2]=i=>u.value.supplier=i)},null,8,["items","label","class"])]),r("div",Kt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[12]||(s[12]=[o("Как оплатили",-1)])),_:1,__:[12]}),e(j,{modelValue:u.value.paymentMethod,"onUpdate:modelValue":s[3]||(s[3]=i=>u.value.paymentMethod=i)},{default:t(()=>[e(k,null,{default:t(()=>[e(R,{placeholder:u.value.paymentMethod},null,8,["placeholder"])]),_:1}),e(x,null,{default:t(()=>[(n(),g(V,null,F(S,(i,q)=>e(h,{key:q},{default:t(()=>[e(A,{value:i},{default:t(()=>[o(I(i),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),r("div",Rt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[13]||(s[13]=[o("Статус заказа",-1)])),_:1,__:[13]}),e(j,{modelValue:u.value.orderStatus,"onUpdate:modelValue":s[4]||(s[4]=i=>u.value.orderStatus=i)},{default:t(()=>[e(k,null,{default:t(()=>[e(R,{placeholder:u.value.orderStatus},null,8,["placeholder"])]),_:1}),e(x,null,{default:t(()=>[(n(),g(V,null,F(D,(i,q)=>e(h,{key:q},{default:t(()=>[e(A,{value:i},{default:t(()=>[o(I(i),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),r("div",jt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[14]||(s[14]=[o("Статус оплаты",-1)])),_:1,__:[14]}),e(j,{modelValue:u.value.paymentStatus,"onUpdate:modelValue":s[5]||(s[5]=i=>u.value.paymentStatus=i)},{default:t(()=>[e(k,null,{default:t(()=>[e(R,{placeholder:u.value.paymentStatus},null,8,["placeholder"])]),_:1}),e(x,null,{default:t(()=>[(n(),g(V,null,F(y,(i,q)=>e(h,{key:q},{default:t(()=>[e(A,{value:i},{default:t(()=>[o(I(i),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),r("div",zt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[15]||(s[15]=[o("Способ доставки",-1)])),_:1,__:[15]}),e(j,{modelValue:u.value.deliveryMethod,"onUpdate:modelValue":s[6]||(s[6]=i=>u.value.deliveryMethod=i)},{default:t(()=>[e(k,null,{default:t(()=>[e(R,{placeholder:u.value.deliveryMethod},null,8,["placeholder"])]),_:1}),e(x,null,{default:t(()=>[(n(),g(V,null,F(T,(i,q)=>e(h,{key:q},{default:t(()=>[e(A,{value:i},{default:t(()=>[o(I(i),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),r("div",Ht,[u.value.invoice?(n(),b(c,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[16]||(s[16]=[o("Номер счета",-1)])),_:1,__:[16]})):M("",!0),e(C,{modelValue:u.value.invoice,"onUpdate:modelValue":s[7]||(s[7]=i=>u.value.invoice=i),placeholder:"Номер счета"},null,8,["modelValue"])]),r("div",Et,[u.value.track?(n(),b(c,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[17]||(s[17]=[o("Трек",-1)])),_:1,__:[17]})):M("",!0),e(C,{modelValue:u.value.track,"onUpdate:modelValue":s[8]||(s[8]=i=>u.value.track=i),placeholder:"Трек"},null,8,["modelValue"])])]),r("div",Gt,[r("div",Ot,[e(Y,{class:"h-[460px]"},{default:t(()=>[r("div",Xt,[(n(!0),g(V,null,F(u.value.positions,(i,q)=>(n(),g("div",{key:q,class:"flex gap-2 items-center"},[r("div",Jt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[18]||(s[18]=[o("Позиция",-1)])),_:1,__:[18]}),e(O,{items:a.positionsList.map(P=>P.name),label:i.name,class:N([i.name?"":"outline-1 outline-rose-300 rounded-md "]),onSelectedItem:P=>{i.name=P;const Z=a.positionsList.find(ae=>ae.name===P);i.category=Z?Z.category:""}},null,8,["items","label","class","onSelectedItem"])]),r("div",Qt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[19]||(s[19]=[o("Кол-во",-1)])),_:1,__:[19]}),e(C,{modelValue:i.quantity,"onUpdate:modelValue":P=>i.quantity=P,modelModifiers:{number:!0},type:"number",placeholder:"Кол-во",class:N([i.quantity>0?"":"outline-1 outline-rose-300"])},null,8,["modelValue","onUpdate:modelValue","class"])]),r("div",Wt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[20]||(s[20]=[o("Цена за ед.",-1)])),_:1,__:[20]}),e(C,{modelValue:i.priceForItem,"onUpdate:modelValue":P=>i.priceForItem=P,modelModifiers:{number:!0},type:"number",placeholder:"Цена за ед.",class:N([i.priceForItem>0?"":"outline-1 outline-rose-300"])},null,8,["modelValue","onUpdate:modelValue","class"])]),r("div",Yt,[e(c,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:t(()=>s[21]||(s[21]=[o("Категория",-1)])),_:1,__:[21]}),r("div",null,[e(j,{modelValue:i.category,"onUpdate:modelValue":P=>i.category=P},{default:t(()=>[e(k,{class:N(i.category?"":"outline-1 outline-rose-300 ")},{default:t(()=>[e(R,{placeholder:i.category},null,8,["placeholder"])]),_:2},1032,["class"]),e(x,null,{default:t(()=>[(n(!0),g(V,null,F(w.value,(P,Z)=>(n(),b(h,{key:Z},{default:t(()=>[e(A,{value:P},{default:t(()=>[o(I(P),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),u.value.positions.length>1?(n(),b(H,{key:0,variant:"destructive",onClick:P=>J(q)},{default:t(()=>s[22]||(s[22]=[o(" Х ",-1)])),_:2,__:[22]},1032,["onClick"])):M("",!0)]))),128))])]),_:1})]),e(H,{variant:"outline",onClick:X},{default:t(()=>s[23]||(s[23]=[o("Добавить позицию",-1)])),_:1,__:[23]})])]),r("div",Zt,[e(H,{class:"",onClick:W},{default:t(()=>s[24]||(s[24]=[o(" Удалить ",-1)])),_:1,__:[24]}),e(H,{disabled:d.value,class:"",onClick:Q},{default:t(()=>s[25]||(s[25]=[o(" Сохранить ",-1)])),_:1,__:[25]},8,["disabled"])])],64)}}}),Cl=[{accessorKey:"date",ruName:"Дата заказа",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Дата заказа",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>{const v=l.getValue("date"),_=new Date(v).toLocaleDateString(),m=l.getValue("shipmentDate");return new Date(m).toLocaleDateString(),f("div",{class:"text-center flex flex-col"},[f("span",_==="Invalid Date"?"-":_)])}},{accessorKey:"shipmentDate",ruName:"Дата отгрузки",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full text-wrap p-0"},()=>["Дата отгрузки",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>{const v=l.getValue("shipmentDate"),_=new Date(v).toLocaleDateString();return f("div",{class:"text-center"},_==="Invalid Date"?"-":_)}},{accessorKey:"positions",ruName:"Стоимость",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Стоимость",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>{const v=l.getValue("positions"),_=v.reduce((m,w)=>m+w.quantity*w.priceForItem,0);return f("div",{class:"text-center flex flex-col"},[f("span",{class:"font-semibold text-grey-500"},`${st(+_.toFixed(2))}₽`),f("span",{class:"text-xs"},`${v.length} поз.`)])},sortingFn:(l,v,_)=>{const m=l.getValue(_),w=v.getValue(_),S=m.reduce((y,T)=>y+T.quantity*T.priceForItem,0),D=w.reduce((y,T)=>y+T.quantity*T.priceForItem,0);return S-D},filterFn:(l,v,_)=>l.getValue("positions").some(w=>Object.values(_).includes(w.name))},{accessorKey:"positionsCat",ruName:"Позиции",enableHiding:!1,header:({column:l})=>f("div",{class:"text-center p-0 hidden"}),cell:({row:l})=>f("div",{class:"text-center p-0 hidden"}),filterFn:(l,v,_)=>l.getValue("positions").some(w=>Object.values(_).includes(w.category))},{accessorKey:"supplier",ruName:"Поставщик",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Поставщик",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>f("div",{class:"text-center"},l.getValue("supplier")),filterFn:(l,v,_)=>_.includes(l.getValue(v))},{accessorKey:"paymentMethod",ruName:"Способ оплаты",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full text-wrap p-0"},()=>["Способ оплаты",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>f("div",{class:"text-center"},l.getValue("paymentMethod")),filterFn:(l,v,_)=>_.includes(l.getValue(v))},{accessorKey:"orderStatus",ruName:"Статус заказа",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Статус заказа",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>f("div",{class:["text-center"]},l.getValue("orderStatus")),filterFn:(l,v,_)=>_.includes(l.getValue(v))},{accessorKey:"paymentStatus",ruName:"Статус оплаты",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full text-wrap p-0"},()=>["Статус оплаты",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>f("div",{class:["text-center",l.original.paymentStatus==="Оплачен"?"bg-green-500/50 rounded-sm":""]},l.getValue("paymentStatus")),filterFn:(l,v,_)=>_.includes(l.getValue(v))},{accessorKey:"deliveryMethod",ruName:"Способ доставки",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full text-wrap p-0"},()=>["Способ доставки",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>f("div",{class:["text-center text-wrap"]},l.getValue("deliveryMethod")),filterFn:(l,v,_)=>_.includes(l.getValue(v))},{accessorKey:"invoice",ruName:"Счет",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Счет",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>f("div",{class:"text-center text-wrap min-w-[100px]"},l.getValue("invoice")||"-")},{accessorKey:"track",ruName:"Трек-номер",header:({column:l})=>f(B,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),class:"text-center h-full w-full p-0"},()=>["Трек-номер",f(G,{class:"ml-2 h-4 w-4"})]),cell:({row:l})=>f("div",{class:"text-center"},l.getValue("track")||"-")}];export{Ul as _,kl as a,$l as b,Cl as s};
