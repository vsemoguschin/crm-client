import{_ as me}from"./Bmr5wyhr.js";import{_ as _e,a as pe,b as ve}from"./DkMjgWCi.js";import{_ as he,a as ye,b as Me}from"./CNLsaPwj.js";import{_ as xe}from"./BCRlC5xu.js";import{_ as ge}from"./fRExJa2e.js";import{_ as be}from"./CP8umD4q.js";import{_ as we}from"./Da2JRHOT.js";import{b as De,c as Fe,a as Pe,d as Te,e as Ce,_ as ke}from"./Df1Q6CGn.js";import{_ as Se,a as $e,b as Be,c as Ue}from"./BO8YJNvj.js";import{_ as je}from"./DkkQ8vn7.js";import{_ as Ne}from"./ub7fZ9kk.js";import{u as i}from"./Dt19OLxm.js";import{Q as Ve}from"./DVXwaM75.js";import{e as Re,g as Le,u as Ae,r as d,B as Ee,c,a as s,b as t,H as ee,l as n,w as l,o as u,F as y,z as M,m as te,d as f,t as r,A as U,D as E}from"./LcRD3ia0.js";import"./D8Osd5Ax.js";import"./DfRdkKc3.js";import"./D5ydJhlK.js";import"./D9TSNOAg.js";import"./BdQOAs7V.js";import"./BOGtf0gU.js";import"./QkXyQO2w.js";import"./D6LOIvye.js";import"./D8EW8v7U.js";import"./DaWZu8wl.js";const He={class:"relative h-screen hidden-scrollbar"},Ie={class:"w-full fixed z-10"},ze={class:"h-[full] flex p-4 gap-2 mx-[auto] max-w-[2048px] pt-16"},Ge={class:"flex flex-col gap-4 w-full"},Qe={class:"flex gap-2"},We={class:"flex flex-col gap-2"},Ye={class:"flex gap-2 items-center"},Oe={class:"min-w-[200px] w-[200px]"},qe={class:"flex items-center justify-between"},Je={class:"flex items-center"},Ke={class:"flex justify-between items-center"},Xe={class:"font-medium text-gray-800"},Ze={class:U(["font-bold text-lg"])},et={class:"text-xs text-muted-foreground flex justify-between mt-1"},tt={key:0,class:"text-gray-500"},at={class:"flex justify-between gap-5 items-center"},ot={class:"font-medium text-gray-800"},lt={class:U(["font-bold text-lg"])},st={class:"text-xs text-muted-foreground flex justify-between mt-1"},nt={key:0,class:"text-gray-500"},rt={class:"grow"},it={class:"flex justify-between gap-5 items-center"},ut={class:"font-medium text-gray-800"},ct={class:U(["font-bold text-lg"])},dt={class:"text-xs text-muted-foreground flex justify-between mt-1"},ft={key:0,class:"text-gray-500"},mt={class:"flex justify-between gap-5 items-center"},_t={class:U(["font-bold text-lg"])},pt={class:"flex flex-col gap-4"},vt={class:"w-full flex gap-2"},ht={class:"mt-4 flex flex-col"},yt={class:"mt-4 flex flex-col"},Mt={class:"mt-4 flex flex-col pb-3 relative"},xt={class:"w-[150px] overflow-hidden text-ellipsis"},gt={class:"relative"},bt={class:"absolute font-bold top-[55%] left-1/2 translate-x-[-50%] h-full"},wt={class:"mt-4 flex flex-col"},Dt={class:"text-nowrap"},Ft={class:"text-nowrap"},Pt={class:"grow"},Tt={class:"grow"},Zt=Re({__name:"index",setup(Ct){const{$useApi:H}=Le();Ae({title:"Статистика1 | Easy CRM"});const F=d({month:new Date().getMonth(),year:new Date().getFullYear()}),ae=e=>new Date(e).toLocaleDateString("ru-RU",{month:"long",year:"numeric"}),oe=d(!1),I=d([{title:"Общий план",value:"0",content:"Остаток",footer:""},{title:"Продажи",value:"0",content:"Процент от плана",footer:""},{title:"Выручка(Факт)",value:"0",content:"Средний чек",footer:""},{title:"Сделки",value:"0",content:"Колличество сделок",footer:""},{title:"Доп. услуги",value:"0",content:"Процент от продаж",footer:""},{title:"Оплачено(%)",value:"0"},{title:"Остаток(%)",value:"0"}]),z=d([{title:"ДРР",value:"0",content:"",footer:""},{title:"Стоимость заявки",value:"0",content:"Колличество заявок",footer:"0"},{title:"% из заявки в продажу",value:"0%",content:"",footer:""},{title:"% из заявки в макет",value:"0%",content:"Общее количество макетов",footer:"0"},{title:"% из макета в продажу",value:"0%",content:"",footer:""},{title:"% из заявки в макет день в день",value:"0%",content:"Макеты день в день",footer:"0"},{title:"Продажи день в день(0)",value:"0₽",content:"Количество продаж день в день",footer:"0"},{title:"Без дизайнера(0)",value:"0₽",content:"Продажи без участия дизайнера",footer:"0"},{title:"Переходы в мессенджер",value:"0",content:"",footer:""}]),G=d([{title:"Отправлено",value:"0",content:"Колличество",footer:""},{title:"Бесплатно",value:"0",content:"Колличество",footer:"0"},{title:"Платно",value:"0",content:"Колличество",footer:"0"}]),Q=d(0),j=d(0),W=d([]),N=d([{name:"01",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"02",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"03",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"04",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"05",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"06",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"07",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500}]),V=d([{name:"01",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"02",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"03",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"04",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"05",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"06",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"07",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500}]),R=d([{fullName:"Иванов Иван Иванович",sales:100500},{fullName:"Петров Петр Петрович",sales:100500},{fullName:"Сидоров Сидор Сидорович",sales:100500},{fullName:"Иванов Иван Иванович",sales:100500},{fullName:"Петров Петр Петрович",sales:100500}]),P=d([{name:"Дизайнерский",sales:10,amount:0},{name:"Заготовка из базы",sales:20,amount:0},{name:"Рекламный",sales:20,amount:0},{name:"Визуализатор",sales:10,amount:0},{name:"Из рассылки",sales:30,amount:0}]),T=d([{name:"пример",sales:10},{name:"пример2",sales:20},{name:"пример3",sales:20}]),C=d([{name:"пример",sales:10},{name:"пример2",sales:20},{name:"пример3",sales:20}]),k=d([{name:"пример",sales:10},{name:"пример2",sales:20},{name:"пример3",sales:20}]),S=d(["Все","ВК","Авито"]),$=d(S.value[0]),Y=d(0),le=async e=>{try{const{data:o}=await H.get("/dashboards/statistics",{params:{period:e}});W.value=o,S.value=o.map(v=>v.workSpaceName);const{chartData:x,callsChartData:w,users:L,maketsSales:A,sources:_,adTags:p,adExpenses:D,...m}=o[0];N.value=x,V.value=w,R.value=L,P.value=A,T.value=_,C.value=p,k.value=D,$.value=S.value[0],O(m),q(m),J(m)}catch(o){console.log(o)}},se=async e=>{try{const{data:o}=await H.get("/deliveries/registers",{params:{period:e}});Y.value=o.sum||0}catch(o){console.log(o)}},O=e=>{j.value=e.totalSales,e.plan<e.temp&&(oe.value=!0),I.value=[{title:"Общий план",value:i(e.plan)+"₽",content:"Остаток",footer:i(e.remainder)+"₽"},{title:"Темп",value:i(e.temp)+"₽",content:"Процент от плана",footer:e.tempToPlan.toFixed()+"%"},{title:"Продажи",value:i(e.totalSales)+"₽",content:"Процент от плана",footer:e.salesToPlan.toFixed()+"%"},{title:"Заказы",value:i(e.dealsSales)+"₽",content:"Колличество заказов",footer:e.dealsAmount.toString()},{title:"Доп. услуги",value:i(e.dopSales)+"₽",content:"Процент от продаж",footer:e.dopsToSales.toFixed()+"%"},{title:"Выручка(Факт)",value:i(e.receivedPayments)+"₽",content:"Средний чек",footer:i(+e.averageBill.toFixed())+"₽"},{title:"Остаток",value:i(e.totalSales-e.receivedPayments)+"₽",content:"Процент неоплачено",footer:e.totalSales?((e.totalSales-e.receivedPayments)/e.totalSales*100).toFixed()+"%":"0%"}]},q=e=>{z.value=[{title:"ДРР",value:e.drr+"%",content:"",footer:""},{title:"Стоимость заявки",value:e.callCost+"₽",content:"Колличество заявок",footer:e.calls},{title:"% из заявки в продажу",value:e.conversionDealsToCalls+"%",content:"",footer:""},{title:"% из заявки в макет",value:e.conversionMaketsToCalls+"%",content:"Общее количество макетов",footer:e.makets},{title:"% из макета в продажу",value:e.conversionMaketsToSales+"%",content:"",footer:""},{title:"% из заявки в макет день в день",value:e.conversionMaketsDayToDayToCalls+"%",content:"Макеты день в день",footer:e.maketsDayToDay},{title:"Продажи день в день",value:i(e.dealsDayToDayPrice||0)+"₽",content:"Количество продаж день в день",footer:e.dealsDayToDay},{title:"Без дизайнера",value:i(e.dealsSalesWithoutDesigners||0)+"₽",content:"Продажи без участия дизайнера",footer:e.dealsWithoutDesigners},{title:"Переходы в мессенджер",value:e.redirectToMSG,content:"",footer:""}]},J=e=>{G.value=[{title:"Отправлено",value:i(e.sendDeliveriesPrice)+"₽",content:"Колличество",footer:e.sendDeliveries},{title:"Доставлено",value:i(e.deliveredDeliveriesPrice)+"₽",content:"Колличество",footer:e.deliveredDeliveries},{title:"Бесплатные доставки",value:e.freeDeliveries,content:"Стоимость доставок",footer:e.freeDeliveriesPrice.toFixed(2)}]},ne=e=>{const o=W.value.find(x=>x.workSpaceName===e)||[];N.value=o.chartData,V.value=o.callsChartData,R.value=o.users,P.value=o.maketsSales,T.value=o.sources,C.value=o.adTags,k.value=o.adExpenses,O(o),q(o),J(o)};return Ee(F,e=>{const{month:o,year:x}=e,w=new Date(x,o+1).toISOString().slice(0,7);le(w),se(w)}),(e,o)=>{const x=me,w=ve,L=pe,A=_e,_=Me,p=ye,D=we,m=ge,v=he,g=xe,K=Te,X=Pe,re=Fe,Z=ke,ie=Ce,ue=De,b=be,B=Se,ce=je,de=$e,fe=Ne;return u(),c("div",He,[s("div",Ie,[t(x)]),s("div",ze,[s("div",Ge,[s("div",Qe,[s("div",We,[s("div",Ye,[s("div",Oe,[t(n(Ve),{modelValue:n(F),"onUpdate:modelValue":o[0]||(o[0]=a=>ee(F)?F.value=a:null),"month-picker":"","auto-apply":"",locale:"ru",clearable:!1,format:ae},null,8,["modelValue"])]),t(A,{modelValue:n($),"onUpdate:modelValue":o[1]||(o[1]=a=>ee($)?$.value=a:null)},{default:l(()=>[s("div",qe,[s("div",Je,[t(L,null,{default:l(()=>[(u(!0),c(y,null,M(n(S),a=>(u(),te(w,{key:a,value:a,onClick:h=>ne(a)},{default:l(()=>[f(r(a),1)]),_:2},1032,["value","onClick"]))),128))]),_:1})])])]),_:1},8,["modelValue"])]),t(v,{class:"h-full"},{default:l(()=>[t(p,{class:"px-4 py-4"},{default:l(()=>[t(_,null,{default:l(()=>o[2]||(o[2]=[f("Продажи",-1)])),_:1,__:[2]})]),_:1}),t(m,{class:"p-4 space-y-3"},{default:l(()=>[(u(!0),c(y,null,M(n(I),a=>(u(),c("div",{key:a.title,class:"text-sm md:text-base leading-normal"},[s("div",Ke,[s("span",Xe,r(a.title),1),s("span",Ze,r(a.value),1)]),s("div",et,[s("span",null,r(a.content),1),a.footer?(u(),c("span",tt,r(a.footer),1)):E("",!0)]),t(D)]))),128))]),_:1})]),_:1})]),t(v,{class:"min-w-[350px]"},{default:l(()=>[t(p,{class:"px-4 py-4"},{default:l(()=>[t(_,null,{default:l(()=>o[3]||(o[3]=[f("Показатели",-1)])),_:1,__:[3]})]),_:1}),t(m,{class:"p-4 space-y-3"},{default:l(()=>[(u(!0),c(y,null,M(n(z),a=>(u(),c("div",{key:a.title,class:"text-sm md:text-base leading-normal"},[s("div",at,[s("span",ot,r(a.title),1),s("span",lt,r(a.value),1)]),s("div",st,[s("span",null,r(a.content),1),a.footer?(u(),c("span",nt,r(a.footer),1)):E("",!0)]),t(D)]))),128))]),_:1})]),_:1}),s("div",rt,[t(v,{class:"h-full"},{default:l(()=>[t(p,{class:"px-4 py-4"},{default:l(()=>[t(_,null,{default:l(()=>o[4]||(o[4]=[f("Топ менеджеров",-1)])),_:1,__:[4]}),t(g)]),_:1}),t(m,{class:"p-0"},{default:l(()=>[t(ue,null,{default:l(()=>[t(re,null,{default:l(()=>[t(X,null,{default:l(()=>[t(K,{class:"text-left"},{default:l(()=>o[5]||(o[5]=[f(" Менеджер ",-1)])),_:1,__:[5]}),t(K,{class:"text-right"},{default:l(()=>o[6]||(o[6]=[f(" Сумма ",-1)])),_:1,__:[6]})]),_:1})]),_:1}),t(ie,null,{default:l(()=>[(u(!0),c(y,null,M(n(R),(a,h)=>(u(),te(X,{key:h},{default:l(()=>[t(Z,{class:"font-medium whitespace-nowrap"},{default:l(()=>[f(r(h+1+". "+a.fullName),1)]),_:2},1024),t(Z,{class:"text-right whitespace-nowrap"},{default:l(()=>[f(r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales)+"₽"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(b,{class:"p-0"})]),_:1})]),t(v,{class:"min-w-[350px]"},{default:l(()=>[t(p,{class:"px-4 py-4"},{default:l(()=>[t(_,null,{default:l(()=>o[7]||(o[7]=[f("Доставка",-1)])),_:1,__:[7]})]),_:1}),t(m,{class:"p-4 space-y-3"},{default:l(()=>[(u(!0),c(y,null,M(n(G),a=>(u(),c("div",{key:a.title,class:"text-sm md:text-base leading-normal"},[s("div",it,[s("span",ut,r(a.title),1),s("span",ct,r(a.value),1)]),s("div",dt,[s("span",null,r(a.content),1),a.footer?(u(),c("span",ft,r(a.footer),1)):E("",!0)]),t(D)]))),128)),s("div",mt,[o[8]||(o[8]=s("span",{class:"font-medium text-gray-800"},"Реестр СДЕК",-1)),s("span",_t,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(+n(Y).toFixed(2))+"₽"),1)])]),_:1})]),_:1})]),s("div",pt,[s("div",vt,[t(v,{class:"w-full"},{default:l(()=>[t(p,null,{default:l(()=>[t(_,null,{default:l(()=>o[9]||(o[9]=[f("Макеты",-1)])),_:1,__:[9]}),t(g)]),_:1}),t(m,null,{default:l(()=>[t(B,{index:"name",category:"sales",data:n(P),"value-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽":""},null,8,["data","value-formatter"]),s("div",ht,[(u(!0),c(y,null,M(n(P),a=>(u(),c("div",{key:a.name,class:"flex items-center justify-between"},[s("span",null,r(a.name)+"("+r(a.amount)+")",1),s("span",null,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales))+"₽",1)]))),128))])]),_:1}),t(b)]),_:1}),t(v,{class:"w-full"},{default:l(()=>[t(p,null,{default:l(()=>[t(_,null,{default:l(()=>o[10]||(o[10]=[f("Источники",-1)])),_:1,__:[10]}),t(g)]),_:1}),t(m,null,{default:l(()=>[t(B,{index:"name",category:"sales",data:n(T),"value-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽":""},null,8,["data","value-formatter"]),s("div",yt,[(u(!0),c(y,null,M(n(T),a=>(u(),c("div",{key:a.name,class:"flex items-center justify-between"},[s("span",null,r(a.name),1),s("span",null,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales))+"₽",1)]))),128))])]),_:1}),t(b)]),_:1}),t(v,{class:"w-full"},{default:l(()=>[t(p,null,{default:l(()=>[t(_,null,{default:l(()=>o[11]||(o[11]=[f("Теги",-1)])),_:1,__:[11]}),t(g)]),_:1}),t(m,null,{default:l(()=>[t(B,{index:"name",category:"sales",data:n(C),"value-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽":""},null,8,["data","value-formatter"]),t(ce,{class:"h-[300px] pr-2"},{default:l(()=>[s("div",Mt,[(u(!0),c(y,null,M(n(C),a=>(u(),c("div",{key:a.name,class:"flex items-center justify-between"},[s("span",xt,r(a.name),1),s("span",null,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales))+"₽",1)]))),128)),o[12]||(o[12]=s("div",{class:"h-[20px] bg-gradient-to-b from-transparent to-slate-700/10 fixed"},null,-1))])]),_:1})]),_:1}),t(b)]),_:1}),t(v,{class:"w-full"},{default:l(()=>[t(p,null,{default:l(()=>[t(_,null,{default:l(()=>o[13]||(o[13]=[f("Расходы на рекламу",-1)])),_:1,__:[13]}),t(g)]),_:1}),t(m,null,{default:l(()=>[s("div",gt,[t(B,{index:"name",category:"sales",data:n(k),"value-formatter":(a,h)=>(Q.value=n(j)?+(a/n(j)*100).toFixed(2):0,("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽")},null,8,["data","value-formatter"]),s("div",bt," ДРР: "+r(n(Q))+"% ",1)]),s("div",wt,[(u(!0),c(y,null,M(n(k),a=>(u(),c("div",{key:a.name,class:"flex items-center justify-between gap-4"},[s("span",Dt,r(a.name),1),s("span",Ft,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales))+"₽",1)]))),128))])]),_:1}),t(b)]),_:1})]),s("div",Pt,[t(v,null,{default:l(()=>[t(p,null,{default:l(()=>[t(_,null,{default:l(()=>o[14]||(o[14]=[f("График продаж",-1)])),_:1,__:[14]}),t(g)]),_:1}),t(m,null,{default:l(()=>[t(de,{index:"name",data:n(N),categories:["Сделки","Допы"],"y-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽":"",type:"stacked","custom-tooltip":Be},null,8,["data","y-formatter"])]),_:1}),t(b)]),_:1})]),s("div",Tt,[t(v,null,{default:l(()=>[t(p,null,{default:l(()=>[t(_,null,{default:l(()=>o[15]||(o[15]=[f("График заявок",-1)])),_:1,__:[15]}),t(g)]),_:1}),t(m,null,{default:l(()=>[t(fe,{index:"name",data:n(V),categories:["ВК","B2B"],"y-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a):"","custom-tooltip":Ue},null,8,["data","y-formatter"])]),_:1}),t(b)]),_:1})])])])])])}}});export{Zt as default};
