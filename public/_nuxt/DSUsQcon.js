import{_ as me}from"./Bmr5wyhr.js";import{_ as _e}from"./mqOaxR0N.js";import{_ as pe,a as ve,b as he}from"./DkMjgWCi.js";import{_ as ye,a as Me,b as xe}from"./CNLsaPwj.js";import{_ as ge}from"./BCRlC5xu.js";import{_ as be}from"./fRExJa2e.js";import{_ as we}from"./CP8umD4q.js";import{_ as De}from"./Da2JRHOT.js";import{b as Fe,c as Pe,a as Te,d as Ce,e as ke,_ as $e}from"./Df1Q6CGn.js";import{_ as Se,a as Be,b as Ue,c as je}from"./BO8YJNvj.js";import{_ as Ne}from"./DkkQ8vn7.js";import{_ as Ve}from"./ub7fZ9kk.js";import{u as i}from"./Dt19OLxm.js";import{e as Ie,g as Re,u as Ae,r as d,i as Ee,B as He,c,a as l,b as t,H as oe,l as n,w as o,o as u,F as y,z as M,m as le,d as f,t as r,A as B,D as H}from"./LcRD3ia0.js";import"./D8Osd5Ax.js";import"./DfRdkKc3.js";import"./D5ydJhlK.js";import"./D9TSNOAg.js";import"./BdQOAs7V.js";import"./BOGtf0gU.js";import"./QkXyQO2w.js";import"./D6LOIvye.js";import"./D8EW8v7U.js";import"./DaWZu8wl.js";const Le={class:"relative h-screen hidden-scrollbar"},ze={class:"w-full fixed z-10"},Ge={class:"h-[full] flex p-4 gap-2 mx-[auto] max-w-[2048px] pt-16"},We={class:"flex flex-col gap-4 w-full"},Oe={class:"flex gap-2"},qe={class:"flex flex-col gap-2"},Je={class:"flex gap-2"},Ke={class:"flex items-center justify-between"},Qe={class:"flex items-center"},Xe={class:"flex justify-between items-center"},Ye={class:"font-medium text-gray-800"},Ze={class:B(["font-bold text-lg"])},et={class:"text-xs text-muted-foreground flex justify-between mt-1"},tt={key:0,class:"text-gray-500"},at={class:"flex justify-between gap-5 items-center"},ot={class:"font-medium text-gray-800"},lt={class:B(["font-bold text-lg"])},st={class:"text-xs text-muted-foreground flex justify-between mt-1"},nt={key:0,class:"text-gray-500"},rt={class:"grow"},it={class:"flex justify-between gap-5 items-center"},ut={class:"font-medium text-gray-800"},ct={class:B(["font-bold text-lg"])},dt={class:"text-xs text-muted-foreground flex justify-between mt-1"},ft={key:0,class:"text-gray-500"},mt={class:"flex justify-between gap-5 items-center"},_t={class:B(["font-bold text-lg"])},pt={class:"flex flex-col gap-4"},vt={class:"w-full flex gap-2"},ht={class:"mt-4 flex flex-col"},yt={class:"mt-4 flex flex-col"},Mt={class:"mt-4 flex flex-col pb-3 relative"},xt={class:"w-[150px] overflow-hidden text-ellipsis"},gt={class:"relative"},bt={class:"absolute font-bold top-[55%] left-1/2 translate-x-[-50%] h-full"},wt={class:"mt-4 flex flex-col"},Dt={class:"text-nowrap"},Ft={class:"text-nowrap"},Pt={class:"grow"},Tt={class:"grow"},Zt=Ie({__name:"index",setup(Ct){const{$useApi:L}=Re();Ae({title:"Статистика | Easy CRM"});const b=d(new Date().toISOString().slice(0,7)),se=d(!1),z=d([{title:"Общий план",value:"0",content:"Остаток",footer:""},{title:"Продажи",value:"0",content:"Процент от плана",footer:""},{title:"Выручка(Факт)",value:"0",content:"Средний чек",footer:""},{title:"Сделки",value:"0",content:"Колличество сделок",footer:""},{title:"Доп. услуги",value:"0",content:"Процент от продаж",footer:""},{title:"Оплачено(%)",value:"0"},{title:"Остаток(%)",value:"0"}]),G=d([{title:"ДРР",value:"0",content:"",footer:""},{title:"Стоимость заявки",value:"0",content:"Колличество заявок",footer:"0"},{title:"% из заявки в продажу",value:"0%",content:"",footer:""},{title:"% из заявки в макет",value:"0%",content:"Общее количество макетов",footer:"0"},{title:"% из макета в продажу",value:"0%",content:"",footer:""},{title:"% из заявки в макет день в день",value:"0%",content:"Макеты день в день",footer:"0"},{title:"Продажи день в день(0)",value:"0₽",content:"Количество продаж день в день",footer:"0"},{title:"Без дизайнера(0)",value:"0₽",content:"Продажи без участия дизайнера",footer:"0"},{title:"Переходы в мессенджер",value:"0",content:"",footer:""}]),W=d([{title:"Отправлено",value:"0",content:"Колличество",footer:""},{title:"Бесплатно",value:"0",content:"Колличество",footer:"0"},{title:"Платно",value:"0",content:"Колличество",footer:"0"}]),O=d(0),U=d(0),q=d([]),j=d([{name:"01",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"02",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"03",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"04",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"05",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"06",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500},{name:"07",Сделки:Math.floor(Math.random()*2e3)+500,Допы:Math.floor(Math.random()*2e3)+500}]),N=d([{name:"01",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"02",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"03",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"04",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"05",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"06",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500},{name:"07",ВК:Math.floor(Math.random()*2e3)+500,B2B:Math.floor(Math.random()*2e3)+500}]),V=d([{fullName:"Иванов Иван Иванович",sales:100500},{fullName:"Петров Петр Петрович",sales:100500},{fullName:"Сидоров Сидор Сидорович",sales:100500},{fullName:"Иванов Иван Иванович",sales:100500},{fullName:"Петров Петр Петрович",sales:100500}]),F=d([{name:"Дизайнерский",sales:10,amount:0},{name:"Заготовка из базы",sales:20,amount:0},{name:"Рекламный",sales:20,amount:0},{name:"Визуализатор",sales:10,amount:0},{name:"Из рассылки",sales:30,amount:0}]),P=d([{name:"пример",sales:10},{name:"пример2",sales:20},{name:"пример3",sales:20}]),T=d([{name:"пример",sales:10},{name:"пример2",sales:20},{name:"пример3",sales:20}]),C=d([{name:"пример",sales:10},{name:"пример2",sales:20},{name:"пример3",sales:20}]),k=d(["Все","ВК","Авито"]),$=d(k.value[0]),J=d(0),K=async()=>{try{const{data:e}=await L.get("/dashboards/statistics",{params:{period:b.value}});q.value=e,k.value=e.map(D=>D.workSpaceName);const{chartData:s,callsChartData:w,users:I,maketsSales:R,sources:A,adTags:E,adExpenses:_,...m}=e[0];j.value=s,N.value=w,V.value=I,F.value=R,P.value=A,T.value=E,C.value=_,$.value=k.value[0],X(m),Y(m),Z(m)}catch(e){console.log(e)}},Q=async()=>{try{const{data:e}=await L.get("/deliveries/registers",{params:{period:b.value}});J.value=e.sum||0}catch(e){console.log(e)}},X=e=>{U.value=e.totalSales,e.plan<e.temp&&(se.value=!0),z.value=[{title:"Общий план",value:i(e.plan)+"₽",content:"Остаток",footer:i(e.remainder)+"₽"},{title:"Темп",value:i(e.temp)+"₽",content:"Процент от плана",footer:e.tempToPlan.toFixed()+"%"},{title:"Продажи",value:i(e.totalSales)+"₽",content:"Процент от плана",footer:e.salesToPlan.toFixed()+"%"},{title:"Заказы",value:i(e.dealsSales)+"₽",content:"Колличество заказов",footer:e.dealsAmount.toString()},{title:"Доп. услуги",value:i(e.dopSales)+"₽",content:"Процент от продаж",footer:e.dopsToSales.toFixed()+"%"},{title:"Выручка(Факт)",value:i(e.receivedPayments)+"₽",content:"Средний чек",footer:i(+e.averageBill.toFixed())+"₽"},{title:"Остаток",value:i(e.totalSales-e.receivedPayments)+"₽",content:"Процент неоплачено",footer:e.totalSales?((e.totalSales-e.receivedPayments)/e.totalSales*100).toFixed()+"%":"0%"}]},Y=e=>{G.value=[{title:"ДРР",value:e.drr+"%",content:"",footer:""},{title:"Стоимость заявки",value:e.callCost+"₽",content:"Колличество заявок",footer:e.calls},{title:"% из заявки в продажу",value:e.conversionDealsToCalls+"%",content:"",footer:""},{title:"% из заявки в макет",value:e.conversionMaketsToCalls+"%",content:"Общее количество макетов",footer:e.makets},{title:"% из макета в продажу",value:e.conversionMaketsToSales+"%",content:"",footer:""},{title:"% из заявки в макет день в день",value:e.conversionMaketsDayToDayToCalls+"%",content:"Макеты день в день",footer:e.maketsDayToDay},{title:"Продажи день в день",value:i(e.dealsDayToDayPrice||0)+"₽",content:"Количество продаж день в день",footer:e.dealsDayToDay},{title:"Без дизайнера",value:i(e.dealsSalesWithoutDesigners||0)+"₽",content:"Продажи без участия дизайнера",footer:e.dealsWithoutDesigners},{title:"Переходы в мессенджер",value:e.redirectToMSG,content:"",footer:""}]},Z=e=>{W.value=[{title:"Отправлено",value:i(e.sendDeliveriesPrice)+"₽",content:"Колличество",footer:e.sendDeliveries},{title:"Доставлено",value:i(e.deliveredDeliveriesPrice)+"₽",content:"Колличество",footer:e.deliveredDeliveries},{title:"Бесплатные доставки",value:e.freeDeliveries,content:"Стоимость доставок",footer:e.freeDeliveriesPrice.toFixed(2)}]},ne=e=>{const s=q.value.find(w=>w.workSpaceName===e)||[];j.value=s.chartData,N.value=s.callsChartData,V.value=s.users,F.value=s.maketsSales,P.value=s.sources,T.value=s.adTags,C.value=s.adExpenses,X(s),Y(s),Z(s)};return Ee(()=>{K(),Q()}),He(b,()=>{K(),Q()}),(e,s)=>{const w=me,I=_e,R=he,A=ve,E=pe,_=xe,m=Me,D=De,p=be,v=ye,x=ge,ee=Ce,te=Te,re=Pe,ae=$e,ie=ke,ue=Fe,g=we,S=Se,ce=Ne,de=Be,fe=Ve;return u(),c("div",Le,[l("div",ze,[t(w)]),l("div",Ge,[l("div",We,[l("div",Oe,[l("div",qe,[l("div",Je,[t(I,{modelValue:n(b),"onUpdate:modelValue":s[0]||(s[0]=a=>oe(b)?b.value=a:null),type:"month",class:""},null,8,["modelValue"]),t(E,{modelValue:n($),"onUpdate:modelValue":s[1]||(s[1]=a=>oe($)?$.value=a:null)},{default:o(()=>[l("div",Ke,[l("div",Qe,[t(A,null,{default:o(()=>[(u(!0),c(y,null,M(n(k),a=>(u(),le(R,{key:a,value:a,onClick:h=>ne(a)},{default:o(()=>[f(r(a),1)]),_:2},1032,["value","onClick"]))),128))]),_:1})])])]),_:1},8,["modelValue"])]),t(v,{class:"h-full"},{default:o(()=>[t(m,{class:"px-4 py-4"},{default:o(()=>[t(_,null,{default:o(()=>s[2]||(s[2]=[f("Продажи",-1)])),_:1,__:[2]})]),_:1}),t(p,{class:"p-4 space-y-3"},{default:o(()=>[(u(!0),c(y,null,M(n(z),a=>(u(),c("div",{key:a.title,class:"text-sm md:text-base leading-normal"},[l("div",Xe,[l("span",Ye,r(a.title),1),l("span",Ze,r(a.value),1)]),l("div",et,[l("span",null,r(a.content),1),a.footer?(u(),c("span",tt,r(a.footer),1)):H("",!0)]),t(D)]))),128))]),_:1})]),_:1})]),t(v,{class:"min-w-[350px]"},{default:o(()=>[t(m,{class:"px-4 py-4"},{default:o(()=>[t(_,null,{default:o(()=>s[3]||(s[3]=[f("Показатели",-1)])),_:1,__:[3]})]),_:1}),t(p,{class:"p-4 space-y-3"},{default:o(()=>[(u(!0),c(y,null,M(n(G),a=>(u(),c("div",{key:a.title,class:"text-sm md:text-base leading-normal"},[l("div",at,[l("span",ot,r(a.title),1),l("span",lt,r(a.value),1)]),l("div",st,[l("span",null,r(a.content),1),a.footer?(u(),c("span",nt,r(a.footer),1)):H("",!0)]),t(D)]))),128))]),_:1})]),_:1}),l("div",rt,[t(v,{class:"h-full"},{default:o(()=>[t(m,{class:"px-4 py-4"},{default:o(()=>[t(_,null,{default:o(()=>s[4]||(s[4]=[f("Топ менеджеров",-1)])),_:1,__:[4]}),t(x)]),_:1}),t(p,{class:"p-0"},{default:o(()=>[t(ue,null,{default:o(()=>[t(re,null,{default:o(()=>[t(te,null,{default:o(()=>[t(ee,{class:"text-left"},{default:o(()=>s[5]||(s[5]=[f(" Менеджер ",-1)])),_:1,__:[5]}),t(ee,{class:"text-right"},{default:o(()=>s[6]||(s[6]=[f(" Сумма ",-1)])),_:1,__:[6]})]),_:1})]),_:1}),t(ie,null,{default:o(()=>[(u(!0),c(y,null,M(n(V),(a,h)=>(u(),le(te,{key:h},{default:o(()=>[t(ae,{class:"font-medium whitespace-nowrap"},{default:o(()=>[f(r(h+1+". "+a.fullName),1)]),_:2},1024),t(ae,{class:"text-right whitespace-nowrap"},{default:o(()=>[f(r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales)+"₽"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),t(g,{class:"p-0"})]),_:1})]),t(v,{class:"min-w-[350px]"},{default:o(()=>[t(m,{class:"px-4 py-4"},{default:o(()=>[t(_,null,{default:o(()=>s[7]||(s[7]=[f("Доставка",-1)])),_:1,__:[7]})]),_:1}),t(p,{class:"p-4 space-y-3"},{default:o(()=>[(u(!0),c(y,null,M(n(W),a=>(u(),c("div",{key:a.title,class:"text-sm md:text-base leading-normal"},[l("div",it,[l("span",ut,r(a.title),1),l("span",ct,r(a.value),1)]),l("div",dt,[l("span",null,r(a.content),1),a.footer?(u(),c("span",ft,r(a.footer),1)):H("",!0)]),t(D)]))),128)),l("div",mt,[s[8]||(s[8]=l("span",{class:"font-medium text-gray-800"},"Реестр СДЕК",-1)),l("span",_t,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(+n(J).toFixed(2))+"₽"),1)])]),_:1})]),_:1})]),l("div",pt,[l("div",vt,[t(v,{class:"w-full"},{default:o(()=>[t(m,null,{default:o(()=>[t(_,null,{default:o(()=>s[9]||(s[9]=[f("Макеты",-1)])),_:1,__:[9]}),t(x)]),_:1}),t(p,null,{default:o(()=>[t(S,{index:"name",category:"sales",data:n(F),"value-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽":""},null,8,["data","value-formatter"]),l("div",ht,[(u(!0),c(y,null,M(n(F),a=>(u(),c("div",{key:a.name,class:"flex items-center justify-between"},[l("span",null,r(a.name)+"("+r(a.amount)+")",1),l("span",null,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales))+"₽",1)]))),128))])]),_:1}),t(g)]),_:1}),t(v,{class:"w-full"},{default:o(()=>[t(m,null,{default:o(()=>[t(_,null,{default:o(()=>s[10]||(s[10]=[f("Источники",-1)])),_:1,__:[10]}),t(x)]),_:1}),t(p,null,{default:o(()=>[t(S,{index:"name",category:"sales",data:n(P),"value-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽":""},null,8,["data","value-formatter"]),l("div",yt,[(u(!0),c(y,null,M(n(P),a=>(u(),c("div",{key:a.name,class:"flex items-center justify-between"},[l("span",null,r(a.name),1),l("span",null,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales))+"₽",1)]))),128))])]),_:1}),t(g)]),_:1}),t(v,{class:"w-full"},{default:o(()=>[t(m,null,{default:o(()=>[t(_,null,{default:o(()=>s[11]||(s[11]=[f("Теги",-1)])),_:1,__:[11]}),t(x)]),_:1}),t(p,null,{default:o(()=>[t(S,{index:"name",category:"sales",data:n(T),"value-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽":""},null,8,["data","value-formatter"]),t(ce,{class:"h-[300px] pr-2"},{default:o(()=>[l("div",Mt,[(u(!0),c(y,null,M(n(T),a=>(u(),c("div",{key:a.name,class:"flex items-center justify-between"},[l("span",xt,r(a.name),1),l("span",null,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales))+"₽",1)]))),128)),s[12]||(s[12]=l("div",{class:"h-[20px] bg-gradient-to-b from-transparent to-slate-700/10 fixed"},null,-1))])]),_:1})]),_:1}),t(g)]),_:1}),t(v,{class:"w-full"},{default:o(()=>[t(m,null,{default:o(()=>[t(_,null,{default:o(()=>s[13]||(s[13]=[f("Расходы на рекламу",-1)])),_:1,__:[13]}),t(x)]),_:1}),t(p,null,{default:o(()=>[l("div",gt,[t(S,{index:"name",category:"sales",data:n(C),"value-formatter":(a,h)=>(O.value=n(U)?(a/n(U)*100).toFixed(2):0,("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽")},null,8,["data","value-formatter"]),l("div",bt," ДРР: "+r(n(O))+"% ",1)]),l("div",wt,[(u(!0),c(y,null,M(n(C),a=>(u(),c("div",{key:a.name,class:"flex items-center justify-between gap-4"},[l("span",Dt,r(a.name),1),l("span",Ft,r(("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a.sales))+"₽",1)]))),128))])]),_:1}),t(g)]),_:1})]),l("div",Pt,[t(v,null,{default:o(()=>[t(m,null,{default:o(()=>[t(_,null,{default:o(()=>s[14]||(s[14]=[f("График продаж",-1)])),_:1,__:[14]}),t(x)]),_:1}),t(p,null,{default:o(()=>[t(de,{index:"name",data:n(j),categories:["Сделки","Допы"],"y-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a)+"₽":"",type:"stacked","custom-tooltip":Ue},null,8,["data","y-formatter"])]),_:1}),t(g)]),_:1})]),l("div",Tt,[t(v,null,{default:o(()=>[t(m,null,{default:o(()=>[t(_,null,{default:o(()=>s[15]||(s[15]=[f("График заявок",-1)])),_:1,__:[15]}),t(x)]),_:1}),t(p,null,{default:o(()=>[t(fe,{index:"name",data:n(N),categories:["ВК","B2B"],"y-formatter":(a,h)=>typeof a=="number"?("useMyFormatPrice"in e?e.useMyFormatPrice:n(i))(a):"","custom-tooltip":je},null,8,["data","y-formatter"])]),_:1}),t(g)]),_:1})])])])])])}}});export{Zt as default};
