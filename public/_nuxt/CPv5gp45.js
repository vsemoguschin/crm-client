import{_ as p}from"./CDst0A0O.js";import{u as _}from"./DzJc7hp_.js";import{u as h}from"./CCknexPU.js";import{_ as v}from"./DLFIBFui.js";import{e as g,f as k,g as x,r as l,i as N,c as s,a as o,b as u,w,n as y,l as I,o as a,d as S}from"./BbheI0mw.js";import{_ as T}from"./DlAUqK2U.js";import"./B9M8ggfK.js";import"./oLxPQbNe.js";import"./D2GZmoDz.js";const A={class:"h-screen"},C={key:0,class:"flex items-center justify-center h-screen"},E={key:1,class:"flex items-center justify-center h-screen"},R={class:"text-center"},B={key:2},$=g({__name:"default",setup(V){h();const d=_(),t=k(),{$useApi:f}=x(),r=l(!0),n=l(!1),i=async()=>{if(!localStorage.getItem("accessToken")){r.value=!1,await t.push("/login");return}try{const{data:e}=await f.get("/profile");d.setUser(e),e.role.shortName==="DIZ"&&await t.push("/diz"),["MASTER","PACKER","FRZ"].includes(e.role.shortName)&&await t.push("/production"),["FINANCIER"].includes(e.role.shortName)&&await t.push("/production")}catch{n.value=!0,localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),await t.push("/login")}finally{r.value=!1}};return N(()=>{i()}),(c,e)=>{const m=p;return a(),s("div",A,[o("section",null,[r.value?(a(),s("div",C,e[0]||(e[0]=[o("span",null,"Загрузка...",-1)]))):n.value?(a(),s("div",E,[o("div",R,[e[2]||(e[2]=o("p",{class:"text-red-500"},"Ошибка загрузки профиля",-1)),u(m,{variant:"outline",onClick:i},{default:w(()=>e[1]||(e[1]=[S(" Повторить ",-1)])),_:1,__:[1]})])])):(a(),s("div",B,[y(c.$slots,"default",{},void 0,!0)]))]),u(I(v))])}}}),D=T($,[["__scopeId","data-v-43c0e613"]]);export{D as default};
