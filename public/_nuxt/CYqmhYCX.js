import{_ as G}from"./CDst0A0O.js";import{a as J,b as K,c as Q,d as W,_ as X}from"./cStEOrWd.js";import{_ as Y}from"./DiZ4QL0M.js";import{_ as Z}from"./C30fSUvl.js";import{_ as ee,a as te,b as le,c as oe,d as ae}from"./JYeLPbKT.js";import{_ as se}from"./CprHmdOe.js";import{_ as ne}from"./D-8t_H8v.js";import{e as ie,g as ue,r as _,B as $,m as h,o as i,w as s,b as o,d as u,c as d,D as c,a as m,l as t,t as y,F as E,z as me,A as N,k as O,H as re}from"./BbheI0mw.js";const de={key:0,class:"text-red-500 text-sm"},pe={class:"flex flex-col gap-6 mt-2"},_e={class:"relative"},ce={class:"relative"},fe={class:"relative"},ve={class:"relative"},we={class:"relative"},xe={class:"flex items-center gap-3"},ye={key:0,class:"flex flex-col gap-2 text-slate-500"},ke={key:2},ge={key:0},be={key:1},Ee=ie({__name:"CreateModal",setup(Ue){const{$useApi:B}=ue(),k=_(!1),x=_(null),g=_(!1),b=_(!0),P=["Терминал Изинеон","Терминал Изинеон СБП","Терминал ИзиБук","Терминал ИзиБук СБП"],f=_(null),U=_(null),v=_(null),A={terminal:P[0],Name:"Изготовление неоновой вывески",Amount:10,Phone:"",Email:"",withOffer:!1},l=_({...A});$(()=>l.value.terminal,n=>{l.value.Name=n==="Терминал ИзиБук"||n==="Терминал ИзиБук СБП"?"Изготовление фотокниги":"Изготовление неоновой вывески"},{immediate:!0});const L=async()=>{g.value=!0,x.value=null;try{const n=l.value.withOffer?"/payments/offer-link":"/payments/link",{withOffer:e,...p}=l.value,r=await B.post(n,p);console.log(r.data),f.value=r.data.link||null,v.value=r.data.publicLink||null,U.value=r.data.PaymentId||null}catch(n){const e=n.response?.data?.message||"Ошибка при создании";x.value=e.message}finally{g.value=!1}};$([l],()=>{const{Name:n,Amount:e,Email:p,Phone:r}=l.value;b.value=!(n&&e&&p&&r)},{deep:!0});const D=async n=>{try{await navigator.clipboard.writeText(n),alert("Ссылка успешно скопирована в буфер обмена!")}catch(e){console.error("Не удалось скопировать ссылку:",e),alert("Ошибка при копировании ссылки.")}};return $([l],()=>{const{Name:n,Amount:e,Email:p,Phone:r,withOffer:C}=l.value;C?b.value=!(n&&e):b.value=!(n&&e&&(p||r))},{deep:!0}),$(k,n=>{n||(l.value={...A},x.value=null,f.value=null,v.value=null,U.value=null)}),(n,e)=>{const p=G,r=J,C=W,S=Q,w=Z,T=le,I=te,F=ae,M=oe,z=ee,V=se,H=ne,R=Y,j=K,q=X;return i(),h(q,{open:t(k),"onUpdate:open":e[8]||(e[8]=a=>re(k)?k.value=a:null)},{default:s(()=>[o(r,{"as-child":""},{default:s(()=>[o(p,null,{default:s(()=>e[9]||(e[9]=[u("Выставить ссылку",-1)])),_:1,__:[9]})]),_:1}),o(j,{class:"max-w-[350px] flex flex-col"},{default:s(()=>[o(S,null,{default:s(()=>[o(C,null,{default:s(()=>e[10]||(e[10]=[u("Создать ссылку на оплату",-1)])),_:1,__:[10]})]),_:1}),t(x)?(i(),d("div",de,y(t(x)),1)):c("",!0),m("div",pe,[m("div",_e,[o(w,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>e[11]||(e[11]=[u(" Терминал ",-1)])),_:1,__:[11]}),o(z,{modelValue:t(l).terminal,"onUpdate:modelValue":e[0]||(e[0]=a=>t(l).terminal=a)},{default:s(()=>[o(I,null,{default:s(()=>[o(T,{placeholder:"Выберите терминал"})]),_:1}),o(M,null,{default:s(()=>[(i(),d(E,null,me(P,a=>o(F,{key:a,value:a},{default:s(()=>[u(y(a),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),m("div",ce,[o(w,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>e[12]||(e[12]=[u(" Название заказа ",-1)])),_:1,__:[12]}),o(V,{modelValue:t(l).Name,"onUpdate:modelValue":e[1]||(e[1]=a=>t(l).Name=a),placeholder:"Название заказа",class:N(t(l).Name?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),m("div",fe,[o(w,{class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>e[13]||(e[13]=[u(" Сумма ",-1)])),_:1,__:[13]}),o(V,{modelValue:t(l).Amount,"onUpdate:modelValue":e[2]||(e[2]=a=>t(l).Amount=a),type:"number",placeholder:"Сумма",class:N(t(l).Amount?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),t(l).withOffer?c("",!0):(i(),d(E,{key:0},[m("div",ve,[t(l).Phone?(i(),h(w,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>e[14]||(e[14]=[u(" Номер телефона ",-1),m("span",{class:"text-rose-500"},"*",-1)])),_:1,__:[14]})):c("",!0),o(V,{id:"pay-tel",modelValue:t(l).Phone,"onUpdate:modelValue":e[3]||(e[3]=a=>t(l).Phone=a),type:"tel",placeholder:"Номер телефона",class:N(t(l).Phone?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])]),m("div",we,[t(l).Email?(i(),h(w,{key:0,class:"font-medium text-slate-400 absolute left-2 top-[-13px] bg-white rounded-md p-1 whitespace-nowrap"},{default:s(()=>e[15]||(e[15]=[u(" Почта ",-1),m("span",{class:"text-rose-500"},"*",-1)])),_:1,__:[15]})):c("",!0),o(V,{modelValue:t(l).Email,"onUpdate:modelValue":e[4]||(e[4]=a=>t(l).Email=a),type:"email",placeholder:"Почта",class:N(t(l).Email?"":"outline-1 outline-rose-300")},null,8,["modelValue","class"])])],64)),m("div",xe,[o(H,{checked:t(l).withOffer,"onUpdate:checked":e[5]||(e[5]=a=>t(l).withOffer=a)},null,8,["checked"]),o(w,{class:"text-sm font-medium cursor-pointer"},{default:s(()=>e[16]||(e[16]=[u(" С офертой ",-1)])),_:1,__:[16]})])]),o(R,null,{default:s(()=>[t(v)||t(f)?(i(),d("div",ye,[t(v)?(i(),d("div",{key:0,class:"cursor-pointer hover:text-slate-700",onClick:e[6]||(e[6]=O(a=>D(t(v)),["prevent"]))},[e[17]||(e[17]=m("span",{class:"font-medium"},"Ссылка для клиента:",-1)),u(" "+y(t(v)),1)])):c("",!0),t(f)?(i(),d("div",{key:1,class:"cursor-pointer hover:text-slate-700",onClick:e[7]||(e[7]=O(a=>D(t(f)),["prevent"]))},[e[18]||(e[18]=m("span",{class:"font-medium"},"Ссылка на оплату:",-1)),u(" "+y(t(f)),1)])):c("",!0),t(U)?(i(),d("div",ke,"Номер платежа: "+y(t(U)),1)):c("",!0)])):(i(),h(p,{key:1,disabled:t(b)||t(g),onClick:L},{default:s(()=>[t(g)?(i(),d("span",ge,"Сохранение...")):(i(),d("span",be,"Создать"))]),_:1},8,["disabled"]))]),_:1})]),_:1})]),_:1},8,["open"])}}});export{Ee as _};
