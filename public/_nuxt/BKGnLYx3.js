import V from"./ROxBBV8N.js";import{_ as h}from"./CDst0A0O.js";import{a as A,b as I,c as S,d as j,_ as z}from"./cStEOrWd.js";import{_ as E}from"./BHuR11Jx.js";import{_ as H}from"./DiZ4QL0M.js";import{_ as L}from"./CprHmdOe.js";import{e as M,g as O,r as _,m as q,o as c,w as t,b as o,c as m,a as r,d as p,k as G}from"./BbheI0mw.js";import{F as J}from"./B7XstORc.js";const K={key:0},P={class:"flex flex-col gap-5"},Q={key:1},ne=M({__name:"UploadFileForm",props:{deal:{}},emits:["file-uploaded"],setup(u,{emit:d}){const{$useApi:g}=O(),v=u,s=_(null),a=_(!1),l=_(!1),x=n=>{const e=n.target.files[0];if(!e){console.warn("Файл не выбран");return}console.log(e),s.value=e},w=async()=>{if(!s.value){console.error("Файл не выбран");return}const n=new J;n.append("file",s.value,s.value.name),await g.post(`deals/${v.deal.id}/files`,n,{headers:{"Content-Type":"multipart/form-data"}})},U=d,$=async()=>(l.value=!0,await w(),a.value=!1,l.value=!1,U("file-uploaded"));return(n,e)=>{const D=V,f=h,y=A,F=j,k=E,b=S,B=L,C=H,N=I,T=z;return c(),q(T,{open:a.value,"onUpdate:open":e[1]||(e[1]=i=>a.value=i)},{default:t(()=>[o(y,{"as-child":""},{default:t(()=>[o(f,{class:"p-0 w-6 h-6"},{default:t(()=>[o(D,{name:"akar-icons:plus",color:"white",size:"18px"})]),_:1})]),_:1}),o(N,{class:"flex flex-col"},{default:t(()=>[l.value?(c(),m("div",Q,"Загрузка...")):(c(),m("div",K,[o(b,null,{default:t(()=>[o(F,null,{default:t(()=>e[2]||(e[2]=[p("Загрузить файл",-1)])),_:1,__:[2]}),o(k)]),_:1}),r("div",P,[r("form",{class:"w-full flex flex-col",onSubmit:G($,["prevent"])},[o(B,{id:"file-input",type:"file",onChange:e[0]||(e[0]=i=>x(i))}),o(f,{class:"ml-auto self-right mt-8",type:"submit"},{default:t(()=>e[3]||(e[3]=[p(" Сохранить ",-1)])),_:1,__:[3]})],32)]),o(C,null,{default:t(()=>e[4]||(e[4]=[r("div",{class:"flex justify-between w-full"},null,-1)])),_:1,__:[4]})]))]),_:1})]),_:1},8,["open"])}}});export{ne as _};
