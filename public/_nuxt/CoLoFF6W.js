import{_ as E}from"./Bye7C16d.js";import{_ as S}from"./CDst0A0O.js";import{_ as P,a as R,c as K,b as q}from"./ZTyVILcU.js";import{_ as G}from"./CprHmdOe.js";import{_ as H}from"./QXfa84Px.js";import{e as V,r as s,g as T,c as w,a as c,b as o,w as r,o as u,d as y,t as U,bg as J,L as O,f as Q,v as x,i as W,m as B,D as X,l as h,F as Y,z as Z,bh as ee}from"./BbheI0mw.js";import{u as te}from"./DzJc7hp_.js";import{u as oe}from"./CCknexPU.js";import{_ as se}from"./DLFIBFui.js";import{_ as ae}from"./DlAUqK2U.js";import"./D0Fd2yXn.js";import"./B9M8ggfK.js";import"./oLxPQbNe.js";import"./D2GZmoDz.js";import"./CaPtdwNj.js";import"./DVdymwQ5.js";import"./KSX9JOtw.js";import"./s39mgViW.js";import"./CJOOd8Dx.js";import"./BR3DQNok.js";import"./odSmgr3d.js";import"./CssJESp-.js";const ne={class:"fixed inset-0 flex items-center justify-center bg-black/40 z-50"},re={class:"w-full max-w-md rounded-xl bg-white p-6 shadow-lg"},le={class:"flex justify-end gap-2"},ie=V({__name:"BoardCreateForm",emits:["created","close"],setup(I,{emit:m}){const d=m,a=s(""),l=s(""),i=s(!1),{$useApi:k}=T();async function $(){if(a.value.trim()){i.value=!0;try{const n={title:a.value.trim(),description:l.value.trim()||null},{data:e}=await k.post("/boards",n);d("created"),p()}catch(n){console.error("createBoard failed",n),J({variant:"destructive",title:"Ошибка",description:"Не удалось создать доску."})}finally{i.value=!1}}}function p(){d("close"),a.value="",l.value=""}return(n,e)=>{const _=G,C=H,f=S;return u(),w("div",ne,[c("div",re,[e[3]||(e[3]=c("h2",{class:"mb-4 text-lg font-semibold"},"Создать новую доску",-1)),o(_,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=g=>a.value=g),placeholder:"Название доски",class:"mb-3 w-full rounded-lg border border-neutral-200 px-3 py-2 outline-none focus:ring-2 focus:ring-indigo-500"},null,8,["modelValue"]),o(C,{modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=g=>l.value=g),placeholder:"Описание (необязательно)",class:"mb-4 w-full rounded-lg border border-neutral-200 px-3 py-2 outline-none focus:ring-2 focus:ring-indigo-500"},null,8,["modelValue"]),c("div",le,[o(f,{variant:"ghost",class:"px-4 py-2 rounded-lg border border-neutral-200",onClick:p},{default:r(()=>e[2]||(e[2]=[y(" Отмена ",-1)])),_:1,__:[2]}),o(f,{class:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",disabled:i.value,onClick:$},{default:r(()=>[y(U(i.value?"Создание...":"Создать"),1)]),_:1},8,["disabled"])])])])}}}),ue={class:"relative h-screen hidden-scrollbar"},ce={class:"w-full fixed z-10"},de={class:"min-h-screen bg-neutral-800 pt-14"},me={class:"absolute top-[62px] left-4 flex items-center gap-3"},pe={class:"mt-[2px] flex items-center gap-1"},_e={key:1,class:"text-neutral-400 text-sm"},fe=V({__name:"boards",setup(I){const m=O(),d=Q();x(()=>Number(m.params.id)),x(()=>Number(m.params.taskId)),oe();const a=te(),{$useApi:l}=T(),i=s(!0),k=s(!1),$=s([]);s(0);const p=s(!1),n=s(!1),e=x(()=>a.user),_=x(()=>e.value?.boards??[]),C=x(()=>{const v=Number(m.params.id);return _.value.find(t=>Number(t.id)===v)?.title||"Выбрать доску"}),f=async()=>{p.value=!0;try{const{data:v}=await l.get("/boards");$.value=v??[]}finally{p.value=!1}},g=async()=>{if(!localStorage.getItem("accessToken")){i.value=!1,await d.push("/login");return}try{const{data:t}=await l.get("/profile");a.setUser(t)}catch{k.value=!0,localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),await d.push("/login")}finally{i.value=!1}};return W(()=>{g(),f(),console.log("layouts")}),(v,t)=>{const D=E,N=S,L=R,M=K,A=q,F=P,z=ie,j=ee;return u(),w("div",ue,[c("div",ce,[o(D)]),c("div",de,[c("div",me,[c("div",pe,[o(N,{class:"rounded-sm text-2xl bg-neutral-800 hover:bg-neutral-800 hover:text-neutral-300 text-neutral-300 font-medium",variant:"ghost",title:"Создать доску",onClick:t[0]||(t[0]=b=>n.value=!0)},{default:r(()=>t[2]||(t[2]=[y(" + ",-1)])),_:1,__:[2]}),h(_).length?(u(),B(F,{key:0},{default:r(()=>[o(L,{"as-child":""},{default:r(()=>[o(N,{class:"bg-neutral-800 h-9 text-xl py-3 border-1 border-neutral-500/20 text-neutral-300 hover:bg-neutral-700"},{default:r(()=>[y(U(h(C))+" ▾ ",1)]),_:1})]),_:1}),o(A,{class:"bg-neutral-800 text-neutral-300"},{default:r(()=>[(u(!0),w(Y,null,Z(h(_),b=>(u(),B(M,{key:b.id,class:"cursor-pointer",onClick:ge=>h(d).push(`/boards/${b.id}`)},{default:r(()=>[y(U(b.title),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):(u(),w("div",_e,"Нет доступных досок"))])]),n.value?(u(),B(z,{key:0,onCreated:f,onClose:t[1]||(t[1]=b=>n.value=!1)})):X("",!0),o(j)]),o(h(se))])}}}),je=ae(fe,[["__scopeId","data-v-41a34d10"]]);export{je as default};
